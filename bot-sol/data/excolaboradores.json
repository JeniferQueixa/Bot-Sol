{
    "flow": {
        "onboarding": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "b82bc867-0acd-4b9d-8c39-63071a1bbab6",
                                "type": "text/plain",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": false,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "welcome",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "matches",
                            "values": [
                                ".*"
                            ]
                        }
                    ],
                    "$id": "cfc5252d-3c22-4882-9d1e-328ce7ac8f10",
                    "$connId": "con_3",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [
                {
                    "$id": "DWN/ONB_RST_SCT#d895e2d2-9093-4e83-9477-0c5c07d56d29",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN [SETTINGS] Reset",
                    "settings": {
                        "function": "dwnRun",
                        "source": "\nvar RESET_CONFIG = {\n  journey: true,\n  errors: true,\n  checkpoints: true,\n  intents: true,\n  services: true,\n  visits: true,\n  group: true\n};\nvar ONLY_ON_MAIN = true;\nasync function dwnRun(coreStr, configStr, errorStr) {\n  coreStr = coreStr || \"\";\n  configStr = configStr || \"\";\n  errorStr = errorStr || \"\";\n  let core = null;\n  let config = null;\n  let error = DwnError.fromDwnError(errorStr);\n  try {\n    core = JSON.parse(coreStr || \"{}\");\n    if (error) {\n      throw error;\n    }\n    try {\n      config = JSON.parse(configStr || \"\");\n    } catch (err) {\n      throw new Error(`config parsing ${String(err)}`);\n    }\n    const IS_MAIN = config.service.current === config.service.main;\n    const allow = ONLY_ON_MAIN ? IS_MAIN : true;\n    if (allow && RESET_CONFIG.journey) {\n      core.journey = \"{{random.guid}}\";\n      core.sessions = (core.sessions || 0) + 1;\n    }\n    if (allow && RESET_CONFIG.errors) {\n      core.errors = [];\n    }\n    if (allow && RESET_CONFIG.checkpoints) {\n      core.checkpoints = [];\n    }\n    if (allow && RESET_CONFIG.intents) {\n      core.intents = { stack: [], groups: [] };\n    }\n    if (allow && RESET_CONFIG.services) {\n      core.services = [];\n    }\n    if (allow && RESET_CONFIG.group) {\n      const GROUP_SEED_RESOLUTION = 1e7;\n      let groups = config.groups || [];\n      let sum = groups.reduce((acc, val) => acc + val, 0);\n      let seed = Math.floor(Math.random() * GROUP_SEED_RESOLUTION);\n      const groupIndex = groups.findIndex((val) => {\n        seed -= val * GROUP_SEED_RESOLUTION / sum;\n        return seed < 0;\n      });\n      const group = groupIndex === -1 ? 0 : groupIndex;\n      core.group = String.fromCharCode(65 + group);\n    }\n    if (allow && RESET_CONFIG.visits) {\n      core.visits = [];\n    }\n    if (IS_MAIN) {\n      core.warnings = [];\n    }\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `[entrypoint-core] Unexpected error ${String(err)}`;\n      const stack = err.stack || \"\";\n      err = new DwnError(\"RUNTIME_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    if (!core || typeof core !== \"object\") {\n      core = null;\n    }\n    coreStr = JSON.stringify(core);\n  }\n  if (error && error.toString() !== errorStr) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return coreStr;\n}\n/**\n * @imports\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n",
                        "inputVariables": [
                            "dwnCore",
                            "dwnConfig",
                            "dwnError"
                        ],
                        "outputVariable": "dwnCore"
                    },
                    "conditions": [],
                    "$invalid": false
                },
                {
                    "$id": "DWN/ONB_SET_CNT_PHN#f7d269d5-eef4-432b-86f6-5f2faf7da996",
                    "$typeOfContent": "",
                    "type": "MergeContact",
                    "$title": "DWN Contact defaults",
                    "settings": {
                        "phoneNumber": "{{dwn@user.phone}}",
                        "extras": {
                            "debug": "",
                            "intent": "",
                            "journey": "{{dwn@journey}}",
                            "sessions": "{{dwn@user.sessions}}"
                        }
                    },
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "exists",
                            "values": [],
                            "variable": "dwnCore@main"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/ONB_TRK_CNT_SES#d59e9b41-67e7-43b3-a717-1d317b0829e2",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Contact Sessions",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-contact-sessions",
                        "action": "{{dwnCore@sessions}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwnCore@sessions"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwnCore@main"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/ONB_TRK_ACC_HR#b372cae7-bc8b-434e-a112-0edefaee528b",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Contact Hour",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-{{dwnCore@service}}-contact-hour",
                        "action": "{{dwn@calendar.hour}}h"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@calendar.hour"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "d03ef799-2b72-4cef-8baa-eb41fc5de3e1",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'firstContent'",
                    "$invalid": false,
                    "settings": {
                        "variable": "firstContent",
                        "value": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "onboarding",
            "root": true,
            "$title": "Onboarding - Ex-colaboradores",
            "$position": {
                "top": "120px",
                "left": "644px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "fallback": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "DWN/FALL_ERR_RPT#827cdc77-8ce7-42cd-91bf-33441d7b8af5-01",
                        "$typeOfContent": "text",
                        "type": "SendMessage",
                        "settings": {
                            "id": "bd5256e0-16f5-4840-a5f3-ff4c0cdc830f",
                            "type": "text/plain",
                            "content": "<b>üö® Debug DWN Error Report üö®</b>\n\n<b>üìÑ Error Summary</b>\n- <b>Type:</b> {{dwn@error.type}}\n- <b>Description:</b> {{dwn@error.description}}\n- <b>Message:</b> {{dwn@error.message}}\n- <b>Intent:</b> {{dwn@error.intent}}\n- <b>Recurrence:</b> {{dwn@error.recurrence.combined}}\n",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "bd5256e0-16f5-4840-a5f3-ff4c0cdc830f",
                                "type": "text/plain",
                                "content": "<b>üö® Debug DWN Error Report üö®</b>\n\n<b>üìÑ Error Summary</b>\n- <b>Type:</b> {{dwn@error.type}}\n- <b>Description:</b> {{dwn@error.description}}\n- <b>Message:</b> {{dwn@error.message}}\n- <b>Intent:</b> {{dwn@error.intent}}\n- <b>Recurrence:</b> {{dwn@error.recurrence.combined}}\n"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user.debug",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "DWN/FALL_ERR_RPT#827cdc77-8ce7-42cd-91bf-33441d7b8af5-02",
                        "$typeOfContent": "chat-state",
                        "type": "SendMessage",
                        "settings": {
                            "id": "227875c5-3778-417d-97f8-1b42837d827e",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 250
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "227875c5-3778-417d-97f8-1b42837d827e",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 250
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user.debug",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "DWN/FALL_ERR_RPT#827cdc77-8ce7-42cd-91bf-33441d7b8af5-03",
                        "$typeOfContent": "text",
                        "type": "SendMessage",
                        "settings": {
                            "id": "bd5256e0-16f5-4840-a5f3-ff4c0cdc830f",
                            "type": "text/plain",
                            "content": "<b>üìú Stack Trace</b>\n  {{dwn@error.stack}}\n",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "bd5256e0-16f5-4840-a5f3-ff4c0cdc830f",
                                "type": "text/plain",
                                "content": "<b>üìú Stack Trace</b>\n  {{dwn@error.stack}}\n"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user.debug",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "DWN/FALL_ERR_RPT#827cdc77-8ce7-42cd-91bf-33441d7b8af5-04",
                        "$typeOfContent": "chat-state",
                        "type": "SendMessage",
                        "settings": {
                            "id": "4de82a58-03c5-4fc8-a7fc-606c19334b4d",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 250
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "4de82a58-03c5-4fc8-a7fc-606c19334b4d",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 250
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user.debug",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "DWN/FALL_ERR_RPT#827cdc77-8ce7-42cd-91bf-33441d7b8af5-05",
                        "$typeOfContent": "text",
                        "type": "SendMessage",
                        "settings": {
                            "id": "bd5256e0-16f5-4840-a5f3-ff4c0cdc830f",
                            "type": "text/plain",
                            "content": "<b>‚öôÔ∏è Execution Context</b>\n- <b>ID:</b> {{dwn@error.state.id}}\n- <b>Service:</b> {{dwn@error.state.service}}\n- <b>State:</b> {{dwn@error.state.name}}\n\n<b>‚Ü™Ô∏è Return Context</b>\n- <b>ID:</b> {{dwn@error.goto.id}}\n- <b>Service:</b> {{dwn@error.goto.service}}\n- <b>State:</b> {{dwn@error.goto.name}}\n",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "bd5256e0-16f5-4840-a5f3-ff4c0cdc830f",
                                "type": "text/plain",
                                "content": "<b>‚öôÔ∏è Execution Context</b>\n- <b>ID:</b> {{dwn@error.state.id}}\n- <b>Service:</b> {{dwn@error.state.service}}\n- <b>State:</b> {{dwn@error.state.name}}\n\n<b>‚Ü™Ô∏è Return Context</b>\n- <b>ID:</b> {{dwn@error.goto.id}}\n- <b>Service:</b> {{dwn@error.goto.service}}\n- <b>State:</b> {{dwn@error.goto.name}}\n"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user.debug",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "DWN/FALL_ERR_RPT#827cdc77-8ce7-42cd-91bf-33441d7b8af5-06",
                        "$typeOfContent": "chat-state",
                        "type": "SendMessage",
                        "settings": {
                            "id": "a01c5f7e-157e-43d2-9542-fcb136570405",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 250
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "a01c5f7e-157e-43d2-9542-fcb136570405",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 250
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwn@user.debug",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "75a3a9e3-af64-4d09-83ed-05d21f45ac1a",
                                "type": "text/plain",
                                "content": "User input"
                            },
                            "editable": false,
                            "deletable": false,
                            "position": "right"
                        },
                        "$invalid": false
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "stateId": "884ed89d-0ede-44c2-a7ba-beb3e0a33d89",
                    "typeOfStateId": "state",
                    "$connId": "con_8",
                    "$id": "88999a22-d3ee-4cd5-bec5-5f7a9a9084dd",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "UNEXPECTED_CPF"
                            ],
                            "variable": "dwn@error.type"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "error",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error",
                            "values": []
                        }
                    ],
                    "$id": "1d4fac8f-4e7d-4d24-82a9-15ef3a525eb1",
                    "$connId": "con_13",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "DWN/ERR_SCT#f7cd0123-f58e-4a0d-887d-91f1567cb390",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Create Error",
                    "settings": {
                        "function": "dwnRun",
                        "source": "/**\n * @author     [Beuren Bechlin] <beuren.bechlin@dawntech.dev>\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n *\n * ---\n *\n * This software is the proprietary property of Dawntech.\n * Possession, use, duplication, or dissemination of this software is strictly\n * prohibited unless you have received prior written permission from\n * Dawntech.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nasync function dwnRun(dwnStr, coreStr, configStr, statesStr, errorStr) {\n  dwnStr = dwnStr || \"\";\n  coreStr = coreStr || \"\";\n  configStr = configStr || \"\";\n  statesStr = statesStr || \"\";\n  errorStr = errorStr || \"\";\n  let warnings = [];\n  let error = DwnError.fromDwnError(errorStr);\n  let core = null;\n  let dwn = null;\n  let states = {};\n  let config = null;\n  try {\n    if (error && SYSTEM_DWN_ERRORS.includes(error.type)) {\n      throw error;\n    }\n    try {\n      core = JSON.parse(coreStr);\n    } catch (err) {\n      warnings.push(`[create-error] Unexpected core JSON ${String(err)}`);\n      throw new Error(`core parsing ${String(err)}`);\n    }\n    warnings = core.warnings;\n    try {\n      dwn = JSON.parse(dwnStr);\n    } catch (err) {\n      warnings.push(`[create-error] Unexpected dwn JSON ${String(err)}`);\n      throw new Error(`dwn parsing ${String(err)}`);\n    }\n    try {\n      states = JSON.parse(statesStr);\n    } catch (err) {\n      warnings.push(`[create-error] Unexpected states JSON ${String(err)}`);\n      throw new Error(`states parsing ${String(err)}`);\n    }\n    try {\n      config = JSON.parse(configStr);\n    } catch (err) {\n      warnings.push(`[create-error] Unexpected config JSON ${String(err)}`);\n      throw new Error(`config parsing ${String(err)}`);\n    }\n    let type = config.error.type;\n    let intent = dwn.intent ? dwn.intent.id : null;\n    let description = undefined;\n    let messages = config.error.messages || [];\n    let state = enforceState(\n      \"{{state.previous.id}}\",\n      core.service,\n      states\n    );\n    let goto = null;\n    if (error) {\n      type = error.type;\n      description = error.description;\n      messages = error.messages || [];\n      if (error.message) {\n        messages = [error.message];\n      }\n      if (error.goto === undefined) {\n        goto = state;\n      } else {\n        goto = error.goto;\n      }\n    } else {\n      error = new DwnError(type, \"Default error\");\n      description = \"Default error\";\n      goto = config.error.goto === undefined ? state : config.error.goto;\n    }\n    if (intent === \"CHECKPOINT_BACK\") {\n      const checkpointIndex = core.checkpoints.findIndex(\n        (checkpoint) => checkpoint.id === core.state.id && checkpoint.service === core.service\n      );\n      if (checkpointIndex >= 0) {\n        core.checkpoints.splice(0, checkpointIndex + 1);\n      }\n    } else if (core.checkpoint) {\n      if (!(dwn.intent && dwn.intent.id && dwn.intent.scope === \"prepare\")) {\n        core.checkpoints.splice(0, 1);\n      }\n    }\n    if (dwn.intent && dwn.intent.scope === \"stack\") {\n      const stackIndex = core.intents.stack.findIndex(\n        (intentsGroup) => intentsGroup.id === dwn.intent.event\n      );\n      if (stackIndex >= 0) {\n        core.intents.stack.splice(0, stackIndex + 1);\n      }\n    }\n    if (type === \"PROPAGATE\") {\n      throw DwnError.fromJson(dwn.error);\n    }\n    if (type === \"RUNTIME_ERROR\") {\n      throw error;\n    }\n    const recurrence = error.recurrence;\n    const lastError = core.errors[0];\n    if (lastError && recurrence.combined > 0) {\n      if (lastError.state.id == state.id) {\n        recurrence.state = lastError.recurrence.state + 1;\n      }\n      if (lastError.type == type) {\n        recurrence.type = lastError.recurrence.type + 1;\n      }\n      recurrence.combined = Math.min(recurrence.state, recurrence.type);\n    }\n    error.type = type;\n    error.at = dwn.calendar.datetime;\n    error.content = dwn.input.content;\n    error.state = state;\n    error.recurrence = recurrence;\n    error.goto = enforceState(goto, core.service, states);\n    error.intent = intent;\n    error.description = description;\n    error.message = error.message || undefined;\n    if (messages.length === 0 && error.intent && error.intent in config.messages.intent) {\n      messages = config.messages.intent[error.intent];\n    }\n    if (messages.length === 0 && dwn.input.type in config.messages.type) {\n      messages = config.messages.type[dwn.input.type];\n    }\n    if (messages.length === 0 && error.type in config.messages.error) {\n      messages = config.messages.error[error.type];\n    }\n    error.messages = messages;\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `[create-error] Unexpected error ${String(err)}`;\n      const stack = err.stack || \"\";\n      err = new DwnError(\"RUNTIME_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    if (!core || typeof core !== \"object\") {\n      core = {};\n    }\n    if (error) {\n      core.error = error.toJson();\n    }\n    core.warnings = warnings;\n    coreStr = JSON.stringify(core);\n  }\n  if (error) {\n    await context.deleteVariableAsync(\"dwnError\");\n  }\n  return coreStr;\n}\n/**\n * @imports\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nfunction enforceState(state, currentService, states) {\n  if (!state && typeof state !== \"string\") {\n    return state;\n  }\n  const id = typeof state === \"string\" ? state : state.id;\n  if (!id) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      `State ${JSON.stringify(state)} must have 'id' property.`\n    );\n  }\n  const key = `${id}@${currentService}`;\n  let service = typeof state === \"string\" ? currentService : state.service;\n  if (!service) {\n    service = currentService;\n  }\n  let name = typeof state === \"string\" ? \"\" : state.name;\n  if (!name) {\n    name = states[key] || undefined;\n  }\n  return { id, service, name };\n}\n",
                        "inputVariables": [
                            "dwn",
                            "dwnCore",
                            "dwnConfig",
                            "dwnStates",
                            "dwnError"
                        ],
                        "outputVariable": "dwnCore"
                    },
                    "conditions": [],
                    "$invalid": false
                },
                {
                    "$id": "DWN/ERR_CLR_TYP#380ee472-6412-4369-9a4d-4a4552cdeeef",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN [SETTINGS] Process Error",
                    "settings": {
                        "function": "dwnRun",
                        "source": "/**\n * @author     [Beuren Bechlin] <beuren.bechlin@dawntech.dev>\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n *\n * ---\n *\n * This software is the proprietary property of Dawntech.\n * Possession, use, duplication, or dissemination of this software is strictly\n * prohibited unless you have received prior written permission from\n * Dawntech.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nasync function processError(error, errors, dwn, core, config) {\n  if (error.type !== \"INTENT\" && error.recurrence.combined >= 3) {\n    const messages = config.messages.error[\"RECURRENT_ERROR\"] || [];\n    error.type = \"RECURRENT_ERROR\";\n    error.message = rotateMessages(messages, errors);\n    error.description = \"Recurrence detected\";\n    error.goto = null;\n    return error;\n  }\n  if (error.type === \"INACTIVITY\" && config.messages.error[\"INACTIVITY\"] && config.messages.error[\"INACTIVITY\"].length > 1) {\n    const isFinal = error.recurrence.combined === config.messages.error[\"INACTIVITY\"].length;\n    if (!isFinal) {\n      error.description = \"Intermidiate inactivity message, waiting for user.\";\n      error.goto = error.state;\n    } else {\n      error.description = \"Final inactivity message, closing conversation.\";\n      error.goto = null;\n    }\n    error.message = rotateMessages(\n      config.messages.error[\"INACTIVITY\"],\n      errors\n    );\n    return error;\n  }\n  switch (error.type) {\n    // Exemplo de tratamento de erro espec√≠fico\n    case \"BLOCKED_CONTACT\":\n      error.message = rotateMessages(\n        [\n          \"Desculpe, voc√™ n√£o pode interagir com este servi√ßo. Entre em contato com o suporte para mais informa√ß√µes.\",\n          \"Desculpe, voc√™ foi bloqueado de interagir com este servi√ßo. Entre em contato com o suporte para mais informa√ß√µes.\"\n        ],\n        errors\n      );\n      error.goto = null;\n      break;\n  }\n  return error;\n}\nfunction rotateMessages(messages, errors) {\n  if (!messages || !Array.isArray(messages) || messages.length === 0) {\n    return undefined;\n  }\n  if (!errors || !Array.isArray(errors) || errors.length === 0) {\n    return messages[0] || undefined;\n  }\n  const lastErrorMessage = errors[0] ? errors[0].message : \"\";\n  const lastMessageIndex = messages.findIndex((m) => m === lastErrorMessage);\n  return messages[(lastMessageIndex + 1) % messages.length] || undefined;\n}\nasync function dwnRun(dwnStr, coreStr, configStr, statesStr, errorStr) {\n  dwnStr = dwnStr || \"\";\n  coreStr = coreStr || \"\";\n  configStr = configStr || \"\";\n  statesStr = statesStr || \"\";\n  errorStr = errorStr || \"\";\n  let service = {\n    current: \"Ex-colaboradores\",\n    main: \"Main\"\n  };\n  let propagate = service.current !== service.main ? service.main : undefined;\n  let warnings = [];\n  let error = new DwnError(\n    \"RUNTIME_ERROR\",\n    \"Default error\",\n    { goto: null }\n  );\n  let core = null;\n  let dwn = null;\n  let states = {};\n  let config = null;\n  try {\n    try {\n      core = JSON.parse(coreStr);\n    } catch (err) {\n      warnings.push(`[process-error] Unexpected core JSON ${String(err)}`);\n      throw new Error(`core parsing ${String(err)}`);\n    }\n    warnings = core.warnings;\n    try {\n      dwn = JSON.parse(dwnStr);\n    } catch (err) {\n      warnings.push(`[process-error] Unexpected dwn JSON ${String(err)}`);\n      throw new Error(`dwn parsing ${String(err)}`);\n    }\n    try {\n      states = JSON.parse(statesStr);\n    } catch (err) {\n      warnings.push(`[process-error] Unexpected states JSON ${String(err)}`);\n      throw new Error(`states parsing ${String(err)}`);\n    }\n    if (!core.error) {\n      warnings.push(`[process-error] core error is not defined`);\n      throw new Error(\"core error is not defined\");\n    }\n    try {\n      const error2 = DwnError.fromJson(core.error);\n      if (!error2) throw new Error(\"core error is not defined\");\n      if (error2 && SYSTEM_DWN_ERRORS.includes(error2.type)) {\n        throw error2;\n      }\n      config = JSON.parse(configStr);\n    } catch (error2) {\n      warnings.push(`[process-error] Unexpected error ${String(error2)}`);\n      throw error2;\n    }\n    service = config.service;\n    propagate = core.propagate;\n    let _error = core.error;\n    _error.message = rotateMessages(core.messages, core.errors);\n    _error = await processError(_error, core.errors, dwn, core, config);\n    _error.goto = enforceState(_error.goto, service.current, states);\n    core.errors = core.errors.slice(0, config.stackSize.errors);\n    core.errors.unshift(_error);\n    error = DwnError.fromJson(_error);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `[process-error] Unexpected error ${String(err)}`;\n      const stack = err.stack || \"\";\n      err = new DwnError(\"RUNTIME_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    if (!dwn || typeof dwn !== \"object\") {\n      dwn = {};\n    }\n    if (!core || typeof core !== \"object\") {\n      core = {};\n    }\n    core.propagate = propagate;\n    if (SYSTEM_DWN_ERRORS.includes(error.type)) {\n      error = systemErrorRecovery(error, service);\n    }\n    if (error.code && error.message) {\n      error.message = error.message.replace(\"{{code}}\", error.code);\n    }\n    if (error.goto) {\n      if (!error.goto.service) {\n        error.goto.service = service.current;\n      }\n      if (!error.goto.id) {\n        error.goto.id = \"onboarding\";\n      }\n      if (error.goto.service !== service.current) {\n        core.redirect = true;\n      }\n      errorStr = \"\";\n    } else {\n      if (core.propagate) {\n        core.redirect = true;\n        errorStr = \"PROPAGATE\";\n      }\n      error.goto = undefined;\n    }\n    core.error = error.toJson();\n    dwn.error = error.toJson();\n    core.warnings = warnings;\n    if (core.warnings.length > 0) {\n      dwn.warnings = core.warnings.join(\"\\n\");\n    }\n    dwnStr = JSON.stringify(dwn);\n  }\n  if (errorStr === \"PROPAGATE\") {\n    await context.setVariableAsync(\"dwnError\", errorStr);\n  }\n  if (core && typeof core === \"object\") {\n    await context.setVariableAsync(\"dwnCore\", JSON.stringify(core));\n  }\n  return dwnStr;\n}\nfunction systemErrorRecovery(error, services) {\n  const messages = {\n    [\"RUNTIME_ERROR\"]: \"Desculpe, houve um erro inesperado. Por favor, tente novamente mais tarde.\",\n    [\"MISCONFIGURATION_ERROR\"]: \"Desculpe, houve uma falha inesperada. Por favor, tente novamente mais tarde.\"\n  };\n  if (messages[error.type]) {\n    error.message = messages[error.type];\n  } else {\n    error.message = messages[\"RUNTIME_ERROR\"];\n  }\n  if (services.current === services.main) {\n    error.goto = undefined;\n  } else {\n    error.goto = {\n      id: \"onboarding\",\n      service: services.main\n    };\n  }\n  return error;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nfunction enforceState(state, currentService, states) {\n  if (!state && typeof state !== \"string\") {\n    return state;\n  }\n  const id = typeof state === \"string\" ? state : state.id;\n  if (!id) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      `State ${JSON.stringify(state)} must have 'id' property.`\n    );\n  }\n  const key = `${id}@${currentService}`;\n  let service = typeof state === \"string\" ? currentService : state.service;\n  if (!service) {\n    service = currentService;\n  }\n  let name = typeof state === \"string\" ? \"\" : state.name;\n  if (!name) {\n    name = states[key] || undefined;\n  }\n  return { id, service, name };\n}\n",
                        "inputVariables": [
                            "dwn",
                            "dwnCore",
                            "dwnConfig",
                            "dwnStates",
                            "dwnError"
                        ],
                        "outputVariable": "dwn"
                    },
                    "conditions": [],
                    "$invalid": false
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "DWN/FALL_DBG_CNT#3aacc8bd-4880-48c0-a103-e29b53756615",
                    "$typeOfContent": "",
                    "type": "MergeContact",
                    "$title": "DWN Invert user debug",
                    "settings": {
                        "extras": {
                            "debug": "{{dwn@user.debug}}"
                        }
                    },
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "notExists",
                            "values": [],
                            "variable": "dwnError"
                        },
                        {
                            "source": "context",
                            "comparison": "exists",
                            "values": [],
                            "variable": "dwn@error"
                        },
                        {
                            "source": "context",
                            "comparison": "equals",
                            "variable": "dwn@error.type",
                            "values": [
                                "DEBUG"
                            ]
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/FALL_TRK_ERR_GLB#5c0299c8-dafa-4389-a903-d8dd4caa5102",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Global errors by type",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-global-errors-by-type",
                        "action": "{{dwn@error.type}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.type"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/FALL_TRK_ERR_LOC#3c11ce87-c693-4634-a183-f3c1c560d22e",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Local errors by type",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-{{dwnCore@service}}-errors-by-type",
                        "action": "{{dwn@error.type}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.type"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/FALL_TRK_ERR_GLB_NO_UNX#418e981f-ce7f-4512-869d-ddbaffad8d9b",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Global errors by type excluding unexpected",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-global-errors-by-type-no-unexpected",
                        "action": "{{dwn@error.type}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.type"
                        },
                        {
                            "values": [
                                "UNEXPECTED_INPUT"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error.type"
                        },
                        {
                            "values": [
                                "UNEXPECTED_OPTION"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error.type"
                        },
                        {
                            "values": [
                                "INTENT"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error.type"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/FALL_TRK_ERR_LOC_NO_UNX#21a69205-354e-4632-ba61-54686f8c9810",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Local errors by type excluding unexpected",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-{{dwnCore@service}}-errors-by-type-no-unexpected",
                        "action": "{{dwn@error.type}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.type"
                        },
                        {
                            "values": [
                                "UNEXPECTED_INPUT"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [
                                "UNEXPECTED_OPTION"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [
                                "INTENT"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/FALL_TRK_ERR_LST#6f991344-58bd-49b4-a308-b4951dd826ff",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Global errors by type list",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-errors-by-type-list",
                        "action": "{{dwn@error.at}} | {{contact.identity}} | {{dwn@error.type}} | {{dwn@error.state.id}} | {{dwn@error.state.service}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/FALL_TRK_ERR_LST_NO_UNX#b18fa350-d2b9-4120-9753-204ba630195c",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Global errors by type excluding unexpected list",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-errors-by-type-list-no-unexpected",
                        "action": "{{dwn@error.at}} | {{contact.identity}} | {{dwn@error.state.id}} | {{dwn@error.state.service}} | {{dwn@error.stack}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.type"
                        },
                        {
                            "values": [
                                "UNEXPECTED_INPUT"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [
                                "UNEXPECTED_OPTION"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [
                                "INTENT"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "dwn@error"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/FALL_TRK_ABD#ee83cec6-d4f6-45ac-8732-d66543996723",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Abandonment rate",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-finalization-status",
                        "action": "{{dwn@error.status}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwn@error.goto"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.status"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/FALL_BUB_ERR#9448247c-dd7d-409d-bba6-fb1fe7706f8b",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "DWN Bubbled errors by type",
                    "settings": {
                        "extras": {
                            "journey": "{{dwn@journey}}"
                        },
                        "category": "dwn-bubbled-errors-by-type",
                        "action": "{{dwn@error.type}}"
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.type"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwn@error.goto"
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "onboarding",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "fallback",
            "$title": "Fallback - Ex-colaboradores",
            "$position": {
                "top": "118px",
                "left": "2983px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "welcome": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "78416b54-7d26-4dde-9e70-2e00a2c8cd64",
                                "type": "text/plain",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "15ffd56f-9795-4a35-bfd7-a03ef916d8f9",
                    "typeOfStateId": "state",
                    "$connId": "con_18",
                    "$id": "5fe81a6e-24e8-47d5-a467-2c8d26d4e90c",
                    "conditions": [
                        {
                            "source": "context",
                            "variable": "firstContent",
                            "comparison": "equals",
                            "values": [
                                "cameFrom_ath_sair"
                            ]
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "b2232aff-c7b1-4bd1-9f58-4e40a4da43c8",
                    "typeOfStateId": "state",
                    "$connId": "con_23",
                    "$id": "44399eb4-c06b-4d52-8de6-c1a87a5e2aae",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "variable": "firstContent",
                            "values": [
                                "#reiniciar"
                            ]
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "b2232aff-c7b1-4bd1-9f58-4e40a4da43c8",
                    "typeOfStateId": "state",
                    "$connId": "con_28",
                    "$id": "09723143-8376-44a6-b2f6-16d8eafd2ff7",
                    "conditions": [
                        {
                            "source": "context",
                            "variable": "contact.taxDocument",
                            "comparison": "notExists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "94590715-5781-4ca7-b53a-cbf020abf655",
                    "typeOfStateId": "state",
                    "$connId": "con_33",
                    "$id": "c446e738-4e9e-4603-a504-53c4c5d1efee",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "exists",
                            "values": [],
                            "variable": "contact.taxDocument"
                        },
                        {
                            "source": "context",
                            "variable": "contact.taxDocument",
                            "comparison": "notEquals",
                            "values": [
                                "false"
                            ]
                        },
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "7f1fb014-9d58-44f7-91bc-e6ec477124d8",
                    "typeOfStateId": "state",
                    "$connId": "con_38",
                    "$id": "1c569af7-3106-4115-9e47-7379802df465",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "28e0cb10-174b-4244-8555-1efd036dbb34",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Definir Time to 'false'",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "Time": "false"
                        }
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                }
            ],
            "id": "welcome",
            "$title": "Pre Set",
            "$position": {
                "top": "239px",
                "left": "644px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "error": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "DWN/ERR_CNT_ACT#66ba234c-0c5b-4d51-a442-b27db47dab3f",
                        "$typeOfContent": "chat-state",
                        "type": "SendMessage",
                        "settings": {
                            "id": "68aacb6b-201b-4fae-805f-5dce445bcac6",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "68aacb6b-201b-4fae-805f-5dce445bcac6",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwnMessage",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "notEquals",
                                "variable": "dwnMessage",
                                "values": [
                                    "null"
                                ]
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "DWN/ERR_CNT_ACT#66ba234c-0c5b-4d51-a442-b27db47dab3f",
                        "$typeOfContent": "text",
                        "type": "SendMessage",
                        "settings": {
                            "id": "bd5256e0-16f5-4840-a5f3-ff4c0cdc830f",
                            "type": "text/plain",
                            "content": "{{dwnMessage}}",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "bd5256e0-16f5-4840-a5f3-ff4c0cdc830f",
                                "type": "text/plain",
                                "content": "{{dwnMessage}}"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "exists",
                                "variable": "dwnMessage",
                                "values": []
                            },
                            {
                                "source": "context",
                                "comparison": "notEquals",
                                "variable": "dwnMessage",
                                "values": [
                                    "null"
                                ]
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "e21d6be2-aa94-42f1-b1e5-1ceabb53feaf",
                                "type": "text/plain",
                                "content": "User input"
                            },
                            "editable": false,
                            "deletable": false,
                            "position": "right"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "$invalid": false
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#bfb72243-7f1b-48c6-ab8c-62e4ead028cc",
                    "stateId": "{{dwn@error.goto.id}}",
                    "typeOfStateId": "variable",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "notExists",
                            "values": [],
                            "variable": "dwnError"
                        },
                        {
                            "source": "context",
                            "comparison": "notExists",
                            "values": [],
                            "variable": "dwnCore@redirect"
                        },
                        {
                            "source": "context",
                            "comparison": "exists",
                            "values": [],
                            "variable": "dwn@error"
                        },
                        {
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.goto",
                            "values": []
                        },
                        {
                            "source": "context",
                            "comparison": "exists",
                            "values": [],
                            "variable": "dwn@error.goto.id"
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "DWN/ERR_CRT_MSG#365cf5e2-9911-44b8-9341-6bfbdcab95be",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Create Message",
                    "settings": {
                        "function": "dwnRun",
                        "source": "/**\n * @author     [Beuren Bechlin] <beuren.bechlin@dawntech.dev>\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n *\n * ---\n *\n * This software is the proprietary property of Dawntech.\n * Possession, use, duplication, or dissemination of this software is strictly\n * prohibited unless you have received prior written permission from\n * Dawntech.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nasync function dwnRun(coreStr, errorStr) {\n  coreStr = coreStr || \"\";\n  errorStr = errorStr || \"\";\n  let message = null;\n  let core = null;\n  let error = null;\n  try {\n    core = JSON.parse(coreStr);\n    if (errorStr) {\n      error = DwnError.fromDwnError(errorStr) || null;\n    }\n    if (!error && core.error) {\n      error = DwnError.fromJson(core.error);\n    }\n    if (error && error.type !== \"PROPAGATE\") {\n      message = error.message || null;\n    }\n    if (message) {\n      message = message.trim();\n    }\n  } catch (err) {\n  }\n  return message;\n}\n/**\n * @imports\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n",
                        "inputVariables": [
                            "dwnCore",
                            "dwnError"
                        ],
                        "outputVariable": "dwnMessage"
                    },
                    "conditions": [],
                    "$invalid": false
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "DWN/ERR_GOTO_RED#5ecd6cb1-b929-4eb5-8521-9d835afc708c",
                    "$typeOfContent": "",
                    "type": "Redirect",
                    "$title": "DWN Go to",
                    "settings": {
                        "address": "{{dwn@error.goto.service}}",
                        "context": {
                            "type": "text/plain",
                            "value": "{\n    \"state\": \"{{dwn@error.goto.id}}\",\n    \"service\": \"{{dwn@error.goto.service}}\",\n    \"error\": \"GOTO\"\n}"
                        }
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "notExists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwnCore@redirect"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwn@error.goto"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "DWN/ERR_PROP_RED#7e9235bf-15a4-4bd3-a699-ded46ab6f3f5",
                    "$typeOfContent": "",
                    "type": "Redirect",
                    "$title": "DWN Propagate Error",
                    "settings": {
                        "address": "{{dwnCore@propagate}}",
                        "context": {
                            "type": "text/plain",
                            "value": "{\n    \"state\": \"{{dwn@error.state.id}}\",\n    \"service\": \"{{dwn@error.state.service}}\",\n    \"error\": \"PROPAGATE\"\n}"
                        }
                    },
                    "conditions": [
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwnError"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "dwnCore@propagate"
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "onboarding",
                "typeOfStateId": "state",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "error",
            "$title": "DWN Error",
            "$position": {
                "top": "283px",
                "left": "3264px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "DWN/TAGS_BLK#8d275a58-1ea2-441d-95e0-c1dbfb357b90": {
            "id": "DWN/TAGS_BLK#8d275a58-1ea2-441d-95e0-c1dbfb357b90",
            "$title": "DWN Tags",
            "$contentActions": [],
            "$conditionOutputs": [],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$tags": [
                {
                    "background": "#FFFF00",
                    "label": "DWN - Disable Error",
                    "id": "DWN/TAG_DIS_ERR#9c457030-3296-4370-829d-f428641750e4",
                    "canChangeBackground": false
                },
                {
                    "background": "#FF0000",
                    "label": "DWN - Error",
                    "id": "DWN/TAG_ERR#16871d75-ce98-44e3-bf61-64c9a764ebb9",
                    "canChangeBackground": false
                },
                {
                    "background": "#FF8000",
                    "label": "DWN - Prepare",
                    "id": "DWN/TAG_PREP#aa459da7-ffa4-47c8-8487-6295b8f01d32",
                    "canChangeBackground": false
                },
                {
                    "background": "#0000FF",
                    "label": "DWN - Reset",
                    "id": "DWN/TAG_RST#978a9c38-c025-4181-9bbd-966ff8ff9bb0",
                    "canChangeBackground": false
                },
                {
                    "background": "#FF00FF",
                    "label": "DWN - Custom Expiration",
                    "id": "DWN/TAG_CUST_EXP#ef8eaf43-f10b-470d-be3e-58b6fa87c39a",
                    "canChangeBackground": false
                },
                {
                    "background": "#00FFFF",
                    "label": "DWN - Redirect",
                    "id": "DWN/TAG_RED#ac020f84-3722-47eb-8250-3845d1af6d86",
                    "canChangeBackground": false
                },
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "$position": {
                "top": "10000px",
                "left": "10000px"
            },
            "root": false,
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "b2232aff-c7b1-4bd1-9f58-4e40a4da43c8": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "d13d27b0-70d9-450e-b707-c383b9592205",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "3e60d2a8-4d23-417d-ab01-827e6d09bbdd",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "3e60d2a8-4d23-417d-ab01-827e6d09bbdd",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "38d22327-a73a-4f2b-9e92-3cfdb812f415",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "27f6e53c-5988-44e7-bd17-f215920ea5d9",
                            "type": "text/plain",
                            "content": "Ol√°, eu sou a Sol! √â um prazer receber voc√™ aqui no canal de atendimento da <b>Neon</b>.\n\nPode contar comigo pra tirar suas d√∫vidas e te ajudar no que for preciso.",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "27f6e53c-5988-44e7-bd17-f215920ea5d9",
                                "type": "text/plain",
                                "content": "Ol√°, eu sou a Sol! √â um prazer receber voc√™ aqui no canal de atendimento da <b>Neon</b>.\n\nPode contar comigo pra tirar suas d√∫vidas e te ajudar no que for preciso."
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "1eebfc1f-062d-4c0c-ae3e-c505a3c238f4",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "cdfdb7f6-8c86-4794-a1cd-85cd8a03f61e",
                    "typeOfStateId": "state",
                    "$connId": "con_43",
                    "$id": "ef99546a-dfb4-408e-a521-a0e4305abc2c",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "201996ea-f745-4cb9-bc9d-9675500dbe8b",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "new-user",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "new-user",
                        "action": "{{contact.identity}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "b2232aff-c7b1-4bd1-9f58-4e40a4da43c8",
            "root": false,
            "$title": "Boas vindas - Novo usu√°rio",
            "$position": {
                "top": "366px",
                "left": "451px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "cdfdb7f6-8c86-4794-a1cd-85cd8a03f61e": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "7406c825-8ddc-492a-b8ba-467ee08bc3cb",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "08fd8282-7684-4225-9f65-d197bb283f0a",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "08fd8282-7684-4225-9f65-d197bb283f0a",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "1c949bbf-c4b9-4b3c-b0e8-c7d6da49f7e4",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "707dc0e9-3a0f-42fa-9545-2611083a45a1",
                            "type": "text/plain",
                            "content": "Por favor, <b>digite o seu CPF</b>.",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "707dc0e9-3a0f-42fa-9545-2611083a45a1",
                                "type": "text/plain",
                                "content": "Por favor, <b>digite o seu CPF</b>."
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "622c1ff5-7c43-45d7-b3ad-02c559ad36e2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "2247a5fe-4bca-48de-af95-55b9e45afa26",
                    "typeOfStateId": "state",
                    "$connId": "con_48",
                    "$id": "b3a9a8af-b1c7-460d-b785-7723e861de99",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "cdfdb7f6-8c86-4794-a1cd-85cd8a03f61e",
            "root": false,
            "$title": "[Msg] Coleta CPF",
            "$position": {
                "top": "531px",
                "left": "451px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "2247a5fe-4bca-48de-af95-55b9e45afa26": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "2fee2f9f-e00c-4804-bd37-e0b750340769",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "e57edce0-5a77-4618-a3a7-4a8745c43a9f",
                    "typeOfStateId": "state",
                    "$connId": "con_53",
                    "$id": "d00add53-bd70-4384-a154-4de5b637d8d4",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "f4907c02-f4ac-4e99-b899-22b377990de8",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - cpf",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"coleta-cpf\",\n    models: [\"CPF\"],\n    checkpoint: true,\n    error: {\n      default: \"UNEXPECTED_CPF\",\n      goto: \"884ed89d-0ede-44c2-a7ba-beb3e0a33d89\"\n    }\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "79912b86-c794-4218-a43f-b69b99a2db4e",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "input-cpf",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "input-cpf",
                        "action": "{{dwn@input.payload.value}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "source": "context",
                            "variable": "dwn@input.model",
                            "comparison": "equals",
                            "values": [
                                "CPF"
                            ]
                        }
                    ]
                },
                {
                    "$id": "38774cc0-3793-414a-b9fa-2812f9d5310c",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Definir CPF",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "taxDocument": "{{dwn@input.payload.value}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "CPF"
                            ],
                            "variable": "dwn@input.model"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "2247a5fe-4bca-48de-af95-55b9e45afa26",
            "root": false,
            "$title": "[Input] Coleta CPF",
            "$position": {
                "top": "662.857px",
                "left": "451px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "e57edce0-5a77-4618-a3a7-4a8745c43a9f": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "329ea0e1-95d9-4d2f-b82a-506b6ac40722",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "ffdf562f-2c3b-460d-858f-e3a5b346bcba",
                    "typeOfStateId": "state",
                    "$connId": "con_58",
                    "$id": "18f5cd91-c051-4628-85df-7e247ad5f152",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "MULTIPLE"
                            ],
                            "variable": "colaboradorInfo"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "b7a30720-2f18-4205-96c7-7703fda7a6db",
                    "typeOfStateId": "state",
                    "$connId": "con_63",
                    "$id": "58883c26-638d-4caa-a922-4cae75c085c0",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "false"
                            ],
                            "variable": "colaboradorInfo"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "4d3349fc-7fd7-47a4-aaa5-b5e5135d49a0",
                    "typeOfStateId": "state",
                    "$connId": "con_68",
                    "$id": "b9374c29-0ed0-4918-9d92-82d25cf10606",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "b8af245a-1592-44a5-a18f-5f4120d80db8",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'corpoBuscaColacorador'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n\tconst output = `<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:dto=\"lg.com.br/svc/dto\" xmlns:v2=\"lg.com.br/api/v2\" xmlns:v1=\"lg.com.br/api/dto/v1\">\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n   <soapenv:Body>\n      <v2:ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfil>\n         <!--Optional:-->\n         <v2:filtro>\n            <!--Optional:-->\n            <v1:CpfCnpj>{{contact.taxDocument}}</v1:CpfCnpj>\n         </v2:filtro>\n      </v2:ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfil>\n   </soapenv:Body>\n</soapenv:Envelope>`\n\ttry {\n\t\treturn output;\n\t} catch (e) {\n\t\treturn output;\n\t}\n}",
                        "inputVariables": [],
                        "outputVariable": "corpoBuscaColacorador"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "77322a17-5f99-42f5-87d0-cefef2af8621",
                    "$typeOfContent": "",
                    "type": "ProcessCommand",
                    "$title": "[DWNT] Delete 'responseBuscaColaborador'",
                    "settings": {
                        "to": "postmaster@msging.net",
                        "method": "delete",
                        "uri": "/contexts/{{contact.identity}}/responseBuscaColaborador",
                        "variable": "responseBuscaColaboradorDeleteCmdResp"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "responseBuscaColaborador"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "5451d84f-b6dc-40d2-b9a2-e2cb99206fb6",
                    "$typeOfContent": "",
                    "type": "ProcessHttp",
                    "$title": "Busca colaborador pelo CPF",
                    "$invalid": false,
                    "settings": {
                        "headers": {
                            "Content-Type": "text/xml",
                            "SOAPAction": "lg.com.br/api/v2/ServicoDeColaborador/ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfil"
                        },
                        "method": "POST",
                        "body": "{{corpoBuscaColacorador}}",
                        "uri": "{{config.LGBaseUrl}}/v2/ServicoDeColaborador",
                        "responseStatusVariable": "statusBuscaColaborador",
                        "responseBodyVariable": "responseBuscaColaborador"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "9642a3f9-2e9f-497c-ac49-6065ea2e74f4",
                    "$typeOfContent": "",
                    "type": "ProcessHttp",
                    "$title": "RETRY Busca colaborador pelo CPF",
                    "$invalid": false,
                    "settings": {
                        "headers": {
                            "Content-Type": "text/xml",
                            "SOAPAction": "lg.com.br/api/v2/ServicoDeColaborador/ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfil"
                        },
                        "method": "POST",
                        "body": "{{corpoBuscaColacorador}}",
                        "uri": "{{config.LGBaseUrl}}/v2/ServicoDeColaborador",
                        "responseStatusVariable": "statusBuscaColaborador",
                        "responseBodyVariable": "responseBuscaColaborador"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "responseBuscaColaborador",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "539eab7c-c184-4e2b-9cb1-2173cafd7576",
                    "$typeOfContent": "",
                    "type": "ProcessHttp",
                    "$title": "RETRY502 Busca colaborador pelo CPF",
                    "$invalid": false,
                    "settings": {
                        "headers": {
                            "Content-Type": "text/xml",
                            "SOAPAction": "lg.com.br/api/v2/ServicoDeColaborador/ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfil"
                        },
                        "method": "POST",
                        "body": "{{corpoBuscaColacorador}}",
                        "uri": "{{config.LGBaseUrl}}/v2/ServicoDeColaborador",
                        "responseStatusVariable": "statusBuscaColaborador",
                        "responseBodyVariable": "responseBuscaColaborador"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "equals",
                            "source": "context",
                            "variable": "statusBuscaColaborador",
                            "values": [
                                "502"
                            ]
                        }
                    ]
                },
                {
                    "$id": "7d5618e7-1264-4295-a65f-05b4abb78204",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "convertXmlToJson",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n    \n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n    \n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n        \n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n\n    const isMultipleId = validaMultiplasMatriculasHabeisJornada(obj)\n\n    if (isMultipleId) {\n        return \"MULTIPLE\";\n    } else {\n        return obj;\n    }\n}\n\nfunction validaMultiplasMatriculasHabeisJornada(json) {\n    try {\n        \n        const xmlConverted = json['s:Envelope']\n            ['s:Body']\n            [\"ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfilResponse\"]\n            [\"ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfilResult\"]\n            ['a:Retorno']\n            ['a:ContratosDeTrabalho']\n            ['a:ContratoDeTrabalhoV3'];\n\n        const listaAtividades = returnCodigosAfastamento();\n\n        const atividadesFiltradas = xmlConverted.filter(matricula =>\n            listaAtividades.some(atividade => atividade.codigoSituacao == matricula['a:DadosGerais']['a:Situacao']['a:Codigo'])\n        )\n\n        return atividadesFiltradas.length > 1;\n    } catch (error) {\n        return false;\n    }\n}\n\nfunction returnCodigosAfastamento() {\n    return [\n        {\n            \"codigoSituacao\": 1,\n            \"descricao\": \"ATIVIDADE NORMAL\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 2,\n            \"descricao\": \"AF ACID TRAB ACIMA PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 3,\n            \"descricao\": \"AF DOENCA ACIMA PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 4,\n            \"descricao\": \"AF LIC MATERNIDADE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 5,\n            \"descricao\": \"AF SERVICO MILITAR\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 6,\n            \"descricao\": \"AF SEM BENEFICIO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 7,\n            \"descricao\": \"FERIAS NOR AD 13 SAL/AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 8,\n            \"descricao\": \"FERIAS NOR AD 13 SAL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 9,\n            \"descricao\": \"FERIAS NOR\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 10,\n            \"descricao\": \"FERIAS NOR AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 11,\n            \"descricao\": \"FERIAS COL AD 13 SAL/AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 12,\n            \"descricao\": \"FERIAS COL AD 13 SAL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 13,\n            \"descricao\": \"FERIAS COL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 14,\n            \"descricao\": \"FERIAS COL AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 15,\n            \"descricao\": \"RESC PEDIDO DEMISS NA EXP\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 16,\n            \"descricao\": \"RESC PEDIDO DEMISS AVISO IND\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 17,\n            \"descricao\": \"RESC PEDIDO DEMISS AVISO TRAB\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 18,\n            \"descricao\": \"RESC TER CON NA EXPERIENCIA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 19,\n            \"descricao\": \"RESC DEMIS NA EXPERIENCIA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 20,\n            \"descricao\": \"RESC DEMIS S/ JC AVISO IND\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 21,\n            \"descricao\": \"RESC DEMIS S/ JC AVISO TRAB\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 22,\n            \"descricao\": \"RESC DEMIS COM JUSTA CAUSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 23,\n            \"descricao\": \"RESC FALECIMENTO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 24,\n            \"descricao\": \"RESC APOSENT TEMPO SERVICO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 25,\n            \"descricao\": \"RESC APOSENT POR INVALIDEZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 26,\n            \"descricao\": \"TRANSFERENCIA C/ONUS P/CEDENTE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 27,\n            \"descricao\": \"TRANSFERENCIA S/ONUS P/CEDENTE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 28,\n            \"descricao\": \"RESC TER CON TRA APOS TEMP SER\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 29,\n            \"descricao\": \"APOSENTADORIA ACID TRABALHO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 30,\n            \"descricao\": \"APOSENTADORIA EXCETO DOE/AC TR\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 31,\n            \"descricao\": \"APOSENTADORIA DOENCA/PROFIS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 32,\n            \"descricao\": \"AF LICENCA REMUNERADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 33,\n            \"descricao\": \"ATIVIDADE NORMAL ESTAGIARIO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 34,\n            \"descricao\": \"AF LIC PATERNIDADE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 35,\n            \"descricao\": \"AF ACID TRAB ATE O PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 36,\n            \"descricao\": \"ATIVIDADE NORMAL PRO LABORE\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 37,\n            \"descricao\": \"AF DOENCA ATE O PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 38,\n            \"descricao\": \"RESC APOSENT POR IDADE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 39,\n            \"descricao\": \"RESCISAO  ESTAGIARIO EXTINCAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 40,\n            \"descricao\": \"RESCISAO  ESTAGIARIO DISPENSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 41,\n            \"descricao\": \"RESCISAO  ESTAGIARIO PEDIDO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 42,\n            \"descricao\": \"AF LIC MATERNIDADE PRORROG\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 43,\n            \"descricao\": \"AF OUTROS MOTIVOS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 44,\n            \"descricao\": \"ESTAGIARIO EM RECESSO\",\n            \"codigoTipoSituacao\": 4,\n            \"tipoSituacao\": \"Recesso\"\n        },\n        {\n            \"codigoSituacao\": 45,\n            \"descricao\": \"AF LICENCA NAO REMUNERADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 46,\n            \"descricao\": \"AF EXPATRIADO COM FGTS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 47,\n            \"descricao\": \"GESTANTE DESLOCADA AMBIENTE INSALUBRE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 48,\n            \"descricao\": \"AF OUTROS MOTIVOS ( MIGRA√á√ÉO)\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 50,\n            \"descricao\": \"ATIVIDADE NORMAL VINCULO INTERMITENTE\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 51,\n            \"descricao\": \"FERIAS VINCULO INTERMITENTE\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 52,\n            \"descricao\": \"RESC VINCULO INTERMITENTE DEMISSAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 53,\n            \"descricao\": \"RESC VINCULO INTERMITENTE PEDIDO DEMISSAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 54,\n            \"descricao\": \"RESC VINCULO INTERMITENTE TERMINO CONTRATO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 79,\n            \"descricao\": \"ATIVIDADE NORMAL APRENDIZ\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 80,\n            \"descricao\": \"AF LIC MATERNIDADE EMP CIDADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 81,\n            \"descricao\": \"RESCISAO PRO LABORE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 82,\n            \"descricao\": \"RESC TER CON MENOR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 83,\n            \"descricao\": \"AF SUSPENSAO CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 84,\n            \"descricao\": \"AF SUSPENSAO CONTR TRABALHO LEI 14020\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 85,\n            \"descricao\": \"AF LIC ABORTO NAO CRIMINOSO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 86,\n            \"descricao\": \"ATIVIDADE NORMAL DIRETOR ESTAT\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 87,\n            \"descricao\": \"ATIVIDADE NORMAL CONSELHEIRO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 88,\n            \"descricao\": \"RESCISAO DIRETOR ESTATUTARIO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 89,\n            \"descricao\": \"RESCISAO CONSELHEIRO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 90,\n            \"descricao\": \"AF LIC PATERNIDADE EMP CIDADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 91,\n            \"descricao\": \"RESC PEDIDO DEM C/JUSTA CAUSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 92,\n            \"descricao\": \"RESC PEDIDO ANT CONTR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 93,\n            \"descricao\": \"RESC DEMIS ANT CONTR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 94,\n            \"descricao\": \"RESC DEMIS ANT CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 95,\n            \"descricao\": \"RESC TERMINO CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 96,\n            \"descricao\": \"RESC INDIRETA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 97,\n            \"descricao\": \"RESC DEMIS S/ JC PDV\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 98,\n            \"descricao\": \"AF LIC MATERNIDADE ADOCAO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 99,\n            \"descricao\": \"RESC DEMIS S/ JC MUTUO ACORDO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 100,\n            \"descricao\": \"ATIVIDADE NORMAL AUTONOMO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 101,\n            \"descricao\": \"VINCULO AUTONOMO INATIVO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        }\n    ]\n}",
                        "inputVariables": [
                            "responseBuscaColaborador"
                        ],
                        "outputVariable": "convertXmlToJson"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "continueOnError": true
                },
                {
                    "$id": "9d1642ca-c2c4-4559-a920-350c0c9c320e",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'colaboradorInfo'",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run(obj) {\n    try {\n        if (!obj) return false\n\n        if(obj === \"MULTIPLE\") return \"MULTIPLE\";\n\n        obj = JSON.parse(obj)\n\n        let retorno = obj[\"s:Envelope\"][\"s:Body\"][\"ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfilResponse\"][\"ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfilResult\"]['a:Retorno'][\"a:ContratosDeTrabalho\"]['a:ContratoDeTrabalhoV3'];\n        let corpo = retorno;\n\n        if(retorno.length !== undefined) {\n            retorno = ordenarPorDataCrescente(retorno);\n            corpo = retorno[retorno.length - 1]\n        }\n\n        if (retorno.length !== undefined && retorno.some((cont) => cont[\"a:DadosGerais\"][\"a:Situacao\"][\"a:Descricao\"].indexOf(\"ATIVIDADE NORMAL\") !== -1)) {\n            corpo = retorno.find((cont) =>\n                cont[\"a:DadosGerais\"][\"a:Situacao\"][\"a:Descricao\"].indexOf(\"ATIVIDADE NORMAL\") !== -1);\n        } else if (retorno.length !== undefined && retorno.some((cont) => cont[\"a:DadosGerais\"][\"a:Situacao\"][\"a:Descricao\"].indexOf(\"FERIAS NOR\") !== -1)) {\n            corpo = retorno.find((cont) =>\n                cont[\"a:DadosGerais\"][\"a:Situacao\"][\"a:Descricao\"].indexOf(\"FERIAS NOR\") !== -1);\n        }\n\n        const contact = {\n            empresa: {\n                codigo: corpo && corpo['a:Alocacao'] && corpo['a:Alocacao']['a:Empresa'] && corpo['a:Alocacao']['a:Empresa']['a:Codigo'] ? corpo['a:Alocacao']['a:Empresa']['a:Codigo'] : (corpo['a:Estabelecimento']['a:Codigo'] || ''),\n                descricao: corpo && corpo['a:Alocacao'] && corpo['a:Alocacao']['a:Empresa'] && corpo['a:Alocacao']['a:Empresa']['a:Descricao'] ? corpo['a:Alocacao']['a:Empresa']['a:Descricao'] : (corpo['a:Estabelecimento']['a:Descricao'] || ''),\n                identificacao: corpo && corpo['a:Alocacao'] && corpo['a:Alocacao']['a:Empresa'] && corpo['a:Alocacao']['a:Empresa']['a:Inscricao'] ? corpo['a:Alocacao']['a:Empresa']['a:Inscricao'] : '',\n                tipoDeIdentificacao: corpo && corpo['a:Alocacao'] && corpo['a:Alocacao']['a:Empresa'] && corpo['a:Alocacao']['a:Empresa']['a:TipoDeInscricao'] ? corpo['a:Alocacao']['a:Empresa']['a:TipoDeInscricao'] : '',\n            },\n            estabelecimento: {\n                codigo: corpo['a:Estabelecimento'] && corpo['a:Estabelecimento']['a:Codigo'] ? corpo['a:Estabelecimento']['a:Codigo'] : '',\n                descricao: corpo['a:Estabelecimento'] && corpo['a:Estabelecimento']['a:Descricao'] ? corpo['a:Estabelecimento']['a:Descricao'] : '',\n                identificacao: corpo['a:Estabelecimento'] && corpo['a:Estabelecimento']['a:Identificacao'] ? corpo['a:Estabelecimento']['a:Identificacao'] : '',\n                tipoDeIdentificacao: corpo['a:Estabelecimento'] && corpo['a:Estabelecimento']['a:TipoDeIdentificacao'] ? corpo['a:Estabelecimento']['a:TipoDeIdentificacao'] : '',\n            },\n            dadosGerais: {\n                dataAdmissao: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:DataAdmissao'] ? corpo['a:DadosGerais']['a:DataAdmissao'].split(\"T\")[0] : '',\n                dataInicioDaSituacaoAtual: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:DataInicioDaSituacaoAtual'] ? corpo['a:DadosGerais']['a:DataInicioDaSituacaoAtual'] : '',\n                matricula: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:Matricula'] ? corpo['a:DadosGerais']['a:Matricula'] : '',\n                tipoDeAdmissao: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:TipoDeAdmissao'] ? corpo['a:DadosGerais']['a:TipoDeAdmissao'] : '',\n                vinculoEmpregaticio: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:VinculoEmpregaticio'] ? corpo['a:DadosGerais']['a:VinculoEmpregaticio'] : '',\n                situacao: {\n                    codigo: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:Situacao'] && corpo['a:DadosGerais']['a:Situacao']['a:Codigo'] ? corpo['a:DadosGerais']['a:Situacao']['a:Codigo'] : '',\n                    descricao: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:Situacao'] && corpo['a:DadosGerais']['a:Situacao']['a:Descricao'] ? corpo['a:DadosGerais']['a:Situacao']['a:Descricao'] : '',\n                },\n\n            },\n            pessoa: {\n                contato: {\n                    emailCorporativo: corpo['a:Pessoa'] && corpo['a:Pessoa']['a:Contato'] && corpo['a:Pessoa']['a:Contato']['a:EmailCorporativo'] ? corpo['a:Pessoa']['a:Contato']['a:EmailCorporativo'] : '',\n                },\n                dadosPessoais: {\n                    cpfCnpj: corpo['a:Pessoa'] && corpo['a:Pessoa']['a:DadosPessoais'] && corpo['a:Pessoa']['a:DadosPessoais']['a:CpfCnpj'] ? corpo['a:Pessoa']['a:DadosPessoais']['a:CpfCnpj'] : '',\n                    nome: corpo['a:Pessoa'] && corpo['a:Pessoa']['a:DadosPessoais'] && corpo['a:Pessoa']['a:DadosPessoais']['a:Nome'] ? corpo['a:Pessoa']['a:DadosPessoais']['a:Nome'] : '',\n                    pessoaId: corpo['a:Pessoa'] && corpo['a:Pessoa']['a:DadosPessoais'] && corpo['a:Pessoa']['a:DadosPessoais']['a:PessoaID'] ? corpo['a:Pessoa']['a:DadosPessoais']['a:PessoaID'] : '',\n                },\n\n            },\n            dadosDaEscalaEPontoDoContrato: {\n                marcaPonto: corpo['a:DadosDaEscalaEPontoDoContrato'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:MarcaPonto'] ? corpo['a:DadosDaEscalaEPontoDoContrato']['a:MarcaPonto'] : '',\n                escala: {\n                    cargaHorariaMensal: corpo['a:DadosDaEscalaEPontoDoContrato'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala']['a:CargaHorariaMensal'] ? corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala']['a:CargaHorariaMensal'] : '',\n                    cargaHorariaSemanal: corpo['a:DadosDaEscalaEPontoDoContrato'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala']['a:CargaHorariaSemanal'] ? corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala']['a:CargaHorariaSemanal'] : '',\n                },\n            }\n        }\n\n        return contact;\n    } catch (e) {\n        return false\n    }\n}\n\nfunction ordenarPorDataCrescente(array) {\n    return array.sort((a, b) => {\n        const admissaoA = new Date(a[\"a:DadosGerais\"][\"a:DataAdmissao\"]);\n        const admissaoB = new Date(b[\"a:DadosGerais\"][\"a:DataAdmissao\"]);\n        \n        if (admissaoA < admissaoB) return -1;\n        if (admissaoA > admissaoB) return 1;\n        \n        const situacaoAtualA = new Date(a[\"a:DadosGerais\"][\"a:DataInicioDaSituacaoAtual\"]);\n        const situacaoAtualB = new Date(b[\"a:DadosGerais\"][\"a:DataInicioDaSituacaoAtual\"]);\n        \n        if (situacaoAtualA < situacaoAtualB) return -1;\n        if (situacaoAtualA > situacaoAtualB) return 1;\n\n        return 0;\n    });\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [SET 'colaboradorInfo'] \"+String(err);}}",
                        "inputVariables": [
                            "convertXmlToJson"
                        ],
                        "outputVariable": "colaboradorInfo",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "convertXmlToJson"
                        }
                    ],
                    "continueOnError": true
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "e57edce0-5a77-4618-a3a7-4a8745c43a9f",
            "root": false,
            "$title": "[API] Busca cadastro CPF",
            "$position": {
                "top": "680px",
                "left": "821px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "884ed89d-0ede-44c2-a7ba-beb3e0a33d89": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuCpfInvalidoBuild@type}}",
                            "rawContent": "{{menuCpfInvalidoBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "ae52c68c-daa4-4c2e-a789-f9f124ccfd53",
                    "typeOfStateId": "state",
                    "$connId": "con_73",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Digitar novamente"
                            ],
                            "variable": "menuCpfInvalidoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "b7285f90-9cd0-4444-861f-ae4066975833",
                    "typeOfStateId": "state",
                    "$connId": "con_78",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Falar com atendente"
                            ],
                            "variable": "menuCpfInvalidoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "225ad478-3dbb-4489-b61c-3ec0b8ca38c6",
                    "typeOfStateId": "state",
                    "$connId": "con_83",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Finalizar"
                            ],
                            "variable": "menuCpfInvalidoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuCpfInvalidoOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Digitar novamente\",\n\t\ttitle: \"Digitar novamente\", // At√© 24 caracteres\n\t\ttitleShort: `Digitar novamente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Falar com atendente\",\n\t\ttitle: \"Falar com atendente\", // At√© 24 caracteres\n\t\ttitleShort: `Falar com atendente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Finalizar\",\n\t\ttitle: \"Finalizar\", // At√© 24 caracteres\n\t\ttitleShort: `Finalizar`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuCpfInvalidoOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuCpfInvalidoBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Poxa! N√£o consegui identificar seu CPF, mas n√£o se preocupe, voc√™ pode abrir um chamado e falar diretamente com o atendendimento.`;\n    const textFooter = ``;\n    const nameButton = ``;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuCpfInvalidoOptions"
                        ],
                        "outputVariable": "menuCpfInvalidoBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuCpfInvalidoEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuCpfInvalidoOptions"
                        ],
                        "outputVariable": "menuCpfInvalidoEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuCpfInvalidaEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuCpfInvalidaEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuCpfInvalidaEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuCpfInvalidaEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuCpfInvalidaEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "884ed89d-0ede-44c2-a7ba-beb3e0a33d89",
            "root": false,
            "$title": "[Menu] CPF inv√°lido",
            "$position": {
                "top": "280.5px",
                "left": "2983px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "7f1fb014-9d58-44f7-91bc-e6ec477124d8": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "4c4e6250-44d8-4a3c-8245-9e65ed7b6e1b",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "3cf52219-2036-4267-8588-c14176aca31d",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "Redirect",
                    "$title": "Redirecionar a um servi√ßo",
                    "$invalid": false,
                    "settings": {
                        "address": "Main"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "onboarding",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#00FFFF",
                    "label": "DWN - Redirect",
                    "id": "DWN/TAG_RED#ac020f84-3722-47eb-8250-3845d1af6d86",
                    "canChangeBackground": false
                }
            ],
            "id": "7f1fb014-9d58-44f7-91bc-e6ec477124d8",
            "root": false,
            "$title": "[Redirect] Main - PRD",
            "$position": {
                "top": "118px",
                "left": "861px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "94590715-5781-4ca7-b53a-cbf020abf655": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "d497ccb6-eaa7-4683-83f6-09e08ce37c7a",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "9b3cf5a8-56ae-4691-ac15-42543d706177",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "9b3cf5a8-56ae-4691-ac15-42543d706177",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7b463d9b-9521-49f2-b2c3-010fa40a7526",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "421ffcee-7850-4521-9725-0aaae4a5e3b2",
                            "type": "text/plain",
                            "content": "Ol√°! √â um prazer receber voc√™ aqui novamente! ",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "421ffcee-7850-4521-9725-0aaae4a5e3b2",
                                "type": "text/plain",
                                "content": "Ol√°! √â um prazer receber voc√™ aqui novamente! "
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "dddcb0f5-5f1f-4b55-a16f-f83acac7cefd",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#c015b7f0-9abf-4729-99d4-5f97782bb4a6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "e57edce0-5a77-4618-a3a7-4a8745c43a9f",
                    "typeOfStateId": "state",
                    "$connId": "con_88",
                    "$id": "3e871408-7a33-4e84-ad05-00641f6f0174",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "a129fb83-681e-495b-8ade-63715566c927",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "return-user",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "return-user",
                        "action": "{{contact.identity}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "e57edce0-5a77-4618-a3a7-4a8745c43a9f",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "94590715-5781-4ca7-b53a-cbf020abf655",
            "root": false,
            "$title": "Boas vindas - Retorno",
            "$position": {
                "top": "361px",
                "left": "820px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "ae52c68c-daa4-4c2e-a789-f9f124ccfd53": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "71a59d59-a4b2-46b4-a831-df5e59d13109",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#e0280cb9-5d13-46b6-bd32-eadeef40ded2",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "cdfdb7f6-8c86-4794-a1cd-85cd8a03f61e",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "ae52c68c-daa4-4c2e-a789-f9f124ccfd53",
            "root": false,
            "$title": "[GO TO] Coleta CPF",
            "$position": {
                "top": "422px",
                "left": "2772px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "b7285f90-9cd0-4444-861f-ae4066975833": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "701ef5f3-bc2f-428b-8b15-2c5d2c08f88e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#e0280cb9-5d13-46b6-bd32-eadeef40ded2",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "369f1dc7-602e-4f90-b1c2-4327b4dc9469",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "Redirect",
                    "$title": "Redirecionar a um servi√ßo",
                    "$invalid": false,
                    "settings": {
                        "context": {
                            "type": "text/plain",
                            "value": "from:{{application.identifier}}"
                        },
                        "address": "Ath"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "onboarding",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#00FFFF",
                    "label": "DWN - Redirect",
                    "id": "DWN/TAG_RED#ac020f84-3722-47eb-8250-3845d1af6d86",
                    "canChangeBackground": false
                }
            ],
            "id": "b7285f90-9cd0-4444-861f-ae4066975833",
            "root": false,
            "$title": "[Redirect] Ath",
            "$position": {
                "top": "461px",
                "left": "2983px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "225ad478-3dbb-4489-b61c-3ec0b8ca38c6": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "3685fdb4-2b18-4885-994c-82c3d1ae3d35",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#e0280cb9-5d13-46b6-bd32-eadeef40ded2",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "225ad478-3dbb-4489-b61c-3ec0b8ca38c6",
            "root": false,
            "$title": "[GO TO] Encerramento",
            "$position": {
                "top": "416px",
                "left": "3196px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "41af3d94-790f-408d-96e7-c58a459e68e3",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "21fc1c9d-25cf-493c-9562-b6c3ea29e3ba",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "21fc1c9d-25cf-493c-9562-b6c3ea29e3ba",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "e8185c32-ca93-4df1-b0ff-b96e90f4eacb",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "362698e5-bcb2-4e15-a704-af7fbe79a8d7",
                            "type": "text/plain",
                            "content": "Atendimento finalizado! Se precisar falar conosco novamente, √© s√≥ me chamar. üòä",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "362698e5-bcb2-4e15-a704-af7fbe79a8d7",
                                "type": "text/plain",
                                "content": "Atendimento finalizado! Se precisar falar conosco novamente, √© s√≥ me chamar. üòä"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "ffc6e721-e770-4e4e-bb04-a67cc8a0afc2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#e0280cb9-5d13-46b6-bd32-eadeef40ded2",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "d9152c6f-4ad5-46c0-b2fc-7e3830dbac10",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "ending-flow",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "ending-flow",
                        "action": "{{contact.identity}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "7f1fb014-9d58-44f7-91bc-e6ec477124d8",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc",
            "root": false,
            "$title": "Encerramento",
            "$position": {
                "top": "121.5px",
                "left": "3930.5px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "a259153d-a9f4-4998-8893-ad7036579787": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "86e9bf80-f7e5-4a3e-b9b4-bab024b191df",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "5b1c611a-f503-46c0-bf42-5e9478bec052",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "5b1c611a-f503-46c0-bf42-5e9478bec052",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "0aeb0223-8285-47d0-acab-726f0eb4785a",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "f72ead08-8232-44ca-8b00-4b5b0d0b99a8",
                            "type": "text/plain",
                            "content": "Neowner, agora seu atendimento √© feito diretamente comigo, via Slack.\n\nBasta digitar @Sol e mandar um ‚Äúoi‚Äù na conversa que eu vou te ajudar!\n\nSe eu n√£o tiver uma resposta imediata para a sua pergunta, vou sugerir abrir um chamado, e isso ser√° feito na pr√≥pria conversa (√© s√≥ clicar em falar com atendente). Em seguida, o especialista no assunto vai dar continuidade ao atendimento.\n\nUm beijo, Sol!",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "f72ead08-8232-44ca-8b00-4b5b0d0b99a8",
                                "type": "text/plain",
                                "content": "Neowner, agora seu atendimento √© feito diretamente comigo, via Slack.\n\nBasta digitar @Sol e mandar um ‚Äúoi‚Äù na conversa que eu vou te ajudar!\n\nSe eu n√£o tiver uma resposta imediata para a sua pergunta, vou sugerir abrir um chamado, e isso ser√° feito na pr√≥pria conversa (√© s√≥ clicar em falar com atendente). Em seguida, o especialista no assunto vai dar continuidade ao atendimento.\n\nUm beijo, Sol!"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "22993fda-a6ae-4f8c-b9aa-89f092f3f8bf",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ca3dc68d-e49a-4dbc-8407-a90e6578f2a7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "5cd45ab1-831a-4962-86ad-19334af9f518",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "user-regular-registration",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "user-regular-registration",
                        "action": "{{contact.taxDocument}} | {{contact.identity}} | {{colaboradorInfo@dadosGerais.matricula}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "a259153d-a9f4-4998-8893-ad7036579787",
            "root": false,
            "$title": "[Msg] CPF colaborador ativo",
            "$position": {
                "top": "322px",
                "left": "2197px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "b7a30720-2f18-4205-96c7-7703fda7a6db": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuColaboradorNotFoundBuild@type}}",
                            "rawContent": "{{menuColaboradorNotFoundBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ca3dc68d-e49a-4dbc-8407-a90e6578f2a7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "fc5a8fc5-fb90-48a1-a7e1-bdd09ac118ca",
                    "typeOfStateId": "state",
                    "$connId": "con_93",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Digitar novamente"
                            ],
                            "variable": "menuColaboradorNotFoundEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "fd2f521e-b579-49b9-b6f9-24c24ae38000",
                    "typeOfStateId": "state",
                    "$connId": "con_98",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Falar com atendente"
                            ],
                            "variable": "menuColaboradorNotFoundEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuColaboradorNotFoundOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Digitar novamente\",\n\t\ttitle: \"Digitar novamente\", // At√© 24 caracteres\n\t\ttitleShort: `Digitar novamente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Falar com atendente\",\n\t\ttitle: \"Falar com atendente\", // At√© 24 caracteres\n\t\ttitleShort: `Falar com atendente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Finalizar\",\n\t\ttitle: \"Finalizar\", // At√© 24 caracteres\n\t\ttitleShort: `Finalizar`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuColaboradorNotFoundOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuColaboradorNotFoundBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `N√£o encontrei *nenhum cadastro com esse CPF* üòï\n\nEscolhe aqui embaixo o que voc√™ quer fazer agora üëá`;\n    const textFooter = ``;\n    const nameButton = ``;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuColaboradorNotFoundOptions"
                        ],
                        "outputVariable": "menuColaboradorNotFoundBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "17b60526-1908-49e5-bfe6-653e66775a22",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "user-not-found",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "action": "{{contact.taxDocument}} | {{contact.identity}}",
                        "category": "user-not-found"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuColaboradorNotFoundEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuColaboradorNotFoundOptions"
                        ],
                        "outputVariable": "menuColaboradorNotFoundEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuColaboradorNotFoundEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuColaboradorNotFoundEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuColaboradorNotFoundEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuColaboradorNotFoundEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuColaboradorNotFoundEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "b7a30720-2f18-4205-96c7-7703fda7a6db",
            "root": false,
            "$title": "[Menu] Colaborador n√£o encontrado",
            "$position": {
                "top": "850px",
                "left": "821px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "fc5a8fc5-fb90-48a1-a7e1-bdd09ac118ca": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "71a59d59-a4b2-46b4-a831-df5e59d13109",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ca3dc68d-e49a-4dbc-8407-a90e6578f2a7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "cdfdb7f6-8c86-4794-a1cd-85cd8a03f61e",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "fc5a8fc5-fb90-48a1-a7e1-bdd09ac118ca",
            "root": false,
            "$title": "[GO TO] Coleta CPF",
            "$position": {
                "top": "1046.75px",
                "left": "629px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "fd2f521e-b579-49b9-b6f9-24c24ae38000": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "701ef5f3-bc2f-428b-8b15-2c5d2c08f88e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ca3dc68d-e49a-4dbc-8407-a90e6578f2a7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "b7285f90-9cd0-4444-861f-ae4066975833",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "fd2f521e-b579-49b9-b6f9-24c24ae38000",
            "root": false,
            "$title": "[GO TO] Redirect Ath",
            "$position": {
                "top": "1179px",
                "left": "850px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "18bf6646-9840-4e58-86a5-a17fc4d118fb": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuPrincipalBuild@type}}",
                            "rawContent": "{{menuPrincipalBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "38939352-72d0-424f-b0ad-2efb1e69a7da",
                    "typeOfStateId": "state",
                    "$connId": "con_103",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Informe de rendimentos"
                            ],
                            "variable": "menuPrincipalEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "84ff054b-2935-47f6-a855-7b2bea5ccfe6",
                    "typeOfStateId": "state",
                    "$connId": "con_108",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "P4P"
                            ],
                            "variable": "menuPrincipalEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "149f416a-1d20-42e8-b332-db8d4142541b",
                    "typeOfStateId": "state",
                    "$connId": "con_113",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "D√∫vidas de Rescis√£o"
                            ],
                            "variable": "menuPrincipalEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "44ad5cb5-8db9-40af-9f43-315d1ee1d0a9",
                    "typeOfStateId": "state",
                    "$connId": "con_118",
                    "$id": "6bc7d620-2ec2-406e-9e8e-66d1425ae5da",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Afastamento"
                            ],
                            "variable": "menuPrincipalEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "5342b870-ba73-4f93-88ef-7cf7dc19408e",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - Checkpoint",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-principal\",\n    checkpoint: true,\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "source": "input",
                            "comparison": "equals",
                            "values": [
                                "dsadasdasdas"
                            ]
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuPrincipalOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(situacaoColaborador) {\n  try {\n\t\tconst { tipoSituacao } = JSON.parse(situacaoColaborador);\n\n\tconst allOptions = [\n\t  {\n\t\tid: \"Informe de Rendimentos\",\n\t\ttitle: \"Informe de Rendimentos\", // At√© 24 caracteres\n\t\ttitleShort: `Informe Rendimentos`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"P4P\",\n\t\ttitle: \"P4P\", // At√© 24 caracteres\n\t\ttitleShort: `P4P`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"D√∫vidas de Rescis√£o\",\n\t\ttitle: \"D√∫vidas de Rescis√£o\", // At√© 24 caracteres\n\t\ttitleShort: `D√∫vidas de Rescis√£o`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: tipoSituacao === \"Rescis√£o\",\n\t  },\n\t  {\n\t\tid: \"Afastamento\",\n\t\ttitle: \"Afastamento\", // At√© 24 caracteres\n\t\ttitleShort: `Afastamento`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: tipoSituacao === \"Afastamento\",\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [
                            "situacaoColaborador"
                        ],
                        "outputVariable": "menuPrincipalOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuPrincipalBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Escolha o assunto que voc√™ deseja falar.`;\n    const textFooter = `Para voltar aqui, digite ‚ÄúMenu‚Äù.`;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuPrincipalOptions"
                        ],
                        "outputVariable": "menuPrincipalBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuPrincipalEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuPrincipalOptions"
                        ],
                        "outputVariable": "menuPrincipalEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuPrincipalEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuPrincipalEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuPrincipalEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuPrincipalEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuPrincipalEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "18bf6646-9840-4e58-86a5-a17fc4d118fb",
            "root": false,
            "$title": "[Menu] Principal",
            "$position": {
                "top": "706px",
                "left": "1928px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "44ad5cb5-8db9-40af-9f43-315d1ee1d0a9": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "bf75c4d5-3eba-4ae8-bdd3-1a926aa8cbb9",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "e0b9aa1e-eb38-415d-8a45-6ec728a711d1",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "44ad5cb5-8db9-40af-9f43-315d1ee1d0a9",
            "root": false,
            "$title": "[GO TO] Afastamento",
            "$position": {
                "top": "781px",
                "left": "1618px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "149f416a-1d20-42e8-b332-db8d4142541b": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "64319337-9df8-43d2-a841-d8ca713b77e4",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "1a99da74-3723-4464-8be4-444c3bc535b8",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "149f416a-1d20-42e8-b332-db8d4142541b",
            "root": false,
            "$title": "[GO TO] D√∫vidas de Rescis√£o",
            "$position": {
                "top": "902px",
                "left": "1782px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "84ff054b-2935-47f6-a855-7b2bea5ccfe6": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "e161b199-e956-4334-ad85-ea320c66fc7c",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "360f0a20-9da4-4aff-981c-2e69ab81590c",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "84ff054b-2935-47f6-a855-7b2bea5ccfe6",
            "root": false,
            "$title": "[GO TO] P4P",
            "$position": {
                "top": "906px",
                "left": "1970px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "38939352-72d0-424f-b0ad-2efb1e69a7da": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "6ee31c04-813d-4dc9-ad87-5fc6f5012336",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "6ffaf47b-15de-44e7-841e-6f086a57be38",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "38939352-72d0-424f-b0ad-2efb1e69a7da",
            "root": false,
            "$title": "[GO TO] Informe de rendimentos",
            "$position": {
                "top": "795px",
                "left": "2148px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "e2daf0ad-4eb4-4249-87a5-91bd8969239a": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "0c477bbe-df69-4227-9382-289d513d44da",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "2583f4e8-ed27-4fb7-bade-32be17df102f",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "2583f4e8-ed27-4fb7-bade-32be17df102f",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "20de0a09-54d9-4d17-af11-ce7e9bfe51ce",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{mediaFile@type}}",
                            "rawContent": "{{mediaFile@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "2cb050d5-4daf-44c1-846e-a47bd29f88ce",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "886f7e93-ca7f-400e-9615-a920d1da936d",
                    "typeOfStateId": "state",
                    "$connId": "con_123",
                    "$id": "05be8b88-cdc2-4171-a8d8-849af6cfca66",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "1a32fc74-183d-4fcd-8c22-e85a62a147f4",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'mediaFile'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n    try {\n        const fileName = \"Retorno ao Trabalho\";\n\t\tconst fileBodyText = \"Aqui est√° tudinho que voc√™ precisa saber para retornar ao trabalho üòÄ\"\n        const fileUrl = \"https://assets.dawntech.dev/content/neon/inss_retorno_ao_trabalho.pdf\";\n\n        return {\n            \"type\": \"application/vnd.lime.media-link+json\",\n            \"content\": {\n                \"title\": fileName,\n\t\t\t\t\"text\": fileBodyText,\n                \"uri\": fileUrl,\n                \"type\": \"application/pdf\"\n            }\n        }\n    } catch (error) {\n        return error.message;\n    }\n}",
                        "inputVariables": [],
                        "outputVariable": "mediaFile",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "e2daf0ad-4eb4-4249-87a5-91bd8969239a",
            "root": false,
            "$title": "Retorno ao trabalho",
            "$position": {
                "top": "1607px",
                "left": "1233px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "a5f35cf6-0755-4fef-b177-64f1e5916aae": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "f5652e82-d190-4560-88eb-b5082ea65ff9",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "33dd6e71-d609-456e-8636-148ee5b6f38c",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "33dd6e71-d609-456e-8636-148ee5b6f38c",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "9bd1540e-6c8a-4809-a108-e322b3254d1a",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{mediaFile@type}}",
                            "rawContent": "{{mediaFile@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "9bd6b714-4c65-468f-95b7-49e68fdbc83e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "886f7e93-ca7f-400e-9615-a920d1da936d",
                    "typeOfStateId": "state",
                    "$connId": "con_128",
                    "$id": "db631606-3c9b-4319-8336-f940c51e8453",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "29c94d09-5248-4d4a-83b2-ada56d88024e",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'mediaFile'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n    try {\n        const fileUrl = \"https://assets.dawntech.dev/content/neon/inss_complementacao_salarial.pdf\";\n        const fileName = \"Complemento Previd√™ncia\";\n\t\tconst fileBodyText = \"Aqui est√° tudinho que voc√™ precisa saber sobre complemente previdenci√°rio üòÄ\";\n\n        return {\n            \"type\": \"application/vnd.lime.media-link+json\",\n            \"content\": {\n                \"title\": fileName,\n\t\t\t\t\"text\": fileBodyText,\n                \"uri\": fileUrl,\n                \"type\": \"application/pdf\"\n            }\n        }\n    } catch (error) {\n        return error.message;\n    }\n}",
                        "inputVariables": [],
                        "outputVariable": "mediaFile",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "a5f35cf6-0755-4fef-b177-64f1e5916aae",
            "root": false,
            "$title": "Complemento previd√™ncia",
            "$position": {
                "top": "1465px",
                "left": "1247px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "31317339-ec29-402d-bde9-c30b6dbe977a": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "9ceff772-dbbf-42cd-8d5d-5d072f1814c0",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "078be3ee-3405-4be6-9c8a-992678d7570f",
                    "typeOfStateId": "state",
                    "$connId": "con_133",
                    "$id": "4b022f65-754a-4bc4-af1c-974719b011d9",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "31317339-ec29-402d-bde9-c30b6dbe977a",
            "root": false,
            "$title": "[Valida] Tipo afastamento",
            "$position": {
                "top": "1647.43px",
                "left": "1511.43px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "078be3ee-3405-4be6-9c8a-992678d7570f": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuMeuAfastamentoBuild@type}}",
                            "rawContent": "{{menuMeuAfastamentoBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "5f1475e3-f6f1-48a4-8279-19e01607fe54",
                    "typeOfStateId": "state",
                    "$connId": "con_138",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Holerite"
                            ],
                            "variable": "menuMeuAfastamentoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "e2daf0ad-4eb4-4249-87a5-91bd8969239a",
                    "typeOfStateId": "state",
                    "$connId": "con_143",
                    "$id": "46002699-4d80-4935-8324-abfdb63a16a2",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Retorno ao trabalho"
                            ],
                            "variable": "menuMeuAfastamentoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "499116aa-7ba3-4814-9da6-81718a4c6ab6",
                    "typeOfStateId": "state",
                    "$connId": "con_148",
                    "$id": "2cf5f458-fee7-4971-9d6b-837b57958200",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Falar com atendente"
                            ],
                            "variable": "menuMeuAfastamentoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "16b7e265-79d5-41d5-bbce-078f594c79d6",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - Checkpoint",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-meu-afastamento\",\n    checkpoint: true,\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMeuAfastamentoOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Holerite\",\n\t\ttitle: \"Holerite\", // At√© 24 caracteres\n\t\ttitleShort: `Holerite`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Retorno ao trabalho\",\n\t\ttitle: \"Retorno ao trabalho\", // At√© 24 caracteres\n\t\ttitleShort: `Retorno ao trabalho`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Falar com atendente\",\n\t\ttitle: \"Falar com atendente\", // At√© 24 caracteres\n\t\ttitleShort: `Falar com atendente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuMeuAfastamentoOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMeuAfastamentoBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Selecione a op√ß√£o desejada abaixo. üëá`;\n    const textFooter = ``;\n    const nameButton = ``;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuMeuAfastamentoOptions"
                        ],
                        "outputVariable": "menuMeuAfastamentoBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMeuAfastamentoEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuMeuAfastamentoOptions"
                        ],
                        "outputVariable": "menuMeuAfastamentoEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuMeuAfastamentoEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuMeuAfastamentoEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuMeuAfastamentoEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuMeuAfastamentoEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuMeuAfastamentoEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "078be3ee-3405-4be6-9c8a-992678d7570f",
            "root": false,
            "$title": "[Menu] Meu afastamento",
            "$position": {
                "top": "1796px",
                "left": "1511px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "5f1475e3-f6f1-48a4-8279-19e01607fe54": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuHoleriteBuild@type}}",
                            "rawContent": "{{menuHoleriteBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "24b1aca0-2afb-4551-ad25-166845ae6d24",
                    "typeOfStateId": "state",
                    "$connId": "con_153",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "notEquals",
                            "values": [
                                "inv√°lido"
                            ],
                            "variable": "menuHoleriteEscolha"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "d48b14b1-db66-4e3d-b215-2fe8ff3dd1f1",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - Checkpoint",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-holerite\",\n    checkpoint: true,\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuHoleriteOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"1\",\n\t\ttitle: \"Mensal\", // At√© 24 caracteres\n\t\ttitleShort: `Mensal`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"15\",\n\t\ttitle: \"P4P\", // At√© 24 caracteres\n\t\ttitleShort: `P4P`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"4\",\n\t\ttitle: \"13¬∫ Sal√°rio\", // At√© 24 caracteres\n\t\ttitleShort: `13¬∫ Sal√°rio`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuHoleriteOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuHoleriteBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Selecione a folha de pagamento que voc√™ gostaria de consultar. üëá`;\n    const textFooter = ``;\n    const nameButton = ``;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuHoleriteOptions"
                        ],
                        "outputVariable": "menuHoleriteBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuHoleriteEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuHoleriteOptions"
                        ],
                        "outputVariable": "menuHoleriteEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuHoleriteEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuHoleriteEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuHoleriteEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuHoleriteEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuHoleriteEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "5f1475e3-f6f1-48a4-8279-19e01607fe54",
            "root": false,
            "$title": "[Menu] Holerite",
            "$position": {
                "top": "1969px",
                "left": "1511px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "e0b9aa1e-eb38-415d-8a45-6ec728a711d1": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuAfastamentoBuild@type}}",
                            "rawContent": "{{menuAfastamentoBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "31317339-ec29-402d-bde9-c30b6dbe977a",
                    "typeOfStateId": "state",
                    "$connId": "con_158",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Meu afastamento"
                            ],
                            "variable": "menuAfastamentoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "e2daf0ad-4eb4-4249-87a5-91bd8969239a",
                    "typeOfStateId": "state",
                    "$connId": "con_163",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Retorno ao trabalho"
                            ],
                            "variable": "menuAfastamentoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "a5f35cf6-0755-4fef-b177-64f1e5916aae",
                    "typeOfStateId": "state",
                    "$connId": "con_168",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Complemento previd√™ncia"
                            ],
                            "variable": "menuAfastamentoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "5aea3127-dc28-4569-9b81-cad25259da91",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - Checkpoint",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-afastamento\",\n    checkpoint: true,\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuAfastamentoOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Meu afastamento\",\n\t\ttitle: \"Meu afastamento\", // At√© 24 caracteres\n\t\ttitleShort: `Meu afastamento`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Retorno ao trabalho\",\n\t\ttitle: \"Retorno ao trabalho\", // At√© 24 caracteres\n\t\ttitleShort: `Retorno ao trabalho`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Complemento previd√™ncia\",\n\t\ttitle: \"Complemento previd√™ncia\", // At√© 24 caracteres\n\t\ttitleShort: `Complemento prev`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuAfastamentoOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuAfastamentoBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options, colaboradorInfo) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const descricaoSituacao = JSON.parse(colaboradorInfo).dadosGerais.situacao.descricao;\n\n    const textHeader = \"\";\n    const textBody = `Certo, identifiquei que voc√™ tem um afastamento ${descricaoSituacao}, para esse tipo de afastamento tenho essas informa√ß√µes:`;\n    const textFooter = ``;\n    const nameButton = ``;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuAfastamentoOptions",
                            "colaboradorInfo"
                        ],
                        "outputVariable": "menuAfastamentoBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuAfastamentoEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuAfastamentoOptions"
                        ],
                        "outputVariable": "menuAfastamentoEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuAfastamentoEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuAfastamentoEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuAfastamentoEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuAfastamentoEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuAfastamentoEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "e0b9aa1e-eb38-415d-8a45-6ec728a711d1",
            "root": false,
            "$title": "[Menu] Afastamento",
            "$position": {
                "top": "1475px",
                "left": "1511px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "3fe5d760-3084-4777-8e02-5e8db7c41255": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuMesHoleriteBuild@type}}",
                            "rawContent": "{{menuMesHoleriteBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "ca7529a0-43a2-4668-b8ed-95e0133432ac",
                    "typeOfStateId": "state",
                    "$connId": "con_173",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "notEquals",
                            "values": [
                                "inv√°lido"
                            ],
                            "variable": "menuMesHoleriteEscolha"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMesHoleriteOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(listMonths) {\n\ttry {\n\t\tconst allOptions = JSON.parse(listMonths).map(item => ({\n\t\t\tid: `mesPagamento:${item.id}`,\n\t\t\ttitle: item.id,\n\t\t\ttitleShort: item.id,\n\t\t\tdescription: \"\",\n\t\t\tactive: true\n\n\t\t}));\n\n\t\tallOptions.push(\n\t\t\t\t{\n\t\t\t\t\tid: \"Menu anterior\",\n\t\t\t\t\ttitle: \"Menu anterior\",\n\t\t\t\t\ttitleShort: \"Menu anterior\",\n\t\t\t\t\tdescription: \"\",\n\t\t\t\t\tactive: true\n\t\t\t\t}\n\t\t)\n\n\t\treturn allOptions.filter(item => item.active);\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}",
                        "inputVariables": [
                            "listMonths"
                        ],
                        "outputVariable": "menuMesHoleriteOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMesHoleriteBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Selecione o m√™s desejado. üëá`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuMesHoleriteOptions"
                        ],
                        "outputVariable": "menuMesHoleriteBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMesHoleriteEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuMesHoleriteOptions"
                        ],
                        "outputVariable": "menuMesHoleriteEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuMesHoleriteEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuMesHoleriteEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuMesHoleriteEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuMesHoleriteEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuMesHoleriteEscolha"
                        }
                    ]
                },
                {
                    "$id": "24cdfddc-a01b-44c4-8989-61b3817bac85",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'mesAnoBusca'",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run(itemEscolhidoObjeto){\n    try{ \n\t\tconst [mesBusca, anoBusca] = JSON.parse(itemEscolhidoObjeto).title.split('/');\n        \n        return {\n            mesBusca,\n            anoBusca\n        } \n    } catch(error){\n        return false\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [SET 'mesAnoBusca'] \"+String(err);}}",
                        "inputVariables": [
                            "menuMesHoleriteEscolha"
                        ],
                        "outputVariable": "mesAnoBusca",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "variable": "menuMesHoleriteEscolha",
                            "comparison": "notEquals"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "variable": "menuMesHoleriteEscolha",
                            "comparison": "exists"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "3fe5d760-3084-4777-8e02-5e8db7c41255",
            "root": false,
            "$title": "[Menu] Sele√ß√£o m√™s holerite",
            "$position": {
                "top": "2282px",
                "left": "1511px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "3500e819-756e-48d0-8a93-a43088a700fc": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "185b02f2-438e-4530-86b4-8e467dc43e5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "31f737c8-9d9b-4e06-a9e3-d29da670235c",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "31f737c8-9d9b-4e06-a9e3-d29da670235c",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "af403cbb-5d63-4f74-9f74-f84f42d684bf",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "07822f5e-568a-47c9-90a0-78c807cc6a85",
                            "type": "text/plain",
                            "content": "{{messageHolerite}}",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "07822f5e-568a-47c9-90a0-78c807cc6a85",
                                "type": "text/plain",
                                "content": "{{messageHolerite}}"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "3a6d3421-2bb8-4518-86e5-651192a411e7",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "4bedd28d-c3f9-4b9b-ba98-ffd84e0e5718",
                    "typeOfStateId": "state",
                    "$connId": "con_178",
                    "$id": "fdfee591-7b26-462b-ab01-a8eea6082cc8",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "28133a21-0995-4114-9240-4e4f9e1527d0",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'messageHolerite'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(recebidoHoleriteInfo) {\n\ttry {\n\t\tconst { descricao, salarioBase, totalDesconto, totalLiquido, totalProvento } = JSON.parse(recebidoHoleriteInfo);\n\n\t\treturn `Aqui est√° um resumo do seu holerite:\n\n${descricao}\n\n*Sal√°rio Base*: R$ ${formatarNumeroBrasileiro(salarioBase)}\n*Total de Proventos*: R$ ${formatarNumeroBrasileiro(totalProvento)}\n*Total de Descontos*: R$ ${formatarNumeroBrasileiro(totalDesconto)}\n\n*Total L√≠quido*: R$ ${formatarNumeroBrasileiro(totalLiquido)}\n\nPara mais informa√ß√µes completo clique em <b>‚ÄúFalar com atendente‚Äù</b> no menu a seguir.`;\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}\n\nfunction formatarNumeroBrasileiro(numero) {\n    const numeroFormatado = Number(numero).toFixed(2);\n    const partes = numeroFormatado.split(\".\");\n    partes[0] = partes[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\n    const resultado = partes.join(\",\");\n  \n    return resultado;\n  }",
                        "inputVariables": [
                            "recebidoHoleriteInfo"
                        ],
                        "outputVariable": "messageHolerite",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "3500e819-756e-48d0-8a93-a43088a700fc",
            "root": false,
            "$title": "Resumo holerite",
            "$position": {
                "top": "2613px",
                "left": "1511px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "32e5f224-1cf3-4733-a916-dfe04b984054": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuAlgoMaisBuild@type}}",
                            "rawContent": "{{menuAlgoMaisBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "a98902d7-7d20-4112-b50a-46b529b3aa1c",
                    "typeOfStateId": "state",
                    "$connId": "con_183",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Falar com atendente"
                            ],
                            "variable": "menuAlgoMaisEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "8efb02ba-7a1b-40cf-85b9-30e8bbbe2e69",
                    "typeOfStateId": "state",
                    "$connId": "con_188",
                    "$id": "c1b64f15-4452-4031-b3e6-844da30b8466",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Menu principal"
                            ],
                            "variable": "menuAlgoMaisEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "7d87df52-c279-4f10-abf4-83bab974431a",
                    "typeOfStateId": "state",
                    "$connId": "con_193",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Finalizar"
                            ],
                            "variable": "menuAlgoMaisEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "d5ab2e50-1d08-41ea-9215-701968ee7188",
                    "typeOfStateId": "state",
                    "$connId": "con_198",
                    "$id": "627bffbf-4f12-4806-b319-a34ef1d80d9c",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Menu anterior"
                            ],
                            "variable": "menuAlgoMaisEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuAlgoMaisOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(algoMaisTransbordo) {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Falar com atendente\",\n\t\ttitle: \"Falar com atendente\", // At√© 24 caracteres\n\t\ttitleShort: `Falar com atendente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: JSON.parse(algoMaisTransbordo),\n\t  },\n\t  {\n\t\tid: \"Menu principal\",\n\t\ttitle: \"Menu principal\", // At√© 24 caracteres\n\t\ttitleShort: `Menu principal`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Menu anterior\",\n\t\ttitle: \"Menu anterior\", // At√© 24 caracteres\n\t\ttitleShort: `Menu anterior`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Finalizar\",\n\t\ttitle: \"Finalizar\", // At√© 24 caracteres\n\t\ttitleShort: `Finalizar`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: !JSON.parse(algoMaisTransbordo),\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [
                            "algoMaisTransbordo"
                        ],
                        "outputVariable": "menuAlgoMaisOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuAlgoMaisBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options, algoMaisTransbordo) {\n  try {\n    algoMaisTransbordo = JSON.parse(algoMaisTransbordo);\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textBodyAth = `Clique abaixo no que voc√™ gostaria de fazer agora: üëá\n\nSe quiser encerrar o atendimento, digite *‚ÄúFinalizar‚Äù*.`;\n    const textBodyDefault = `Clique abaixo no que voc√™ gostaria de fazer agora: üëá`;\n\n    const textHeader = \"\";\n    const textBody = algoMaisTransbordo ? textBodyAth : textBodyDefault;\n    const textFooter = ``;\n    const nameButton = ``;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuAlgoMaisOptions",
                            "algoMaisTransbordo"
                        ],
                        "outputVariable": "menuAlgoMaisBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuAlgoMaisEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuAlgoMaisOptions"
                        ],
                        "outputVariable": "menuAlgoMaisEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuAlgoMaisEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuAlgoMaisEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuAlgoMaisEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuAlgoMaisEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuAlgoMaisEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "32e5f224-1cf3-4733-a916-dfe04b984054",
            "root": false,
            "$title": "[Menu] Algo mais",
            "$position": {
                "top": "1337.5px",
                "left": "293.5px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "a98902d7-7d20-4112-b50a-46b529b3aa1c": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "8ae1ae87-2a54-4e9a-b793-4f9ef59966b5",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "b7285f90-9cd0-4444-861f-ae4066975833",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "a98902d7-7d20-4112-b50a-46b529b3aa1c",
            "root": false,
            "$title": "[GO TO] Redirect Ath",
            "$position": {
                "top": "1453.5px",
                "left": "0px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "8efb02ba-7a1b-40cf-85b9-30e8bbbe2e69": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "a2bce5f9-0c3a-4b0f-872c-0773034f2681",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "18bf6646-9840-4e58-86a5-a17fc4d118fb",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "8efb02ba-7a1b-40cf-85b9-30e8bbbe2e69",
            "root": false,
            "$title": "[GO TO] Menu principal",
            "$position": {
                "top": "1521.75px",
                "left": "193.75px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "7d87df52-c279-4f10-abf4-83bab974431a": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "c944c39e-4937-4c17-9bf5-63e77f7f39ab",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "7d87df52-c279-4f10-abf4-83bab974431a",
            "root": false,
            "$title": "[GO TO] Encerramento",
            "$position": {
                "top": "1525.25px",
                "left": "384.5px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "d5ab2e50-1d08-41ea-9215-701968ee7188": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "a734713c-78cc-45d4-a2b6-7b8629768c3b",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ccdb0935-1324-4fad-a9c9-5133a27b7b3a",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "d5ab2e50-1d08-41ea-9215-701968ee7188",
            "root": false,
            "$title": "[GO TO] Fallback - Voltar",
            "$position": {
                "top": "1444px",
                "left": "575.25px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "e45ebdbd-3d62-410e-a193-33d4258874ba": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "950d96ae-cf57-4955-8b10-213fa971e0a1",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "18bf6646-9840-4e58-86a5-a17fc4d118fb",
                    "typeOfStateId": "state",
                    "$connId": "con_203",
                    "$id": "429a5e54-68f6-4678-9304-baa6cfd6001b",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Rescis√£o",
                                "Afastamento"
                            ],
                            "variable": "situacaoColaborador@tipoSituacao"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "e1631861-2e4c-4b0b-bad6-37ca2d46bf21",
                    "typeOfStateId": "state",
                    "$connId": "con_208",
                    "$id": "6a9bfb1f-f43a-4d5f-9844-712307474a3d",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "F√©rias",
                                "Atividade normal",
                                "Recesso"
                            ],
                            "variable": "situacaoColaborador@tipoSituacao"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "19aee38a-6f55-4080-9c39-3c8117c1f70e",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'personType'",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run(colaboradorInfo){\n    try{\n        colaboradorInfo = JSON.parse(colaboradorInfo);\n        \n        const id = colaboradorInfo.dadosGerais.vinculoEmpregaticio\n        const partnerIds = [\"80\"]\n        \n        if(partnerIds.includes(id)){\n            return \"PARTNER\"\n        }\n        \n        return \"EMPLOYEE\"\n        \n    }catch(error){\n        return false;\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [SET 'personType'] \"+String(err);}}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "outputVariable": "personType",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "af961fee-8134-4360-9498-0179cbe12175",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'firstName'",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run(response) {\n  try {\n    const FIRSTNAME = JSON.parse(response).pessoa.dadosPessoais.nome\n    .split(\" \")[0];\n\n    return FIRSTNAME.charAt(0).toUpperCase() + FIRSTNAME.slice(1).toLowerCase();\n  } catch (error) {\n    return false;\n  }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [SET 'firstName'] \"+String(err);}}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "outputVariable": "firstName",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "4a42b5fe-bdbe-43c7-86e8-4e05148fc984",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'situacaoColaborador'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(colaborador) {\n    try {\n        const listaAtividades = returnCodigosAfastamento();\n\n        const codigo = JSON.parse(colaborador).dadosGerais.situacao.codigo;\n\n        return listaAtividades.find(item => item.codigoSituacao == codigo) || false;\n    } catch (error) {\n        return false;\n    }\n}\n\nfunction returnCodigosAfastamento() {\n    return [\n        {\n            \"codigoSituacao\": 1,\n            \"descricao\": \"ATIVIDADE NORMAL\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 2,\n            \"descricao\": \"AF ACID TRAB ACIMA PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 3,\n            \"descricao\": \"AF DOENCA ACIMA PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 4,\n            \"descricao\": \"AF LIC MATERNIDADE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 5,\n            \"descricao\": \"AF SERVICO MILITAR\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 6,\n            \"descricao\": \"AF SEM BENEFICIO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 7,\n            \"descricao\": \"FERIAS NOR AD 13 SAL/AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 8,\n            \"descricao\": \"FERIAS NOR AD 13 SAL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 9,\n            \"descricao\": \"FERIAS NOR\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 10,\n            \"descricao\": \"FERIAS NOR AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 11,\n            \"descricao\": \"FERIAS COL AD 13 SAL/AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 12,\n            \"descricao\": \"FERIAS COL AD 13 SAL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 13,\n            \"descricao\": \"FERIAS COL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 14,\n            \"descricao\": \"FERIAS COL AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 15,\n            \"descricao\": \"RESC PEDIDO DEMISS NA EXP\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 16,\n            \"descricao\": \"RESC PEDIDO DEMISS AVISO IND\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 17,\n            \"descricao\": \"RESC PEDIDO DEMISS AVISO TRAB\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 18,\n            \"descricao\": \"RESC TER CON NA EXPERIENCIA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 19,\n            \"descricao\": \"RESC DEMIS NA EXPERIENCIA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 20,\n            \"descricao\": \"RESC DEMIS S/ JC AVISO IND\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 21,\n            \"descricao\": \"RESC DEMIS S/ JC AVISO TRAB\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 22,\n            \"descricao\": \"RESC DEMIS COM JUSTA CAUSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 23,\n            \"descricao\": \"RESC FALECIMENTO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 24,\n            \"descricao\": \"RESC APOSENT TEMPO SERVICO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 25,\n            \"descricao\": \"RESC APOSENT POR INVALIDEZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 26,\n            \"descricao\": \"TRANSFERENCIA C/ONUS P/CEDENTE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 27,\n            \"descricao\": \"TRANSFERENCIA S/ONUS P/CEDENTE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 28,\n            \"descricao\": \"RESC TER CON TRA APOS TEMP SER\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 29,\n            \"descricao\": \"APOSENTADORIA ACID TRABALHO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 30,\n            \"descricao\": \"APOSENTADORIA EXCETO DOE/AC TR\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 31,\n            \"descricao\": \"APOSENTADORIA DOENCA/PROFIS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 32,\n            \"descricao\": \"AF LICENCA REMUNERADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 33,\n            \"descricao\": \"ATIVIDADE NORMAL ESTAGIARIO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 34,\n            \"descricao\": \"AF LIC PATERNIDADE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 35,\n            \"descricao\": \"AF ACID TRAB ATE O PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 36,\n            \"descricao\": \"ATIVIDADE NORMAL PRO LABORE\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 37,\n            \"descricao\": \"AF DOENCA ATE O PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 38,\n            \"descricao\": \"RESC APOSENT POR IDADE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 39,\n            \"descricao\": \"RESCISAO  ESTAGIARIO EXTINCAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 40,\n            \"descricao\": \"RESCISAO  ESTAGIARIO DISPENSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 41,\n            \"descricao\": \"RESCISAO  ESTAGIARIO PEDIDO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 42,\n            \"descricao\": \"AF LIC MATERNIDADE PRORROG\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 43,\n            \"descricao\": \"AF OUTROS MOTIVOS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 44,\n            \"descricao\": \"ESTAGIARIO EM RECESSO\",\n            \"codigoTipoSituacao\": 4,\n            \"tipoSituacao\": \"Recesso\"\n        },\n        {\n            \"codigoSituacao\": 45,\n            \"descricao\": \"AF LICENCA NAO REMUNERADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 46,\n            \"descricao\": \"AF EXPATRIADO COM FGTS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 47,\n            \"descricao\": \"GESTANTE DESLOCADA AMBIENTE INSALUBRE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 48,\n            \"descricao\": \"AF OUTROS MOTIVOS ( MIGRA√á√ÉO)\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 50,\n            \"descricao\": \"ATIVIDADE NORMAL VINCULO INTERMITENTE\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 51,\n            \"descricao\": \"FERIAS VINCULO INTERMITENTE\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 52,\n            \"descricao\": \"RESC VINCULO INTERMITENTE DEMISSAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 53,\n            \"descricao\": \"RESC VINCULO INTERMITENTE PEDIDO DEMISSAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 54,\n            \"descricao\": \"RESC VINCULO INTERMITENTE TERMINO CONTRATO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 79,\n            \"descricao\": \"ATIVIDADE NORMAL APRENDIZ\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 80,\n            \"descricao\": \"AF LIC MATERNIDADE EMP CIDADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 81,\n            \"descricao\": \"RESCISAO PRO LABORE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 82,\n            \"descricao\": \"RESC TER CON MENOR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 83,\n            \"descricao\": \"AF SUSPENSAO CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 84,\n            \"descricao\": \"AF SUSPENSAO CONTR TRABALHO LEI 14020\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 85,\n            \"descricao\": \"AF LIC ABORTO NAO CRIMINOSO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 86,\n            \"descricao\": \"ATIVIDADE NORMAL DIRETOR ESTAT\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 87,\n            \"descricao\": \"ATIVIDADE NORMAL CONSELHEIRO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 88,\n            \"descricao\": \"RESCISAO DIRETOR ESTATUTARIO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 89,\n            \"descricao\": \"RESCISAO CONSELHEIRO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 90,\n            \"descricao\": \"AF LIC PATERNIDADE EMP CIDADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 91,\n            \"descricao\": \"RESC PEDIDO DEM C/JUSTA CAUSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 92,\n            \"descricao\": \"RESC PEDIDO ANT CONTR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 93,\n            \"descricao\": \"RESC DEMIS ANT CONTR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 94,\n            \"descricao\": \"RESC DEMIS ANT CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 95,\n            \"descricao\": \"RESC TERMINO CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 96,\n            \"descricao\": \"RESC INDIRETA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 97,\n            \"descricao\": \"RESC DEMIS S/ JC PDV\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 98,\n            \"descricao\": \"AF LIC MATERNIDADE ADOCAO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 99,\n            \"descricao\": \"RESC DEMIS S/ JC MUTUO ACORDO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 100,\n            \"descricao\": \"ATIVIDADE NORMAL AUTONOMO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 101,\n            \"descricao\": \"VINCULO AUTONOMO INATIVO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        }\n    ]\n}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "LocalTimeZoneEnabled": false,
                        "outputVariable": "situacaoColaborador"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "ac737c2e-fb0d-4275-ad3e-2c368d7304b3",
                    "$typeOfContent": "",
                    "type": "MergeContact",
                    "$title": "Definir contato",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "pessoaId": "{{colaboradorInfo@pessoa.dadosPessoais.pessoaId}}",
                            "dataAdmissao": "{{colaboradorInfo@dadosGerais.dataAdmissao}}",
                            "matricula": "{{colaboradorInfo@dadosGerais.matricula}}",
                            "situacao": "{{colaboradorInfo@dadosGerais.situacao.descricao}}",
                            "empresaId": "{{colaboradorInfo@empresa.codigo}}",
                            "empresa": "{{colaboradorInfo@empresa.descricao}}",
                            "primeiroNome": "{{firstName}}"
                        },
                        "name": "{{colaboradorInfo@pessoa.dadosPessoais.nome}}",
                        "email": "{{colaboradorInfo@pessoa.contato.emailCorporativo}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "colaboradorInfo"
                        },
                        {
                            "values": [
                                "false"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "colaboradorInfo"
                        }
                    ]
                },
                {
                    "$id": "b92f02bc-0741-4a60-8b62-1c0462cc733c",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Definir Time",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "Time": "{{situacaoColaborador@tipoSituacao}}"
                        }
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "source": "context",
                            "variable": "situacaoColaborador@tipoSituacao",
                            "comparison": "equals",
                            "values": [
                                "Afastamento",
                                "Rescis√£o"
                            ]
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                }
            ],
            "id": "e45ebdbd-3d62-410e-a193-33d4258874ba",
            "root": false,
            "$title": "[Valida] Afastamento-Rescis√£o",
            "$position": {
                "top": "657px",
                "left": "1325px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "886f7e93-ca7f-400e-9615-a920d1da936d": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "13addc09-6a9c-4b1c-b54d-e8da5790c25f",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "ce66e136-26c3-4748-807c-bf4ff8b25874",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'algoMaisTransbordo' to true",
                    "$invalid": false,
                    "settings": {
                        "variable": "algoMaisTransbordo",
                        "value": "true"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "32e5f224-1cf3-4733-a916-dfe04b984054",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "886f7e93-ca7f-400e-9615-a920d1da936d",
            "root": false,
            "$title": "[GO TO] Algo mais Ath",
            "$position": {
                "top": "1482px",
                "left": "1001px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "499116aa-7ba3-4814-9da6-81718a4c6ab6": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "709e09fe-9bd3-4fef-bcdb-e225b3bcf5cd",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "b7285f90-9cd0-4444-861f-ae4066975833",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "499116aa-7ba3-4814-9da6-81718a4c6ab6",
            "root": false,
            "$title": "[GO TO] Redirect Ath",
            "$position": {
                "top": "1807px",
                "left": "1732px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "ca7529a0-43a2-4668-b8ed-95e0133432ac": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "2881af28-bf99-42e1-a9f2-a9817ee63bcc",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "3500e819-756e-48d0-8a93-a43088a700fc",
                    "typeOfStateId": "state",
                    "$connId": "con_213",
                    "$id": "a7aca5f4-1b1a-44c9-8b4c-4c7b3d1a3bf7",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "74401c59-c843-4d5c-a6c0-705fb806a4ab",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "corpoReciboHolerite",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run() {\n\tconst output = `<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:dto=\"lg.com.br/svc/dto\" xmlns:v1=\"lg.com.br/api/v1\" xmlns:v11=\"lg.com.br/api/dto/v1\">\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n   <soapenv:Body>\n    <v1:ConsultarReciboDePagamentoDetalhado>\n      <v1:filtro>\n        <v11:Colaborador>\n          <v11:Empresa>\n            <v11:Codigo>{{contact.extras.empresaId}}</v11:Codigo>\n          </v11:Empresa>\n          <v11:Matricula>{{contact.extras.matricula}}</v11:Matricula>\n        </v11:Colaborador>\n        <v11:FolhaDePagamentoCodigo>{{menuHoleriteEscolha@id}}</v11:FolhaDePagamentoCodigo>\n        <v11:Referencia>\n          <v11:Ano>{{mesAnoBusca@anoBusca}}</v11:Ano>\n          <v11:Mes>{{mesAnoBusca@mesBusca}}</v11:Mes>\n        </v11:Referencia>\n      </v1:filtro>\n    </v1:ConsultarReciboDePagamentoDetalhado>\n  </soapenv:Body>\n</soapenv:Envelope>`\n\ttry {\n\t\treturn output;\n\t} catch (e) {\n\t\treturn output;\n\t}\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [corpoReciboHolerite] \"+String(err);}}",
                        "inputVariables": [],
                        "outputVariable": "corpoReciboHolerite",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5958bc3b-7fcd-454f-b2eb-3949cbfbf064",
                    "$typeOfContent": "",
                    "type": "ProcessHttp",
                    "$title": "Busca Recibo Holerite",
                    "$invalid": false,
                    "settings": {
                        "headers": {
                            "Content-Type": "text/xml",
                            "SOAPAction": "\"lg.com.br/api/v1/ServicoDeReciboDePagamento/ConsultarReciboDePagamentoDetalhado\""
                        },
                        "method": "POST",
                        "body": "{{corpoReciboHolerite}}",
                        "uri": "{{config.LGBaseUrl}}/v1/ServicoDeReciboDePagamento",
                        "responseStatusVariable": "statusBuscaReciboHolerite",
                        "responseBodyVariable": "responseBuscaReciboHolerite"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "51bce9fd-5d05-4258-afab-9ca80576e1b1",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "convertXmlToJsonReciboHolerite",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n    \n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n    \n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n        \n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n    return obj;\n}",
                        "inputVariables": [
                            "responseBuscaReciboHolerite"
                        ],
                        "outputVariable": "convertXmlToJsonReciboHolerite"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "continueOnError": true
                },
                {
                    "$id": "4395b708-3c4e-4594-91a7-b630cfeedd41",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "recebidoHoleriteInfo",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run(obj) {\n\ttry {\n\t\tif (!obj) return false\n\n\t\tobj = JSON.parse(obj)\n\n\t\tconst corpo = obj[\"s:Envelope\"][\"s:Body\"][\"ConsultarReciboDePagamentoDetalhadoResponse\"][\"ConsultarReciboDePagamentoDetalhadoResult\"]['a:Retorno']\n\n\t\tconst output = {\n\t\t\tdescricao: corpo['a:DadosDoColaborador'] && corpo['a:DadosDoColaborador']['a:CargoEfetivo'] && corpo['a:DadosDoColaborador']['a:CargoEfetivo']['a:Descricao'] ? corpo['a:DadosDoColaborador']['a:CargoEfetivo']['a:Descricao'] : '',\n\t\t\tsalarioBase: corpo['a:SalarioBase'] ? `${corpo['a:SalarioBase']}` : '',\n\t\t\ttotalDesconto: corpo['a:TotalDesconto'] ? `${corpo['a:TotalDesconto']}` : '',\n\t\t\ttotalLiquido: corpo['a:TotalLiquido'] ? `${corpo['a:TotalLiquido']}` : '',\n\t\t\ttotalProvento: corpo['a:TotalProvento'] ? `${corpo['a:TotalProvento']}` : '',\n\t\t}\n\n\t\treturn output;\n\t} catch(e) {\n\t\treturn false\n\t}\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [recebidoHoleriteInfo] \"+String(err);}}",
                        "inputVariables": [
                            "convertXmlToJsonReciboHolerite"
                        ],
                        "outputVariable": "recebidoHoleriteInfo",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "convertXmlToJsonReciboHolerite"
                        }
                    ],
                    "continueOnError": true
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "ca7529a0-43a2-4668-b8ed-95e0133432ac",
            "root": false,
            "$title": "[API] Informa√ß√µes holerite",
            "$position": {
                "top": "2465px",
                "left": "1511px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "24b1aca0-2afb-4551-ad25-166845ae6d24": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "179d3584-8645-4d3a-bf12-90288cdee457",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "3fe5d760-3084-4777-8e02-5e8db7c41255",
                    "typeOfStateId": "state",
                    "$connId": "con_218",
                    "$id": "252d8617-b290-4fa6-8b81-f4dfe10ced79",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "948102c0-60d4-4348-acee-620ee2ed916b",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET_V2 'jsonCalendarioPagamentos'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(holeriteEscolha) {\n    try {\n        const { id: escolhaId } = JSON.parse(holeriteEscolha);\n        const monthList = [];\n        let year = new Date().getFullYear();\n        const now = new Date();\n        const MIN_YEAR = now.getFullYear() - 1;\n        const DIFF_DAYS_PAYMENT = 2;\n\ndo {\n    const body = buildBodyRequest(year, escolhaId);\n    const response = await requestLG(body);\n    const responseFormatted = XMLConvert(response.body);\n\n    if (!responseFormatted) {\n        year--;\n        continue;\n    }\n\n    const dataArray = Array.isArray(responseFormatted) ? responseFormatted : [responseFormatted];\n\n    for (const item of dataArray) {\n        const dataPagamento = item[\"a:DataDoPagamento\"];\n        if (dataPagamento) {\n            const paymentDate = new Date(dataPagamento);\n            const diffDays = (paymentDate - now) / (1000 * 60 * 60 * 24);\n            if (diffDays <= DIFF_DAYS_PAYMENT) {\n                monthList.push(item);\n            }\n        }\n    }\n\n    year--;\n} while (monthList.length < 3 && year >= MIN_YEAR);\n\nmonthList.sort((a, b) => new Date(a[\"a:DataDoPagamento\"]) - new Date(b[\"a:DataDoPagamento\"]));\n\nreturn monthList.slice(-3);\n} catch (error) {\n    return error.message;\n}\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v1/ServicoDeDataDePagamento`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v1/ServicoDeDataDePagamento/ConsultarListaInformacoesDaDataDePagamento`\n    }\n    const BODY = body;\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n        // const responseJson = await response.jsonAsync();\n\n        return response;\n        // return responseJson;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction buildBodyRequest(anoValidacao, escolhaId) {\n    try {\n        const codigoFolhaPagamento = escolhaId;\n\n        return `<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:dto=\"lg.com.br/svc/dto\" xmlns:v1=\"lg.com.br/api/v1\" xmlns:v11=\"lg.com.br/api/dto/v1\">\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n   <soapenv:Body>\n    <v1:ConsultarListaInformacoesDaDataDePagamento>\n      <v1:filtro>\n        <v11:Ano>${anoValidacao}</v11:Ano>\n        <v11:Empresa>\n          <v11:Codigo>{{contact.extras.empresaId}}</v11:Codigo>\n        </v11:Empresa>\n        <v11:Folha>\n          <v11:Codigo>${codigoFolhaPagamento}</v11:Codigo>\n        </v11:Folha>\n        <v11:TipoConceito>2</v11:TipoConceito>\n      </v1:filtro>\n    </v1:ConsultarListaInformacoesDaDataDePagamento>\n  </soapenv:Body>\n</soapenv:Envelope>`;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    try {\n        let obj = {};\n        let tagStack = [];\n        let currentNode = obj;\n\n        // Regex patterns for XML parsing\n        const tagPattern = /<([^>]+)>/g;\n        let match;\n        let lastIndex = 0;\n\n        while ((match = tagPattern.exec(xml)) !== null) {\n            const tagContent = match[1];\n            const isEndTag = tagContent[0] === '/';\n\n            const textContent = xml.substring(lastIndex, match.index).trim();\n            if (textContent && tagStack.length > 0) {\n                const parentNode = tagStack[tagStack.length - 1];\n                if (!parentNode[\"_text\"]) {\n                    parentNode[\"_text\"] = textContent;\n                } else if (typeof parentNode[\"_text\"] === \"string\") {\n                    parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n                } else {\n                    parentNode[\"_text\"].push(textContent);\n                }\n            }\n\n            lastIndex = match.index + match[0].length;\n\n            if (isEndTag) {\n                tagStack.pop();\n                currentNode = tagStack[tagStack.length - 1] || obj;\n            } else {\n                const tagParts = tagContent.split(' ');\n                const tagName = tagParts[0];\n                const newNode = {};\n\n                if (currentNode[tagName] === undefined) {\n                    currentNode[tagName] = newNode;\n                } else if (Array.isArray(currentNode[tagName])) {\n                    currentNode[tagName].push(newNode);\n                } else {\n                    currentNode[tagName] = [currentNode[tagName], newNode];\n                }\n\n                if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                    tagStack.push(newNode);\n                    currentNode = newNode;\n                }\n            }\n        }\n\n        // Clean up _text keys\n        function cleanUp(obj) {\n            for (let key in obj) {\n                if (obj[key] && typeof obj[key] === \"object\") {\n                    if (obj[key]._text) {\n                        if (Object.keys(obj[key]).length === 1) {\n                            obj[key] = obj[key]._text;\n                        } else {\n                            obj[key].textValue = obj[key]._text;\n                            delete obj[key]._text;\n                        }\n                    } else if (Object.values(obj[key]).length === 0) {\n                        delete obj[key];\n                    }\n                    cleanUp(obj[key]);\n                }\n            }\n        }\n\n        cleanUp(obj);\n\n        return obj['s:Envelope']['s:Body'].ConsultarListaInformacoesDaDataDePagamentoResponse.ConsultarListaInformacoesDaDataDePagamentoResult['a:Retorno']['a:DataDePagamento']\n    } catch (error) {\n        return false\n    }\n}",
                        "inputVariables": [
                            "menuHoleriteEscolha"
                        ],
                        "outputVariable": "jsonCalendarioPagamentos",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "4cea0271-f763-434c-91ca-5493e2360e12",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'listMonths'",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run(response) {\n    try {\n        response = JSON.parse(response);\n\n        return response.map(item => {\n            const [year, month, day] = item[\"a:Referencia\"].split('T')[0].split('-');\n\n            return {\n                id: `${month}/${year}`,\n                title: `${month}/${year}`,\n                description: '',\n                active: true\n            }\n    })\n    } catch (error) {\n        return error.message;\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [SET 'listMonths'] \"+String(err);}}",
                        "inputVariables": [
                            "jsonCalendarioPagamentos"
                        ],
                        "outputVariable": "listMonths",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "51d96b74-48d1-49bc-8075-d1a4cd2e81ce",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'isListValid'",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run(list) {\n\ttry {\n\t\treturn JSON.parse(list).length > 0;\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [SET 'isListValid'] \"+String(err);}}",
                        "inputVariables": [
                            "listMonths"
                        ],
                        "outputVariable": "isListValid",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "24b1aca0-2afb-4551-ad25-166845ae6d24",
            "root": false,
            "$title": "[API] Meses de pagamento",
            "$position": {
                "top": "2119px",
                "left": "1511px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "4bedd28d-c3f9-4b9b-ba98-ffd84e0e5718": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "131e408a-2462-4b2d-a972-f4f205cb136e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "72cfd94e-b775-428c-9a2d-d1df0fdb83a5",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'algoMaisTransbordo' to true",
                    "$invalid": false,
                    "settings": {
                        "variable": "algoMaisTransbordo",
                        "value": "true"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "32e5f224-1cf3-4733-a916-dfe04b984054",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "4bedd28d-c3f9-4b9b-ba98-ffd84e0e5718",
            "root": false,
            "$title": "[GO TO] Algo mais",
            "$position": {
                "top": "2746px",
                "left": "1511px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "6ffaf47b-15de-44e7-841e-6f086a57be38": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuInformeRendimentosBuild@type}}",
                            "rawContent": "{{menuInformeRendimentosBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "9bb74dec-a595-4f1f-8e6e-4505ff7f2afe",
                    "typeOfStateId": "state",
                    "$connId": "con_223",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Solicitar informe"
                            ],
                            "variable": "menuInformeRendimentosEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "a763c0c0-6420-4e98-a351-072e656db3de",
                    "typeOfStateId": "state",
                    "$connId": "con_228",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Data disponibiliza√ß√£o",
                                "Data disponibilidade"
                            ],
                            "variable": "menuInformeRendimentosEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "100f34ad-4c27-4274-bbf2-c3f18d26ffb8",
                    "typeOfStateId": "state",
                    "$connId": "con_233",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Valores do IRRF"
                            ],
                            "variable": "menuInformeRendimentosEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "e31767e6-e370-43e0-b094-ca16715a3655",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - Checkpoint",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-informe-rendimentos\",\n    checkpoint: true,\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuInformeRendimentosOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Solicitar informe\",\n\t\ttitle: \"Solicitar informe\", // At√© 24 caracteres\n\t\ttitleShort: `Solicitar informe`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Data disponibilidade\",\n\t\ttitle: \"Data disponibilidade\", // At√© 24 caracteres\n\t\ttitleShort: `Data disponibilidade`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Valores do IRRF\",\n\t\ttitle: \"Valores do IRRF\", // At√© 24 caracteres\n\t\ttitleShort: `Valores do IRRF`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: false,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuInformeRendimentosOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuInformeRendimentosBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Selecione a op√ß√£o desejada abaixo. üëá`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuInformeRendimentosOptions"
                        ],
                        "outputVariable": "menuInformeRendimentosBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuInformeRendimentosEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuInformeRendimentosOptions"
                        ],
                        "outputVariable": "menuInformeRendimentosEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuInformeRendimentosEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuInformeRendimentosEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuInformeRendimentosEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuInformeRendimentosEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuInformeRendimentosEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "6ffaf47b-15de-44e7-841e-6f086a57be38",
            "root": false,
            "$title": "[Menu] Informe de rendimentos",
            "$position": {
                "top": "1447px",
                "left": "2218px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "9bb74dec-a595-4f1f-8e6e-4505ff7f2afe": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "4387c31f-874a-4b7f-84e3-074438fd7be5",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "b7285f90-9cd0-4444-861f-ae4066975833",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "9bb74dec-a595-4f1f-8e6e-4505ff7f2afe",
            "root": false,
            "$title": "[GO TO] Redirect Ath",
            "$position": {
                "top": "1603px",
                "left": "1996px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "a763c0c0-6420-4e98-a351-072e656db3de": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "fea046d0-8569-4370-bfa0-08c78524fe83",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "11487f38-92a4-4bc7-a75e-d6749d8fd2b5",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "11487f38-92a4-4bc7-a75e-d6749d8fd2b5",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "f6b4b4c1-40fb-48e3-b09a-e55ab7a10960",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "95a6ddef-2e12-4f1d-882c-2506fe48f609",
                            "type": "text/plain",
                            "content": "{{messageInformeRendimentos}}",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "95a6ddef-2e12-4f1d-882c-2506fe48f609",
                                "type": "text/plain",
                                "content": "{{messageInformeRendimentos}}"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "cf629d71-3180-46dc-9739-a6189e75a6fb",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "d29d6d20-5586-467f-aba2-88b136b72167",
                    "typeOfStateId": "state",
                    "$connId": "con_238",
                    "$id": "0973f624-789f-423f-8b08-5b422a8bdad3",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "94c0e5da-bbf9-41f6-989b-5a1eb51bcd56",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'messageInformeRendimentos'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  const year = new Date().getFullYear();\n  const lastDay = new Date(year, 2, 0);\n  const now = new Date();\n\n  const verb = lastDay > now ? \"ser√°\" : \"come√ßou\";\n\n  return `A data para libera√ß√£o do informe ${verb} a partir do dia ${dateFormatted(lastDay)}.`;\n}\n\nfunction dateFormatted(date) {\n    \n    let dateGenerated;\n\n    if(date) {\n        dateGenerated = new Date(date).toISOString();\n    } else {\n        dateGenerated = new Date().toISOString();\n    }\n\n    const [year, month, day] = dateGenerated.slice(0,10).split(\"-\");\n\n    return `${day}/${month}/${year}`;\n}",
                        "inputVariables": [],
                        "outputVariable": "messageInformeRendimentos",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "a763c0c0-6420-4e98-a351-072e656db3de",
            "root": false,
            "$title": "Data disponibiliza√ß√£o Inf Rendimentos",
            "$position": {
                "top": "1605px",
                "left": "2218px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "d29d6d20-5586-467f-aba2-88b136b72167": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "131e408a-2462-4b2d-a972-f4f205cb136e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "72cfd94e-b775-428c-9a2d-d1df0fdb83a5",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'algoMaisTransbordo' to true",
                    "$invalid": false,
                    "settings": {
                        "variable": "algoMaisTransbordo",
                        "value": "true"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "32e5f224-1cf3-4733-a916-dfe04b984054",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "d29d6d20-5586-467f-aba2-88b136b72167",
            "root": false,
            "$title": "[GO TO] Algo mais",
            "$position": {
                "top": "1784px",
                "left": "2443px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "100f34ad-4c27-4274-bbf2-c3f18d26ffb8": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "6ccc8b1a-16ee-449f-967b-85bb76072672",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "21d73ca8-b6ab-4d0a-b1ba-8d0f7ebc2d3f",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "21d73ca8-b6ab-4d0a-b1ba-8d0f7ebc2d3f",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7bfeef30-caa9-4be0-9114-41848735d5bf",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "bb4183a6-5621-4e0d-862c-54bfe530c428",
                            "type": "text/plain",
                            "content": "VALORES DO IRRF",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "bb4183a6-5621-4e0d-862c-54bfe530c428",
                                "type": "text/plain",
                                "content": "VALORES DO IRRF"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "e9c827a1-ae16-4a17-bf9e-00823c70bfce",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "d29d6d20-5586-467f-aba2-88b136b72167",
                    "typeOfStateId": "state",
                    "$connId": "con_243",
                    "$id": "b0f3eb6f-6b51-4a92-9d68-4ad185d32b32",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "100f34ad-4c27-4274-bbf2-c3f18d26ffb8",
            "root": false,
            "$title": "Valores do IRRF",
            "$position": {
                "top": "1609px",
                "left": "2443px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "1a99da74-3723-4464-8be4-444c3bc535b8": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuRescisaoBuild@type}}",
                            "rawContent": "{{menuRescisaoBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "6611aecf-96e6-4cdf-807f-e42de6f92369",
                    "typeOfStateId": "state",
                    "$connId": "con_248",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Data do pagamento"
                            ],
                            "variable": "menuRescisaoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "9bcc3f9c-f6bd-4681-85ca-c8a75f4a5008",
                    "typeOfStateId": "state",
                    "$connId": "con_253",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Homologa√ß√£o"
                            ],
                            "variable": "menuRescisaoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "8ebdb738-130e-4e0e-896f-a09eae7bf162",
                    "typeOfStateId": "state",
                    "$connId": "con_258",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Exame demissional"
                            ],
                            "variable": "menuRescisaoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "a260da85-b3f0-41ae-a7f2-9cefece6244b",
                    "typeOfStateId": "state",
                    "$connId": "con_263",
                    "$id": "c37fa233-01f1-4951-887f-bfba22ace858",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Devolver equipamentos"
                            ],
                            "variable": "menuRescisaoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "ca14f1e2-85d0-4baa-bd19-75d5c44cc9ac",
                    "typeOfStateId": "state",
                    "$connId": "con_268",
                    "$id": "e33f91ee-3e8f-4191-a89f-e283042f78a5",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "D√∫vidas minha sociedade"
                            ],
                            "variable": "menuRescisaoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "34c67a2d-d606-4799-9c46-82cfc2415fbe",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - Checkpoint",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-duvidas-rescisao\",\n    checkpoint: true,\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuRescisaoOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Data do pagamento\",\n\t\ttitle: \"Data do pagamento\", // At√© 24 caracteres\n\t\ttitleShort: `Data do pagamento`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Homologa√ß√£o\",\n\t\ttitle: \"Homologa√ß√£o\", // At√© 24 caracteres\n\t\ttitleShort: `Homologa√ß√£o`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Exame demissional\",\n\t\ttitle: \"Exame demissional\", // At√© 24 caracteres\n\t\ttitleShort: `Exame demissional`, // At√© 20 caracteres\n\t\tdescription: \"Agendamento exame demissional\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Devolver equipamentos\",\n\t\ttitle: \"Devolver equipamentos\", // At√© 24 caracteres\n\t\ttitleShort: `Devolver equipamentos`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"D√∫vidas minha sociedade\",\n\t\ttitle: \"D√∫vidas minha sociedade\", // At√© 24 caracteres\n\t\ttitleShort: `D√∫vidas minha sociedade`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuRescisaoOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuRescisaoBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Toque em \"Ver op√ß√µes\" e selecione sua d√∫vida sobre rescis√£o. üòâ`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuRescisaoOptions"
                        ],
                        "outputVariable": "menuRescisaoBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuRescisaoEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuRescisaoOptions"
                        ],
                        "outputVariable": "menuRescisaoEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuRescisaoEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuRescisaoEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuRescisaoEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuRescisaoEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuRescisaoEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "1a99da74-3723-4464-8be4-444c3bc535b8",
            "root": false,
            "$title": "[Menu] Rescis√£o",
            "$position": {
                "top": "1411px",
                "left": "3362px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "8ab2ba9a-94ca-459c-814b-67006e9fbe4b": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "fea046d0-8569-4370-bfa0-08c78524fe83",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "11487f38-92a4-4bc7-a75e-d6749d8fd2b5",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "11487f38-92a4-4bc7-a75e-d6749d8fd2b5",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "f6b4b4c1-40fb-48e3-b09a-e55ab7a10960",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "95a6ddef-2e12-4f1d-882c-2506fe48f609",
                            "type": "text/plain",
                            "content": "{{messageDataPagamentoRescisao}}",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "95a6ddef-2e12-4f1d-882c-2506fe48f609",
                                "type": "text/plain",
                                "content": "{{messageDataPagamentoRescisao}}"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "cf629d71-3180-46dc-9739-a6189e75a6fb",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "57416802-b614-48a8-89b0-47f89730f146",
                    "typeOfStateId": "state",
                    "$connId": "con_273",
                    "$id": "0973f624-789f-423f-8b08-5b422a8bdad3",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "94c0e5da-bbf9-41f6-989b-5a1eb51bcd56",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'messageDataPagamentoRescisao'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(informacoesRescisao) {\n\ttry {\n\n\t\tconst datePayDay =JSON.parse(informacoesRescisao)[\"a:DataDoPagamento\"];\n\n\t\tconst dataPagamentoFormatada = dateFormatted(datePayDay);\n\n\t\treturn `O pagamento da sua rescis√£o est√° programado para o dia ${dataPagamentoFormatada}.`;\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}\n\nfunction dateFormatted(date) {\n    \n    let dateGenerated;\n\n    if(date) {\n        dateGenerated = new Date(date).toISOString();\n    } else {\n        dateGenerated = new Date().toISOString();\n    }\n\n    const [year, month, day] = dateGenerated.slice(0,10).split(\"-\");\n\n    return `${day}/${month}/${year}`;\n}",
                        "inputVariables": [
                            "informacoesRescisao"
                        ],
                        "outputVariable": "messageDataPagamentoRescisao",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "8ab2ba9a-94ca-459c-814b-67006e9fbe4b",
            "root": false,
            "$title": "Data pagamento rescis√£o",
            "$position": {
                "top": "1734px",
                "left": "2909px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "57416802-b614-48a8-89b0-47f89730f146": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "131e408a-2462-4b2d-a972-f4f205cb136e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "72cfd94e-b775-428c-9a2d-d1df0fdb83a5",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'algoMaisTransbordo' to true",
                    "$invalid": false,
                    "settings": {
                        "variable": "algoMaisTransbordo",
                        "value": "true"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "32e5f224-1cf3-4733-a916-dfe04b984054",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "57416802-b614-48a8-89b0-47f89730f146",
            "root": false,
            "$title": "[GO TO] Algo mais",
            "$position": {
                "top": "1809px",
                "left": "3185px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "9bcc3f9c-f6bd-4681-85ca-c8a75f4a5008": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03026f52-40ca-4224-af30-970e5312b294",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "df9a1224-a123-4781-baf5-686386e01e6e",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "df9a1224-a123-4781-baf5-686386e01e6e",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "fa0de9ea-e5cf-4e55-94b5-b9feb8e36634",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{mediaFile@type}}",
                            "rawContent": "{{mediaFile@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "3449d6cb-6529-4a75-b67d-e35bc61706bf",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "57416802-b614-48a8-89b0-47f89730f146",
                    "typeOfStateId": "state",
                    "$connId": "con_278",
                    "$id": "e01275b3-4529-4c80-aed5-1248b85c379e",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "4b63e6ac-57a2-4049-98a5-089ea9226620",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'mediaFile'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n    try {\n        const fileName = \"Homologa√ß√£o Medei\";\n\t\tconst fileBodyText = \"Aqui est√° tudo que voc√™ precisa saber sobre a Homologa√ß√£o Medei\"\n        const fileUrl = \"https://assets.dawntech.dev/content/neon/passo_a_passo_homologacao_medei.pdf\";\n\n        return {\n            \"type\": \"application/vnd.lime.media-link+json\",\n            \"content\": {\n                \"title\": fileName,\n\t\t\t\t\"text\": fileBodyText,\n                \"uri\": fileUrl,\n                \"type\": \"application/pdf\"\n            }\n        }\n    } catch (error) {\n        return error.message;\n    }\n}",
                        "inputVariables": [],
                        "outputVariable": "mediaFile",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "9bcc3f9c-f6bd-4681-85ca-c8a75f4a5008",
            "root": false,
            "$title": "PDF homologa√ß√£o",
            "$position": {
                "top": "1595px",
                "left": "3185px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "8ebdb738-130e-4e0e-896f-a09eae7bf162": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03026f52-40ca-4224-af30-970e5312b294",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "df9a1224-a123-4781-baf5-686386e01e6e",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "df9a1224-a123-4781-baf5-686386e01e6e",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "fa0de9ea-e5cf-4e55-94b5-b9feb8e36634",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "application/json",
                            "rawContent": "{{scheduleLinkButton}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "3449d6cb-6529-4a75-b67d-e35bc61706bf",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b9f7a626-6ffa-48c7-a412-0f2900b33dbb",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "57416802-b614-48a8-89b0-47f89730f146",
                    "typeOfStateId": "state",
                    "$connId": "con_283",
                    "$id": "e01275b3-4529-4c80-aed5-1248b85c379e",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "f133ee9c-b552-402d-9306-4e2b71f3d247",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'scheduleLinkButton'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n    try {\n        return {\n            \"type\": \"interactive\",\n            \"interactive\": {\n              \"type\": \"cta_url\",\n              \"body\": {\n                \"text\": \"Para realizar o agendamento do seu exame, basta clicar em *‚ÄúAgendar exame Sal√∫‚Äù*, e ser√° aberta uma aba no seu navegador. ü•∞\"\n              },\n              \"action\": {\n                \"name\": \"cta_url\",\n                \"parameters\": {\n                  \"display_text\": \"Agendar exame Sal√∫\",\n                  \"url\": \"https://portalcolaborador.salu.com.vc/login?orgGovId=20855875000182\"\n                }\n              }\n            }\n          }\n    } catch (error) {\n        return error.message;\n    }\n}",
                        "inputVariables": [],
                        "outputVariable": "scheduleLinkButton",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "8ebdb738-130e-4e0e-896f-a09eae7bf162",
            "root": false,
            "$title": "Link agendamento demissional",
            "$position": {
                "top": "1591px",
                "left": "3453.5px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "a260da85-b3f0-41ae-a7f2-9cefece6244b": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuConfirmaResidenciaBuild@type}}",
                            "rawContent": "{{menuConfirmaResidenciaBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#386e6b9b-e805-4cea-88c7-07288becfc65",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "7a4a708f-9575-4960-bc9e-99a017c6006a",
                    "typeOfStateId": "state",
                    "$connId": "con_288",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Sim"
                            ],
                            "variable": "menuConfirmaResidenciaEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "1b223ce3-a37b-45f1-a0a6-e70733feca65",
                    "typeOfStateId": "state",
                    "$connId": "con_293",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "N√£o"
                            ],
                            "variable": "menuConfirmaResidenciaEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuConfirmaResidenciaOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Sim\",\n\t\ttitle: \"Sim\", // At√© 24 caracteres\n\t\ttitleShort: `Sim`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"N√£o\",\n\t\ttitle: \"N√£o\", // At√© 24 caracteres\n\t\ttitleShort: `N√£o`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuConfirmaResidenciaOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuConfirmaResidenciaBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Voc√™ reside na regi√£o metropolitana?`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuConfirmaResidenciaOptions"
                        ],
                        "outputVariable": "menuConfirmaResidenciaBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "b3c9a706-67e0-46e6-acd1-f9ad06078627",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Time = 'Facilities'",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "Time": "Facilities"
                        }
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuConfirmaResidenciaEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuConfirmaResidenciaOptions"
                        ],
                        "outputVariable": "menuConfirmaResidenciaEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuConfirmaResidenciaEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuConfirmaResidenciaEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuConfirmaResidenciaEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuConfirmaResidenciaEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuConfirmaResidenciaEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                },
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                }
            ],
            "id": "a260da85-b3f0-41ae-a7f2-9cefece6244b",
            "root": false,
            "$title": "[Menu] Resid√™ncia devolu√ß√£o equip.",
            "$position": {
                "top": "1505.25px",
                "left": "3765px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "1b223ce3-a37b-45f1-a0a6-e70733feca65": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuRegiaoMetropolitanaBuild@type}}",
                            "rawContent": "{{menuRegiaoMetropolitanaBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#386e6b9b-e805-4cea-88c7-07288becfc65",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "1baad63f-9452-47eb-bef7-ec4854395364",
                    "typeOfStateId": "state",
                    "$connId": "con_298",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Falar com atendente"
                            ],
                            "variable": "menuRegiaoMetropolitanaEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuRegiaoMetropolitanaOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Falar com atendente\",\n\t\ttitle: \"Falar com atendente\", // At√© 24 caracteres\n\t\ttitleShort: `Falar com atendente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Voltar ao menu anterior\",\n\t\ttitle: \"Voltar ao menu anterior\", // At√© 24 caracteres\n\t\ttitleShort: `Voltar menu anterior`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Encerrar atendimento\",\n\t\ttitle: \"Encerrar atendimento\", // At√© 24 caracteres\n\t\ttitleShort: `Encerrar atendimento`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuRegiaoMetropolitanaOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuRegiaoMetropolitanaBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `O time de facilities est√° fazendo a cota√ß√£o e dentro de 48h ir√° retirar seu equipamento.\n\nCaso n√£o esteja dispon√≠vel, entre em contato com o atendimento, para agendar a retirada. üòâ`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuRegiaoMetropolitanaOptions"
                        ],
                        "outputVariable": "menuRegiaoMetropolitanaBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuRegiaoMetropolitanaEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuRegiaoMetropolitanaOptions"
                        ],
                        "outputVariable": "menuRegiaoMetropolitanaEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuRegiaoMetropolitanaEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuRegiaoMetropolitanaEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuRegiaoMetropolitanaEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuRegiaoMetropolitanaEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuRegiaoMetropolitanaEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "1b223ce3-a37b-45f1-a0a6-e70733feca65",
            "root": false,
            "$title": "[Menu] Regi√£o metropolitana",
            "$position": {
                "top": "1813px",
                "left": "3794px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "7a4a708f-9575-4960-bc9e-99a017c6006a": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03026f52-40ca-4224-af30-970e5312b294",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "df9a1224-a123-4781-baf5-686386e01e6e",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "df9a1224-a123-4781-baf5-686386e01e6e",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "fa0de9ea-e5cf-4e55-94b5-b9feb8e36634",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "application/json",
                            "rawContent": "{{scheduleLinkButton}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "3449d6cb-6529-4a75-b67d-e35bc61706bf",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#386e6b9b-e805-4cea-88c7-07288becfc65",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "57416802-b614-48a8-89b0-47f89730f146",
                    "typeOfStateId": "state",
                    "$connId": "con_303",
                    "$id": "e01275b3-4529-4c80-aed5-1248b85c379e",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "f133ee9c-b552-402d-9306-4e2b71f3d247",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'scheduleLinkButton'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n    try {\n        return {\n            \"type\": \"interactive\",\n            \"interactive\": {\n              \"type\": \"cta_url\",\n              \"body\": {\n                \"text\": \"Clique em *‚ÄúAgendar devolu√ß√£o‚Äù*, e selecione a data para devolver seu equipamento.\"\n              },\n              \"action\": {\n                \"name\": \"cta_url\",\n                \"parameters\": {\n                  \"display_text\": \"Agendar devolu√ß√£o\",\n                  \"url\": \"https://calendar.app.google/dx2p1NTnRmHvyYaS8\"\n                }\n              }\n            }\n          }\n    } catch (error) {\n        return error.message;\n    }\n}",
                        "inputVariables": [],
                        "outputVariable": "scheduleLinkButton",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "7a4a708f-9575-4960-bc9e-99a017c6006a",
            "root": false,
            "$title": "Link agendar devolu√ß√£o",
            "$position": {
                "top": "1798px",
                "left": "3543px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "1baad63f-9452-47eb-bef7-ec4854395364": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "1306d285-6ad3-42ce-bf41-b22fbab3cee1",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#386e6b9b-e805-4cea-88c7-07288becfc65",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "b7285f90-9cd0-4444-861f-ae4066975833",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "1baad63f-9452-47eb-bef7-ec4854395364",
            "root": false,
            "$title": "[GO TO] Redirect Ath",
            "$position": {
                "top": "2007px",
                "left": "3794px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "83a2b248-307a-42b3-8eac-350af7ab2c4a": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "9a6b57f7-c37f-40f6-99e4-59d7a3a6a339",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#a1bbaeaf-0f2f-4449-b263-5bcb95a32e7e",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "f3efaf1b-d82a-46c6-a7e5-2ce99539b3b3",
                    "typeOfStateId": "state",
                    "$connId": "con_308",
                    "$id": "69cd1f76-1517-458d-aab1-544df2628bce",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "true"
                            ],
                            "variable": "boolSociedade"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "714f0ce2-d989-4072-83ce-29c86411e33f",
                    "typeOfStateId": "state",
                    "$connId": "con_313",
                    "$id": "f53cd9e2-ed58-41e3-85ff-6550262b84b7",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "false"
                            ],
                            "variable": "boolSociedade"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "83a2b248-307a-42b3-8eac-350af7ab2c4a",
            "root": false,
            "$title": "[Valida] Sociedade",
            "$position": {
                "top": "1784px",
                "left": "4203px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "714f0ce2-d989-4072-83ce-29c86411e33f": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuSociedadeNaoEncontradaBuild@type}}",
                            "rawContent": "{{menuSociedadeNaoEncontradaBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#3a8b7215-3388-4abe-9637-91be9f90c5a4",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "1baad63f-9452-47eb-bef7-ec4854395364",
                    "typeOfStateId": "state",
                    "$connId": "con_318",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Falar com atendente"
                            ],
                            "variable": "menuSociedadeNaoEncontradaEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuSociedadeNaoEncontradaOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Falar com atendente\",\n\t\ttitle: \"Falar com atendente\", // At√© 24 caracteres\n\t\ttitleShort: `Falar com atendente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Voltar\",\n\t\ttitle: \"Voltar\", // At√© 24 caracteres\n\t\ttitleShort: `Voltar`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Encerrar atendimento\",\n\t\ttitle: \"Encerrar atendimento\", // At√© 24 caracteres\n\t\ttitleShort: `Encerrar atendimento`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuSociedadeNaoEncontradaOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuSociedadeNaoEncontradaBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `N√£o encontrei dados sobre sua sociedade Neon, mas voc√™ pode falar com um especialista, caso precise tirar d√∫vidas. üëá`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuSociedadeNaoEncontradaOptions"
                        ],
                        "outputVariable": "menuSociedadeNaoEncontradaBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuSociedadeNaoEncontradaEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuSociedadeNaoEncontradaOptions"
                        ],
                        "outputVariable": "menuSociedadeNaoEncontradaEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuSociedadeNaoEncontradaEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuSociedadeNaoEncontradaEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuSociedadeNaoEncontradaEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuSociedadeNaoEncontradaEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuSociedadeNaoEncontradaEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "714f0ce2-d989-4072-83ce-29c86411e33f",
            "root": false,
            "$title": "[Menu] Sociedade n√£o encontrada",
            "$position": {
                "top": "1996px",
                "left": "4066px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "f3efaf1b-d82a-46c6-a7e5-2ce99539b3b3": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "018b2ae2-0ae6-4f9d-be12-316cf49349f7",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "e52f7ad5-1781-460c-8c32-d72f10fcf23f",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "e52f7ad5-1781-460c-8c32-d72f10fcf23f",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "62ab3243-44eb-48af-87d5-d22e79415c62",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{mediaFile@type}}",
                            "rawContent": "{{mediaFile@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "23adc522-b203-4ba9-8715-90443d3b1982",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#3a8b7215-3388-4abe-9637-91be9f90c5a4",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "8196b0f7-b280-4304-b4cd-2dbb7311d41d",
                    "typeOfStateId": "state",
                    "$connId": "con_323",
                    "$id": "0d950ca1-b483-41e1-8374-530961f2ec98",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "4ec8780f-e82a-4705-bea9-40680fec25b8",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'mediaFile'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n    try {\n        const fileUrl = \"https://assets.dawntech.dev/content/neon/faq_ilp-offboarding.pdf\";\n        const fileName = \"Offboarding de s√≥cios\";\n\t\tconst fileBodyText = \"Aqui est√° tudinho que voc√™ precisa saber sobre a sua sociedade. ü´°\"\n\n        return {\n            \"type\": \"application/vnd.lime.media-link+json\",\n            \"content\": {\n                \"title\": fileName,\n\t\t\t\t\"text\": fileBodyText,\n                \"uri\": fileUrl,\n                \"type\": \"application/pdf\"\n            }\n        }\n    } catch (error) {\n        return error.message;\n    }\n}",
                        "inputVariables": [],
                        "outputVariable": "mediaFile",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "f3efaf1b-d82a-46c6-a7e5-2ce99539b3b3",
            "root": false,
            "$title": "Informa√ß√µes de sociedade",
            "$position": {
                "top": "1995px",
                "left": "4339px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "8196b0f7-b280-4304-b4cd-2dbb7311d41d": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "131e408a-2462-4b2d-a972-f4f205cb136e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#3a8b7215-3388-4abe-9637-91be9f90c5a4",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "72cfd94e-b775-428c-9a2d-d1df0fdb83a5",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'algoMaisTransbordo' to false",
                    "$invalid": false,
                    "settings": {
                        "variable": "algoMaisTransbordo",
                        "value": "false"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "32e5f224-1cf3-4733-a916-dfe04b984054",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "8196b0f7-b280-4304-b4cd-2dbb7311d41d",
            "root": false,
            "$title": "[GO TO] Algo mais sem Ath",
            "$position": {
                "top": "2155px",
                "left": "4339px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "15ffd56f-9795-4a35-bfd7-a03ef916d8f9": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "1692792d-c8d3-4d2d-89fb-be7399c7f21e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ab87188e-bbcf-4916-af94-1489480000d7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "15ffd56f-9795-4a35-bfd7-a03ef916d8f9",
            "root": false,
            "$title": "[GO TO] Encerramento",
            "$position": {
                "top": "137px",
                "left": "423px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "360f0a20-9da4-4aff-981c-2e69ab81590c": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuP4pBuild@type}}",
                            "rawContent": "{{menuP4pBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ab87188e-bbcf-4916-af94-1489480000d7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "1bfaf96f-2fc6-4daf-bcf7-74d3e33f7681",
                    "typeOfStateId": "state",
                    "$connId": "con_328",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Elegibilidade"
                            ],
                            "variable": "menuP4pEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "e853bc21-e205-4805-af86-6884c0ac1d02",
                    "typeOfStateId": "state",
                    "$connId": "con_333",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Data de pagamento"
                            ],
                            "variable": "menuP4pEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "1089f29b-39f9-4ec0-b891-4d024e26ce9b",
                    "typeOfStateId": "state",
                    "$connId": "con_338",
                    "$id": "28aa0dd3-4012-42bd-8153-47a0be6a4c47",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Dados banc√°rios"
                            ],
                            "variable": "menuP4pEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "daa18200-8772-4778-bbf9-862a1f7a2959",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - Checkpoint",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-p4p\",\n    checkpoint: true,\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuP4pOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Elegibilidade\",\n\t\ttitle: \"Elegibilidade\", // At√© 24 caracteres\n\t\ttitleShort: `Elegibilidade`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Data de pagamento\",\n\t\ttitle: \"Data de pagamento\", // At√© 24 caracteres\n\t\ttitleShort: `Data de pagamento`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Dados banc√°rios\",\n\t\ttitle: \"Dados banc√°rios\", // At√© 24 caracteres\n\t\ttitleShort: `Dados banc√°rios`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuP4pOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuP4pBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Selecione a op√ß√£o desejada abaixo. üëá`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuP4pOptions"
                        ],
                        "outputVariable": "menuP4pBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuP4pEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuP4pOptions"
                        ],
                        "outputVariable": "menuP4pEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuP4pEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuP4pEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuP4pEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuP4pEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuP4pEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "360f0a20-9da4-4aff-981c-2e69ab81590c",
            "root": false,
            "$title": "[Menu] P4P",
            "$position": {
                "top": "1422px",
                "left": "5041px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "1bfaf96f-2fc6-4daf-bcf7-74d3e33f7681": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "06dca091-cc4a-4789-9736-ffa932e5e02f",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "a3205534-baa3-4be0-9c82-8bb6aac9dcd2",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "a3205534-baa3-4be0-9c82-8bb6aac9dcd2",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "c6d01376-e8d5-4628-9352-5f6a65447a9f",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "ce0d8f3c-aaa7-49aa-a4b0-92208aa36511",
                            "type": "text/plain",
                            "content": "O acordo de elegibilidade ainda n√£o foi finalizado, me d√° mais uns dias para que eu consiga essa informa√ß√£o. üòä",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "ce0d8f3c-aaa7-49aa-a4b0-92208aa36511",
                                "type": "text/plain",
                                "content": "O acordo de elegibilidade ainda n√£o foi finalizado, me d√° mais uns dias para que eu consiga essa informa√ß√£o. üòä"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "27977703-42d4-483d-bd5c-3fbd2419494b",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ab87188e-bbcf-4916-af94-1489480000d7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "634eed54-e949-4a46-887a-19934022b336",
                    "typeOfStateId": "state",
                    "$connId": "con_343",
                    "$id": "a2b58879-4593-48ed-a23e-649bee5b9410",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "1bfaf96f-2fc6-4daf-bcf7-74d3e33f7681",
            "root": false,
            "$title": "FALTANDO Elegibilidade",
            "$position": {
                "top": "1601px",
                "left": "4775px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "293fd567-898b-4821-8047-1c4a7b887834": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "fea046d0-8569-4370-bfa0-08c78524fe83",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "11487f38-92a4-4bc7-a75e-d6749d8fd2b5",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "11487f38-92a4-4bc7-a75e-d6749d8fd2b5",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "f6b4b4c1-40fb-48e3-b09a-e55ab7a10960",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "95a6ddef-2e12-4f1d-882c-2506fe48f609",
                            "type": "text/plain",
                            "content": "{{messageDataPagamentoP4p}}",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "95a6ddef-2e12-4f1d-882c-2506fe48f609",
                                "type": "text/plain",
                                "content": "{{messageDataPagamentoP4p}}"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "cf629d71-3180-46dc-9739-a6189e75a6fb",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ab87188e-bbcf-4916-af94-1489480000d7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "f8baef42-bb3c-40b7-8992-ea3d034bf345",
                    "typeOfStateId": "state",
                    "$connId": "con_348",
                    "$id": "0973f624-789f-423f-8b08-5b422a8bdad3",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "94c0e5da-bbf9-41f6-989b-5a1eb51bcd56",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'messageDataPagamentoP4p'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(calendarioPagamento) {\n\ttry {\n        let message = \"Se voc√™ √© eleg√≠vel, seu pagamento est√° programado para o dia:\\n\";\n        calendarioPagamento = JSON.parse(calendarioPagamento);\n        const datasPagamento = calendarioPagamento.map(item => `- ${dateFormatted(item[\"a:DataDoPagamento\"])}`);\n        \n        if(datasPagamento.length > 1) message = \"Se voc√™ √© eleg√≠vel, seu pagamento P4P est√° programado para os dias:\\n\";\n\n        let arrayMessage = [message];\n        arrayMessage.push(...datasPagamento);\n        \n\t\treturn arrayMessage.join(\"\\n\");\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}\n\nfunction dateFormatted(date) {\n    \n    let dateGenerated;\n\n    if(date) {\n        dateGenerated = new Date(date).toISOString();\n    } else {\n        dateGenerated = new Date().toISOString();\n    }\n\n    const [year, month, day] = dateGenerated.slice(0,10).split(\"-\");\n\n    return `${day}/${month}/${year}`;\n}",
                        "inputVariables": [
                            "jsonCalendarioPagamentos"
                        ],
                        "outputVariable": "messageDataPagamentoP4p",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "293fd567-898b-4821-8047-1c4a7b887834",
            "root": false,
            "$title": "Data pagamento P4P",
            "$position": {
                "top": "1928px",
                "left": "5032px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "634eed54-e949-4a46-887a-19934022b336": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "131e408a-2462-4b2d-a972-f4f205cb136e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#ab87188e-bbcf-4916-af94-1489480000d7",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "72cfd94e-b775-428c-9a2d-d1df0fdb83a5",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'algoMaisTransbordo' to true",
                    "$invalid": false,
                    "settings": {
                        "variable": "algoMaisTransbordo",
                        "value": "true"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "32e5f224-1cf3-4733-a916-dfe04b984054",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "634eed54-e949-4a46-887a-19934022b336",
            "root": false,
            "$title": "[GO TO] Algo mais",
            "$position": {
                "top": "1751px",
                "left": "4775px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "4660919f-346e-453c-9572-e2af43806584": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "a987cb3c-ca98-4cdf-b93e-d21dc16790b0",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "b815c579-3d8c-4410-a3a6-cb3e871d5622",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "b815c579-3d8c-4410-a3a6-cb3e871d5622",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "bd525ae5-1f80-47e6-b4fd-11a304dd18c4",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "3cf4d6e7-e4f9-4f31-8425-3167e44f481f",
                            "type": "text/plain",
                            "content": "Encontrei seu cadastro, mas infelizmente n√£o consegui validar a sua situa√ß√£o.",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "3cf4d6e7-e4f9-4f31-8425-3167e44f481f",
                                "type": "text/plain",
                                "content": "Encontrei seu cadastro, mas infelizmente n√£o consegui validar a sua situa√ß√£o."
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "f82b23ba-b6de-488c-82a9-071e02d7f723",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#86196ba6-28da-49aa-b8c1-da0904f890c6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "e8f864e5-8ab1-4b4d-a6a4-4b228cfa6f3a",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "user-registration-unavailable",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "user-registration-unavailable",
                        "action": "{{contact.taxDocument}} | {{contact.identity}} | {{colaboradorInfo@dadosGerais.matricula}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "4660919f-346e-453c-9572-e2af43806584",
            "root": false,
            "$title": "[Msg] Situa√ß√£o inv√°lida",
            "$position": {
                "top": "266px",
                "left": "1929px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "2ef3d22f-1971-4836-8489-5baa0e77770d": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "d9d6814e-38a1-438c-95a2-a3caa639c92b",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "b073a99f-911d-4d2e-bd33-4559eb4025d3",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "b073a99f-911d-4d2e-bd33-4559eb4025d3",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "23c3dd69-3c9b-4ce9-962a-ef2319c51796",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "5fba9763-42f4-4538-a465-6c167f1b8d5a",
                            "type": "text/plain",
                            "content": "Encontrei o seu cadastro, mas o n√∫mero de telefone usado no contato √© diferente do que consta em nosso sistema.\n\nMe manda em uma √∫nica mensagem o primeiro e o √∫ltimo nome da sua m√£e para que eu fa√ßa a valida√ß√£o do seu cadastro.",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "5fba9763-42f4-4538-a465-6c167f1b8d5a",
                                "type": "text/plain",
                                "content": "Encontrei o seu cadastro, mas o n√∫mero de telefone usado no contato √© diferente do que consta em nosso sistema.\n\nMe manda em uma √∫nica mensagem o primeiro e o √∫ltimo nome da sua m√£e para que eu fa√ßa a valida√ß√£o do seu cadastro."
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "43fe9ed4-d6db-4c7d-9754-0b401896d361",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#86196ba6-28da-49aa-b8c1-da0904f890c6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "555bc847-63da-44a2-b085-2ed458ad724b",
                    "typeOfStateId": "state",
                    "$connId": "con_353",
                    "$id": "90b1b68b-564a-46e2-9012-879a30efc0ae",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "false"
                            ],
                            "variable": "validaNomeMae"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "stateId": "e14e04ff-500f-43e3-b47e-02546cc7b03c",
                    "typeOfStateId": "state",
                    "$connId": "con_358",
                    "$id": "85b9d0c6-cdac-4416-83b8-5f3274da1d44",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "true"
                            ],
                            "variable": "validaNomeMae"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "bea19d5f-4c00-4ac7-a3af-d354de740521",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "phone-not-registered",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "phone-not-registered",
                        "action": "{{contact.identity}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "c461e7a0-0565-4570-8606-6aca1b2c4db5",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Time = 'Rescis√£o'",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "Time": "Rescis√£o"
                        }
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "5fe88b48-76ac-4f21-a9f5-62aa78bd370d",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'inputNomeMae'",
                    "$invalid": false,
                    "settings": {
                        "variable": "inputNomeMae",
                        "value": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "28f7944a-9eb9-40f1-b9df-1bfa52ce2cbe",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'validaNomeMae'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(colaboradorInfo, userInput) {\n    try {\n        const { nomeMae } = JSON.parse(colaboradorInfo).pessoa.dadosPessoais;\n        \n        const nomeMaeNormalized = textNormalizer(nomeMae);\n        const userInputNormalized = textNormalizer(userInput);\n\n        if (!nomeMaeNormalized || !userInputNormalized) {\n            return false;\n        }\n\n        const firstMatch = userInputNormalized[0] === nomeMaeNormalized[0];\n        const lastMatch = userInputNormalized[userInputNormalized.length - 1] === nomeMaeNormalized[nomeMaeNormalized.length - 1];\n\n        return firstMatch && lastMatch;\n    } catch (error) {\n        return false;\n    }\n}\n\nfunction textNormalizer(dataToNormalize) {\n    return dataToNormalize\n        .normalize(\"NFD\")\n        .replace(/([^¬™¬∫a-zA-Z0-9 ]+)/g, \"\")\n        .toUpperCase()\n        .trim()\n        .split(\" \");\n};",
                        "inputVariables": [
                            "colaboradorInfo",
                            "input.content"
                        ],
                        "outputVariable": "validaNomeMae"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "5327ac8e-4ad7-47a6-84fb-f85ab6a864fc",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "2ef3d22f-1971-4836-8489-5baa0e77770d",
            "root": false,
            "$title": "[Msg] Telefone diferente do cadastro",
            "$position": {
                "top": "843px",
                "left": "1071px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "4d3349fc-7fd7-47a4-aaa5-b5e5135d49a0": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "54fe5d38-8311-4191-b4d0-c989e30c76b5",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#86196ba6-28da-49aa-b8c1-da0904f890c6",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "e45ebdbd-3d62-410e-a193-33d4258874ba",
                    "typeOfStateId": "state",
                    "$connId": "con_363",
                    "$id": "44ce652f-c00c-4aad-bdb5-629d5e40a6dc",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "false"
                            ],
                            "variable": "validaTelefoneCadastro"
                        },
                        {
                            "source": "context",
                            "variable": "contact.extras.NomeMaeVerificado",
                            "comparison": "equals",
                            "values": [
                                "true"
                            ]
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "2ef3d22f-1971-4836-8489-5baa0e77770d",
                    "typeOfStateId": "state",
                    "$connId": "con_368",
                    "$id": "22dffef8-ffde-4d94-af31-7504deb252bd",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "false"
                            ],
                            "variable": "validaTelefoneCadastro"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "e45ebdbd-3d62-410e-a193-33d4258874ba",
                    "typeOfStateId": "state",
                    "$connId": "con_373",
                    "$id": "2815fd31-e163-4cc3-a10e-08517fe708dd",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "95e69a03-de83-4342-a51d-b9c9267357ac",
                    "$typeOfContent": "",
                    "type": "ProcessCommand",
                    "$title": "[DWNT] Delete 'convertPessoaIdXmlToJson'",
                    "settings": {
                        "to": "postmaster@msging.net",
                        "method": "delete",
                        "uri": "/contexts/{{contact.identity}}/convertPessoaIdXmlToJson",
                        "variable": "convertPessoaIdXmlToJsonDeleteCmdResp"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "convertPessoaIdXmlToJson"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "f00403e7-2b66-49c5-a186-ed981c8aad5a",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET_V2 'convertPessoaIdXmlToJson'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(colaboradorInfo) {\n    try {\n        const { pessoaId } = JSON.parse(colaboradorInfo).pessoa.dadosPessoais;\n\n        const body = buildBodyRequest(pessoaId);\n        const response = await requestLG(body);\n\n        // SET RESPONSE ON CONTEXT\n        await context.setVariableAsync('responseBuscaColacoradorPessoaId', response.data);\n\n        const responseFormatted = XMLConvert(response.data);\n\n\n        return responseFormatted;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v2/ServicoDeColaborador`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v2/ServicoDeColaborador/Consultar`\n    }\n    const BODY = body;\n\n    // SET BODY ON CONTEXT\n    await context.setVariableAsync('corpoBuscaColacoradorPessoaId', BODY);\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n\n        return {\n            success: isSuccessStatus(response.status),\n            status: response.status,\n            data: tryParseJson(response.body)\n        }\n    } catch (error) {\n        return {\n            error: true,\n            message: error.message || \"Erro inesperado\"\n        }\n    }\n}\n\nfunction isSuccessStatus(status) {\n    if (!status) {\n        return false;\n    }\n\n    return status >= 200 && status < 300;\n}\n\nfunction tryParseJson(response) {\n    try {\n        return JSON.parse(response);\n    } catch (error) {\n        return response;\n    }\n}\n\nfunction buildBodyRequest(pessoaId) {\n    try {\n\n        return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v2=\"lg.com.br/api/v2\" \n    xmlns:v1=\"lg.com.br/api/dto/v1\">\n    \n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n   <soapenv:Body>\n    <v2:Consultar>\n      <v2:filtro>\n      <v1:PessoaId>${pessoaId}</v1:PessoaId>\n      </v2:filtro>\n    </v2:Consultar>\n  </soapenv:Body>\n</soapenv:Envelope>`;\n\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n    xml = xml.replace(/(<a:Conteudo>)(.*?)(<\\/a:Conteudo>)/g, \"$1null$3\");\n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n\n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n\n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n    return obj[ 's:Envelope']['s:Body'].ConsultarResponse.ConsultarResult['a:Retorno'][\"a:Pessoa\"];\n}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "outputVariable": "convertPessoaIdXmlToJson",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "2f6005a1-b284-4dc6-bcbf-45c8c183aa7a",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "RETRY SET_V2 'convertPessoaIdXmlToJson'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(colaboradorInfo) {\n    try {\n        const { pessoaId } = JSON.parse(colaboradorInfo).pessoa.dadosPessoais;\n\n        const body = buildBodyRequest(pessoaId);\n        const response = await requestLG(body);\n\n        // SET RESPONSE ON CONTEXT\n        await context.setVariableAsync('responseBuscaColacoradorPessoaId', response.data);\n\n        const responseFormatted = XMLConvert(response.data);\n\n\n        return responseFormatted;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v2/ServicoDeColaborador`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v2/ServicoDeColaborador/Consultar`\n    }\n    const BODY = body;\n\n    // SET BODY ON CONTEXT\n    await context.setVariableAsync('corpoBuscaColacoradorPessoaId', BODY);\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n\n        return {\n            success: isSuccessStatus(response.status),\n            status: response.status,\n            data: tryParseJson(response.body)\n        }\n    } catch (error) {\n        return {\n            error: true,\n            message: error.message || \"Erro inesperado\"\n        }\n    }\n}\n\nfunction isSuccessStatus(status) {\n    if (!status) {\n        return false;\n    }\n\n    return status >= 200 && status < 300;\n}\n\nfunction tryParseJson(response) {\n    try {\n        return JSON.parse(response);\n    } catch (error) {\n        return response;\n    }\n}\n\nfunction buildBodyRequest(pessoaId) {\n    try {\n\n        return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v2=\"lg.com.br/api/v2\" \n    xmlns:v1=\"lg.com.br/api/dto/v1\">\n    \n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n   <soapenv:Body>\n    <v2:Consultar>\n      <v2:filtro>\n      <v1:PessoaId>${pessoaId}</v1:PessoaId>\n      </v2:filtro>\n    </v2:Consultar>\n  </soapenv:Body>\n</soapenv:Envelope>`;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n\n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n\n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n\n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n    return obj[ 's:Envelope']['s:Body'].ConsultarResponse.ConsultarResult['a:Retorno'][\"a:Pessoa\"][\"a:Contato\"];\n}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "outputVariable": "convertPessoaIdXmlToJson",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "convertPessoaIdXmlToJson",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "0c60baf3-433d-4765-b4de-0d2af101e7e6",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "UPDATE 'colaboradorInfo'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(obj, response) {\n    try {\n        if (!obj) return false\n\n        obj = JSON.parse(obj)\n\n        const retorno = JSON.parse(response);\n\n        const contato = retorno[\"a:Contato\"];\n        const dadosPessoais = retorno[\"a:DadosPessoais\"];\n\n        if (contato[\"a:Celular\"] && contato[\"a:Celular\"].length === 8) {\n            contato[\"a:Celular\"] = \"9\" + contato[\"a:Celular\"];\n        }\n        if (contato[\"a:Telefone\"] && contato[\"a:Telefone\"].length === 8) {\n            contato[\"a:Telefone\"] = \"9\" + contato[\"a:Telefone\"];\n        }\n\n        if (contato[\"a:EmailCorporativo\"]) {\n            obj['pessoa']['contato']['emailCorporativo'] = contato[\"a:EmailCorporativo\"];\n        } else {\n            obj['pessoa']['contato']['emailCorporativo'] = \"SEM EMAIL CORPORATIVO\";\n        }\n\n        if(contato[\"a:EmailParticular\"]) {\n            obj['pessoa']['contato']['emailParticular'] = contato[\"a:EmailParticular\"];\n        } else {\n            obj['pessoa']['contato']['emailParticular'] = \"SEM EMAIL PARTICULAR\";\n        }\n\n        if (contato[\"a:DddTelefone\"] && contato[\"a:Telefone\"]) {\n            obj['pessoa']['contato']['telefone'] = contato[\"a:DddTelefone\"] + contato[\"a:Telefone\"];\n        } else {\n            obj['pessoa']['contato']['telefone'] = \"SEM TELEFONE CADASTRO\";\n        }\n\n        if (contato[\"a:DddCelular\"] && contato[\"a:Celular\"]) {\n            obj['pessoa']['contato']['celular'] = contato[\"a:DddCelular\"] + contato[\"a:Celular\"];\n        } else {\n            obj['pessoa']['contato']['celular'] = \"SEM CELULAR CADASTRO\";\n        }\n\n        if (dadosPessoais && dadosPessoais[\"b:NomeDaMae\"]) {\n            obj['pessoa']['dadosPessoais']['nomeMae'] = dadosPessoais[\"b:NomeDaMae\"];\n        } else {\n            obj['pessoa']['dadosPessoais']['nomeMae'] = \"SEM REGISTRO\";\n        }\n\n        if (dadosPessoais && dadosPessoais[\"b:NomeDoPai\"]) {\n            obj['pessoa']['dadosPessoais']['nomePai'] = dadosPessoais[\"b:NomeDoPai\"];\n        } else {\n            obj['pessoa']['dadosPessoais']['nomePai'] = \"SEM REGISTRO\";\n        }\n\n        return obj;\n    } catch (e) {\n        return false\n    }\n}",
                        "inputVariables": [
                            "colaboradorInfo",
                            "convertPessoaIdXmlToJson"
                        ],
                        "outputVariable": "colaboradorInfo",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f2b33bbb-de85-449f-858b-ae05c868a2cd",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'validaTelefoneCadastro'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(colaborador, dwn) {\n\ttry {\n\t\tconst { telefone, celular } = JSON.parse(colaborador).pessoa.contato;\n\t\tconst { cellphone } = JSON.parse(dwn).user;\n\n\t\treturn (cellphone ===  celular) || (cellphone === telefone);\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}",
                        "inputVariables": [
                            "colaboradorInfo",
                            "dwn"
                        ],
                        "outputVariable": "validaTelefoneCadastro",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "4d3349fc-7fd7-47a4-aaa5-b5e5135d49a0",
            "root": false,
            "$title": "[API] Busca telefone por PessoaID",
            "$position": {
                "top": "669px",
                "left": "1071px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "6611aecf-96e6-4cdf-807f-e42de6f92369": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "d4182282-0218-41ce-8deb-fbdd6afa3808",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b229c0f2-4a88-4593-876d-cc65d8ce74b3",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "8ab2ba9a-94ca-459c-814b-67006e9fbe4b",
                    "typeOfStateId": "state",
                    "$connId": "con_378",
                    "$id": "278b7455-aa91-4238-b56d-4fb8933b1675",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "75e6de2d-6816-42cb-831c-8813a988a495",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET_V2 'informacoesRescisao'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(colaboradorInfo) {\n    try {\n\n        const { empresa, dadosGerais } = JSON.parse(colaboradorInfo);\n        const { dataInicioDaSituacaoAtual, matricula } = dadosGerais;\n        const { codigo } = empresa;\n\n        const body = buildBodyRequest(dataInicioDaSituacaoAtual, matricula, codigo);\n        const response = await requestLG(body);\n\n        // SET RESPONSE ON CONTEXT\n        await context.setVariableAsync('responseConsultaRescisao', response);\n\n        const responseFormatted = XMLConvert(response.data);\n\n        return responseFormatted;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v1/ServicoDeRescisao`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v1/ServicoDeRescisao/Consultar`\n    }\n    const BODY = body;\n\n    // SET BODY ON CONTEXT\n    await context.setVariableAsync('corpoConsultaRescisao', BODY);\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n\n        return {\n            success: isSuccessStatus(response.status),\n            status: response.status,\n            data: tryParseJson(response.body)\n        }\n    } catch (error) {\n        return {\n            error: true,\n            message: error.message || \"Erro inesperado\"\n        }\n    }\n}\n\nfunction isSuccessStatus(status) {\n    if (!status) {\n        return false;\n    }\n\n    return status >= 200 && status < 300;\n}\n\nfunction tryParseJson(response) {\n    try {\n        return JSON.parse(response);\n    } catch (error) {\n        return response;\n    }\n}\n\nfunction buildBodyRequest(dataInicioDaSituacaoAtual, matricula, codigo) {\n    try {\n\n        return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v1=\"lg.com.br/api/v1\" \n    xmlns:v11=\"lg.com.br/api/dto/v1\">\n\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      \n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n   <soapenv:Body>\n        <v1:Consultar>\n            <v1:filtro>\n                <v11:DataDaOcorrencia>${dataInicioDaSituacaoAtual}</v11:DataDaOcorrencia>\n                <v11:IdentificacaoDeContrato>\n                    <v11:Empresa>\n                        <v11:Codigo>${codigo}</v11:Codigo>\n                    </v11:Empresa>\n                    <v11:Matricula>${matricula}</v11:Matricula>\n                </v11:IdentificacaoDeContrato>\n            </v1:filtro>\n        </v1:Consultar>\n    </soapenv:Body>\n  \n</soapenv:Envelope>`;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    try {\n        let obj = {};\n        let tagStack = [];\n        let currentNode = obj;\n\n        // Regex patterns for XML parsing\n        const tagPattern = /<([^>]+)>/g;\n        let match;\n        let lastIndex = 0;\n\n        while ((match = tagPattern.exec(xml)) !== null) {\n            const tagContent = match[1];\n            const isEndTag = tagContent[0] === '/';\n\n            const textContent = xml.substring(lastIndex, match.index).trim();\n            if (textContent && tagStack.length > 0) {\n                const parentNode = tagStack[tagStack.length - 1];\n                if (!parentNode[\"_text\"]) {\n                    parentNode[\"_text\"] = textContent;\n                } else if (typeof parentNode[\"_text\"] === \"string\") {\n                    parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n                } else {\n                    parentNode[\"_text\"].push(textContent);\n                }\n            }\n\n            lastIndex = match.index + match[0].length;\n\n            if (isEndTag) {\n                tagStack.pop();\n                currentNode = tagStack[tagStack.length - 1] || obj;\n            } else {\n                const tagParts = tagContent.split(' ');\n                const tagName = tagParts[0];\n                const newNode = {};\n\n                if (currentNode[tagName] === undefined) {\n                    currentNode[tagName] = newNode;\n                } else if (Array.isArray(currentNode[tagName])) {\n                    currentNode[tagName].push(newNode);\n                } else {\n                    currentNode[tagName] = [currentNode[tagName], newNode];\n                }\n\n                if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                    tagStack.push(newNode);\n                    currentNode = newNode;\n                }\n            }\n        }\n\n        // Clean up _text keys\n        function cleanUp(obj) {\n            for (let key in obj) {\n                if (obj[key] && typeof obj[key] === \"object\") {\n                    if (obj[key]._text) {\n                        if (Object.keys(obj[key]).length === 1) {\n                            obj[key] = obj[key]._text;\n                        } else {\n                            obj[key].textValue = obj[key]._text;\n                            delete obj[key]._text;\n                        }\n                    } else if (Object.values(obj[key]).length === 0) {\n                        delete obj[key];\n                    }\n                    cleanUp(obj[key]);\n                }\n            }\n        }\n\n        cleanUp(obj);\n\n        return obj['s:Envelope']['s:Body'].ConsultarResponse.ConsultarResult['a:Retorno'];\n    } catch (error) {\n        return false\n    }\n}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "outputVariable": "informacoesRescisao",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "c356fe5a-1102-4079-92ed-3489f733441d",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "6611aecf-96e6-4cdf-807f-e42de6f92369",
            "root": false,
            "$title": "[API] Informa√ß√µes rescis√£o",
            "$position": {
                "top": "1513px",
                "left": "2909px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "c356fe5a-1102-4079-92ed-3489f733441d": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "ba1d430f-b1da-4310-9807-1e2e40f4f99c",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b229c0f2-4a88-4593-876d-cc65d8ce74b3",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "f73ca752-4b68-4b52-92b5-7fcf56d07058",
                    "typeOfStateId": "state",
                    "$connId": "con_383",
                    "$id": "fe7b092f-a732-427b-9ec7-2b50d8658c43",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "98c59fec-e514-4c69-a4ab-7ec4c4aca404",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET_V2 'jsonCalendarioPagamentos'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(TipoDeFolhaDePagamento) {\n    try {\n        const monthList = [];\n        let year = new Date().getFullYear();\n        const now = new Date();\n        const MIN_YEAR = now.getFullYear() - 1;\n        const DIFF_DAYS_PAYMENT = 2;\n\n        do {\n            const body = buildBodyRequest(year, TipoDeFolhaDePagamento);\n            const response = await requestLG(body);\n            const responseFormatted = XMLConvert(response.body);\n\n            if (!responseFormatted) {\n                year--;\n                continue;\n            }\n\n            const dataArray = Array.isArray(responseFormatted) ? responseFormatted : [responseFormatted];\n\n            for (const item of dataArray) {\n                const dataPagamento = item[\"a:DataDoPagamento\"];\n                if (dataPagamento) {\n                    const paymentDate = new Date(dataPagamento);\n                    const diffDays = (paymentDate - now) / (1000 * 60 * 60 * 24);\n                    if (diffDays <= DIFF_DAYS_PAYMENT) {\n                        monthList.push(item);\n                    }\n                }\n            }\n\n            year--;\n        } while (monthList.length < 3 && year >= MIN_YEAR);\n\n        monthList.sort((a, b) => new Date(a[\"a:DataDoPagamento\"]) - new Date(b[\"a:DataDoPagamento\"]));\n\n        return monthList.slice(-3);\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v1/ServicoDeDataDePagamento`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v1/ServicoDeDataDePagamento/ConsultarListaInformacoesDaDataDePagamento`\n    }\n    const BODY = body;\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n        // const responseJson = await response.jsonAsync();\n\n        return response;\n        // return responseJson;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction buildBodyRequest(anoValidacao, TipoDeFolhaDePagamento) {\n    try {\n\n        return `<soapenv:Envelope \n        xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n        xmlns:dto=\"lg.com.br/svc/dto\" \n        xmlns:v1=\"lg.com.br/api/v1\" \n        xmlns:v11=\"lg.com.br/api/dto/v1\">\n\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      \n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n   <soapenv:Body>\n    <v1:ConsultarListaInformacoesDaDataDePagamento>\n      <v1:filtro>\n        <v11:Ano>${anoValidacao}</v11:Ano>\n        <v11:Empresa>\n          <v11:Codigo>{{contact.extras.empresaId}}</v11:Codigo>\n        </v11:Empresa>\n        <v11:Folha>\n          <v11:Codigo>${TipoDeFolhaDePagamento}</v11:Codigo>\n        </v11:Folha>\n        <v11:TipoConceito>2</v11:TipoConceito>\n      </v1:filtro>\n    </v1:ConsultarListaInformacoesDaDataDePagamento>\n  </soapenv:Body>\n  \n</soapenv:Envelope>`;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    try {\n        let obj = {};\n        let tagStack = [];\n        let currentNode = obj;\n\n        // Regex patterns for XML parsing\n        const tagPattern = /<([^>]+)>/g;\n        let match;\n        let lastIndex = 0;\n\n        while ((match = tagPattern.exec(xml)) !== null) {\n            const tagContent = match[1];\n            const isEndTag = tagContent[0] === '/';\n\n            const textContent = xml.substring(lastIndex, match.index).trim();\n            if (textContent && tagStack.length > 0) {\n                const parentNode = tagStack[tagStack.length - 1];\n                if (!parentNode[\"_text\"]) {\n                    parentNode[\"_text\"] = textContent;\n                } else if (typeof parentNode[\"_text\"] === \"string\") {\n                    parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n                } else {\n                    parentNode[\"_text\"].push(textContent);\n                }\n            }\n\n            lastIndex = match.index + match[0].length;\n\n            if (isEndTag) {\n                tagStack.pop();\n                currentNode = tagStack[tagStack.length - 1] || obj;\n            } else {\n                const tagParts = tagContent.split(' ');\n                const tagName = tagParts[0];\n                const newNode = {};\n\n                if (currentNode[tagName] === undefined) {\n                    currentNode[tagName] = newNode;\n                } else if (Array.isArray(currentNode[tagName])) {\n                    currentNode[tagName].push(newNode);\n                } else {\n                    currentNode[tagName] = [currentNode[tagName], newNode];\n                }\n\n                if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                    tagStack.push(newNode);\n                    currentNode = newNode;\n                }\n            }\n        }\n\n        // Clean up _text keys\n        function cleanUp(obj) {\n            for (let key in obj) {\n                if (obj[key] && typeof obj[key] === \"object\") {\n                    if (obj[key]._text) {\n                        if (Object.keys(obj[key]).length === 1) {\n                            obj[key] = obj[key]._text;\n                        } else {\n                            obj[key].textValue = obj[key]._text;\n                            delete obj[key]._text;\n                        }\n                    } else if (Object.values(obj[key]).length === 0) {\n                        delete obj[key];\n                    }\n                    cleanUp(obj[key]);\n                }\n            }\n        }\n\n        cleanUp(obj);\n\n        return obj['s:Envelope']['s:Body'].ConsultarListaInformacoesDaDataDePagamentoResponse.ConsultarListaInformacoesDaDataDePagamentoResult['a:Retorno']['a:DataDePagamento']\n    } catch (error) {\n        return false\n    }\n}",
                        "inputVariables": [
                            "contact.extras.TipoDeFolhaDePagamento"
                        ],
                        "outputVariable": "jsonCalendarioPagamentos",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "c356fe5a-1102-4079-92ed-3489f733441d",
            "root": false,
            "$title": "[API] Data de pagamento",
            "$position": {
                "top": "111px",
                "left": "4355.5px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "f73ca752-4b68-4b52-92b5-7fcf56d07058": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "cf9d8a1e-e198-42db-9bf1-d48908975112",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b229c0f2-4a88-4593-876d-cc65d8ce74b3",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "{{nextBlock}}",
                    "typeOfStateId": "variable",
                    "$id": "8278fdbd-2a58-4b81-ae9c-3672891e9118",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "exists",
                            "values": [],
                            "variable": "nextBlock"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "2149dbcb-5546-4768-b631-9cd7d56bbac3",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - error:NO-NEXT-BLOCK",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\n\n\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"api-get-payday\",\n    messages: [\n      `Desculpe, estou com uma instabilidade no momento. Por favor, reporte este erro para que eu possa te ajudar.`,\n    ],\n    error: {\n      default: \"NO-NEXT-BLOCK\"\n    },\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"90b382ba\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "source": "context",
                            "variable": "nextBlock",
                            "comparison": "notExists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "f73ca752-4b68-4b52-92b5-7fcf56d07058",
            "root": false,
            "$title": "[GO TO] Next block",
            "$position": {
                "top": "275px",
                "left": "4355px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "e853bc21-e205-4805-af86-6884c0ac1d02": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "d4182282-0218-41ce-8deb-fbdd6afa3808",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b229c0f2-4a88-4593-876d-cc65d8ce74b3",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "ba467c7c-baeb-49fc-81d5-01815f650d72",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Definir TipoDeFolhaDePagamento",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "TipoDeFolhaDePagamento": "15"
                        }
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "7bcd87ec-bca3-416c-99f0-de1798bc28ca",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'nextBlock'",
                    "$invalid": false,
                    "settings": {
                        "variable": "nextBlock",
                        "value": "293fd567-898b-4821-8047-1c4a7b887834"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "c356fe5a-1102-4079-92ed-3489f733441d",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                }
            ],
            "id": "e853bc21-e205-4805-af86-6884c0ac1d02",
            "root": false,
            "$title": "[GO TO] Busca data de pagamento",
            "$position": {
                "top": "1752px",
                "left": "5041px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "b34272eb-fd25-4f3f-99fb-a215d5bafa48": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "c57c3c36-73d9-448f-9e86-4eb16db42fec",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "c43a9e48-fc6e-4538-aca0-85a68bd21fcb",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "c43a9e48-fc6e-4538-aca0-85a68bd21fcb",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "718ec366-d3a7-49fa-9828-eb6da1785b70",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "application/json",
                            "rawContent": "{{flowsContent}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "3e9bbedd-2e14-4d8b-b33f-c66e1896f8c5",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b229c0f2-4a88-4593-876d-cc65d8ce74b3",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "e398983e-1808-4c55-8c96-68bcf281a6dd",
                    "typeOfStateId": "state",
                    "$connId": "con_388",
                    "$id": "950fbc37-6621-470a-a57f-35ae3d57f77d",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "95272f9f-5312-4a34-9ea8-ef26f08b4b4f",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - FlowsInput",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\n\nasync function dwnRun() {\n  const dwnPrepare = {\n  id: \"flows_dados-bancarios\",\n  checkpoint: true,\n  models: [\"FLOWS\"],\n  error: {\n    default: \"FLOWS_UNEXPECTED_INPUT\"\n  },\n  messages: [\n    `Abra o formul√°rio no celular para informar os dados do banco que deseja receber o P4P.`,\n    `Ainda √© inv√°lido. Se quiser voltar ao menu principal, digite 'Menu' ou 'Voltar'`\n  ]\n};\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cecef02c\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "fa97d687-0a12-49f6-9c87-f17c8abd6e09",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'listaBancos'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n\ttry {\n\t\treturn [\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO DO BRASIL-1\",\n\t\t\t\t\"title\": \"BANCO DO BRASIL\",\n\t\t\t\t\"metadata\": \"1\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"SANTANDER-33\",\n\t\t\t\t\"title\": \"SANTANDER\",\n\t\t\t\t\"metadata\": \"33\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO INTER S.A-77\",\n\t\t\t\t\"title\": \"BANCO INTER S.A\",\n\t\t\t\t\"metadata\": \"77\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO XP-102\",\n\t\t\t\t\"title\": \"BANCO XP\",\n\t\t\t\t\"metadata\": \"102\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"CAIXA ECONOMICA FEDERAL-104\",\n\t\t\t\t\"title\": \"CAIXA ECONOMICA FEDERAL\",\n\t\t\t\t\"metadata\": \"104\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"AGIBANK SA-121\",\n\t\t\t\t\"title\": \"AGIBANK SA\",\n\t\t\t\t\"metadata\": \"121\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"NOSSA CAIXA-151\",\n\t\t\t\t\"title\": \"NOSSA CAIXA\",\n\t\t\t\t\"metadata\": \"151\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BTG PACTUAL-208\",\n\t\t\t\t\"title\": \"BTG PACTUAL\",\n\t\t\t\t\"metadata\": \"208\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO ORIGINAL-212\",\n\t\t\t\t\"title\": \"BANCO ORIGINAL\",\n\t\t\t\t\"metadata\": \"212\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BRADESCO-237\",\n\t\t\t\t\"title\": \"BRADESCO\",\n\t\t\t\t\"metadata\": \"237\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO NUBANK-260\",\n\t\t\t\t\"title\": \"BANCO NUBANK\",\n\t\t\t\t\"metadata\": \"260\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO REAL-275\",\n\t\t\t\t\"title\": \"BANCO REAL\",\n\t\t\t\t\"metadata\": \"275\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"PAGBANK-290\",\n\t\t\t\t\"title\": \"PAGBANK\",\n\t\t\t\t\"metadata\": \"290\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO BMG-318\",\n\t\t\t\t\"title\": \"BANCO BMG\",\n\t\t\t\t\"metadata\": \"318\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO MERCADO PAGO-323\",\n\t\t\t\t\"title\": \"BANCO MERCADO PAGO\",\n\t\t\t\t\"metadata\": \"323\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO C6 S.A-336\",\n\t\t\t\t\"title\": \"BANCO C6 S.A\",\n\t\t\t\t\"metadata\": \"336\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"ITAU-341\",\n\t\t\t\t\"title\": \"ITAU\",\n\t\t\t\t\"metadata\": \"341\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"MIDWAY-358\",\n\t\t\t\t\"title\": \"MIDWAY\",\n\t\t\t\t\"metadata\": \"358\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"PICPAY SERVICOS S.A-380\",\n\t\t\t\t\"title\": \"PICPAY SERVICOS S.A\",\n\t\t\t\t\"metadata\": \"380\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"NU FINANCEIRA-386\",\n\t\t\t\t\"title\": \"NU FINANCEIRA\",\n\t\t\t\t\"metadata\": \"386\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"HSBC-399\",\n\t\t\t\t\"title\": \"HSBC\",\n\t\t\t\t\"metadata\": \"399\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"UNIBANCO-409\",\n\t\t\t\t\"title\": \"UNIBANCO\",\n\t\t\t\t\"metadata\": \"409\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"NEON-426\",\n\t\t\t\t\"title\": \"NEON\",\n\t\t\t\t\"metadata\": \"426\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"NEON PAGAMENTOS-536\",\n\t\t\t\t\"title\": \"NEON PAGAMENTOS\",\n\t\t\t\t\"metadata\": \"536\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"PAN FINANCEIRA-555\",\n\t\t\t\t\"title\": \"PAN FINANCEIRA\",\n\t\t\t\t\"metadata\": \"555\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"PAN-623\",\n\t\t\t\t\"title\": \"PAN\",\n\t\t\t\t\"metadata\": \"623\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"C6 CONSIGNADO-626\",\n\t\t\t\t\"title\": \"C6 CONSIGNADO\",\n\t\t\t\t\"metadata\": \"626\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"BANCO INTER SA-903\",\n\t\t\t\t\"title\": \"BANCO INTER SA\",\n\t\t\t\t\"metadata\": \"903\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": \"PARATI CFI S A-908\",\n\t\t\t\t\"title\": \"PARATI CFI S A\",\n\t\t\t\t\"metadata\": \"908\"\n\t\t\t}\n\t\t]\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}",
                        "inputVariables": [],
                        "outputVariable": "listaBancos",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "31966b4b-07ae-40a7-bfc7-73748a14b8af",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'flowsContent'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(listaBancos) {\n\ttry {\n\t\treturn {\n\t\t\t\"recipient_type\": \"individual\",\n\t\t\t\"type\": \"interactive\",\n\t\t\t\"interactive\": {\n\t\t\t\t\"type\": \"flow\",\n\t\t\t\t\"body\": {\n\t\t\t\t\t\"text\": \"Certo, por favor informe seus dados banc√°rios clicando em *informar*. üëá\"\n\t\t\t\t},\n\t\t\t\t\"action\": {\n\t\t\t\t\t\"name\": \"flow\",\n\t\t\t\t\t\"parameters\": {\n\t\t\t\t\t\t\"flow_message_version\": \"3\",\n\t\t\t\t\t\t\"flow_id\": \"1248783520388233\",\n\t\t\t\t\t\t//\"mode\": \"draft\",\n\t\t\t\t\t\t\"flow_cta\": \"Ver op√ß√µes\",\n\t\t\t\t\t\t\"flow_action\": \"navigate\",\n\t\t\t\t\t\t\"flow_token\": \"{{contact.identity}}\",\n\t\t\t\t\t\t\"flow_action_payload\": {\n\t\t\t\t\t\t\t\"screen\": \"DADOS_BANCARIOS\",\n\t\t\t\t\t\t\t\"data\": {\n\t\t\t\t\t\t\t\t\"listaBancos\": JSON.parse(listaBancos)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}",
                        "inputVariables": [
                            "listaBancos"
                        ],
                        "outputVariable": "flowsContent",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "continueOnError": true
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "5ede6c7f-d7a6-4e5d-a9f1-cf7a907a38bd",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'bodyApiAtualizaDadosBancarios'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n\ttry {\n\n\t\treturn `{{dwn@input.payload}}`\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}",
                        "inputVariables": [],
                        "outputVariable": "bodyApiAtualizaDadosBancarios",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                }
            ],
            "id": "b34272eb-fd25-4f3f-99fb-a215d5bafa48",
            "root": false,
            "$title": "[Flows] Dados banc√°rios",
            "$position": {
                "top": "1758px",
                "left": "5275px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "e398983e-1808-4c55-8c96-68bcf281a6dd": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "698fcf85-72e8-431b-8cbd-a569691046fc",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b229c0f2-4a88-4593-876d-cc65d8ce74b3",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "199722a1-d045-499e-a2d1-1ea54de0660c",
                    "typeOfStateId": "state",
                    "$connId": "con_393",
                    "$id": "5f42cde1-3586-4807-9f05-68b2788455f3",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "true"
                            ],
                            "variable": "setDataBank@success"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "stateId": "57db7b75-a6f1-42ad-ac17-1c11827d58ba",
                    "typeOfStateId": "state",
                    "$connId": "con_398",
                    "$id": "da1e540a-b383-40e9-94ef-daf793f5609f",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "1"
                            ],
                            "variable": "setDataBank@code"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "199722a1-d045-499e-a2d1-1ea54de0660c",
                    "typeOfStateId": "state",
                    "$connId": "con_403",
                    "$id": "66c9b624-fa4b-4fdc-9a13-5d0d7d4cf428",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "2"
                            ],
                            "variable": "setDataBank@code"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "5cfe10cf-bb0a-4361-a562-f67c1813608e",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Definir contato",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "Banco": "{{dwn@input.payload.nomeBanco}}",
                            "Conta": "{{dwn@input.payload.numeroConta}}",
                            "DVConta": "{{dwn@input.payload.digitoConta}}",
                            "Agencia": "{{dwn@input.payload.numeroAgencia}}"
                        }
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "daafedf0-a836-4437-9353-70c7019db8c5",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "Process 'setDataBank'",
                    "settings": {
                        "function": "run",
                        "source": "// LEGENDA CODIGOS NO RETORNO CRIADOS PARA ESTE SCRIPT:\n// CODE 0 -> SUCESSO NA REQUEST\n// CODE 1 -> FALHA POR MOTIVOS GERAIS (SEM AGENCIA REGISTRADA, POR EX)\n// CODE 2 -> DADOS INSERIDOS J√Å EST√ÉO NA BASE PARA ATUALIZA√á√ÉO\n// ------------------------------------------------------------------------------------------------------------------------ // \n\nasync function dwnRun(dwn) {\n  try {\n    const { payload } = JSON.parse(dwn).input;\n\n    const body = buildBodyRequest(payload);\n    const query = buildQueryParam();\n    const response = await fetch(body, query);\n\n    // SET RESPONSE ON CONTEXT (Apenas deixar se o response for grande e for preciso recuperar)    \n    await context.setVariableAsync('responseAtualizaDadosBancarios', response);\n\n    const jsonResponse = getJsonFromXml(response.data);\n    // SET JsonResponse ON CONTEXT\n    await context.setVariableAsync('jsonResponseAtualizarDadosBancarios', jsonResponse);\n\n    if (jsonResponse['a:Tipo'] === '1') {\n      if (jsonResponse['a:Mensagens']['b:string'].includes(\"Origem e destino n√£o podem ser iguais\")) {\n        return {\n          success: false,\n          code: 2,\n          message: \"N√£o se preocupe, j√° recebi seus dados atualizados. Se houver qualquer novidade, te chamo por aqui.\"\n        }\n\n      } else {\n        return {\n          success: false,\n          code: 1,\n          message: \"N√£o consegui fazer o cadastro por aqui, mas j√° estou chamando ajuda para finalizar o seu processo.\"\n        };\n      }\n\n    } else {\n      return {\n        success: true,\n        ...jsonResponse\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}\n\nasync function fetch(body, query) {\n  const baseURL = `{{config.LGBaseUrl}}`\n  const URL = `${baseURL}/v1/ServicoDeMovimentacao`;\n  const METHOD = 'POST';\n  const HEADERS = {\n    'Content-Type': 'text/xml',\n    'SOAPAction': `lg.com.br/api/v1/ServicoDeMovimentacao/CadastrarLista`\n  }\n  const BODY = body;\n\n  if (body) {\n    // SET BODY ON CONTEXT (Apenas deixar se o response for grande e for preciso recuperar)    \n    await context.setVariableAsync('bodyAtualizaDadosBancarios', body);\n  }\n\n  try {\n    const response = await http.request({ url: URL, method: METHOD, headers: HEADERS, body: BODY });\n\n    return response;\n  } catch (error) {\n    return {\n      error: true,\n      message: error.message || \"Erro inesperado\"\n    }\n  }\n}\n\nfunction buildBodyRequest(payload) {\n  try {\n\n    const { nomeBanco, numeroConta, digitoConta, numeroAgencia, digitoAgencia } = payload;\n\n    const codigoBanco = nomeBanco.split(\"-\")[1];\n    const horario = time.dateToString(new Date(), { format: \"dd/MM/yyyy HH:mm\", timeZone: \"America/Sao_Paulo\" });\n\n    return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v1=\"lg.com.br/api/v1\" \n    xmlns:v11=\"lg.com.br/api/dto/v1\">\n\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      \n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n   <soapenv:Body>\n        <v1:CadastrarLista>\n            <v1:listaDeMovimentacoes>\n                <v11:MovimentacaoV2>\n                    <v11:DataDaOcorrencia>2025-02-11</v11:DataDaOcorrencia>\n                    <v11:IdentificacaoDoContrato>\n                        <v11:Empresa>\n                            <v11:Codigo>3</v11:Codigo>\n                        </v11:Empresa>\n                        <v11:Matricula>783</v11:Matricula>\n                    </v11:IdentificacaoDoContrato>\n                    <v11:ItensMovimentados>\n                        <v11:ItemMovimentadoAbstratoV2 i:type=\"v11:ItemMovimentadoDadosBancariosV3\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n                            <v11:CodigoDoBanco>${codigoBanco}</v11:CodigoDoBanco>\n                            <v11:CodigoDaAgencia>${numeroAgencia}</v11:CodigoDaAgencia>\n                            <v11:Conta>${numeroConta}</v11:Conta>\n                            <v11:DigitoDaConta>${digitoConta}</v11:DigitoDaConta>\n                            <v11:FormaDePagamento>1</v11:FormaDePagamento>\n                            <v11:TipoDaConta>001</v11:TipoDaConta>\n                        </v11:ItemMovimentadoAbstratoV2>\n                    </v11:ItensMovimentados>\n                    <v11:ParametrosDeMovimentacao>\n                        <v11:Descricao>MOVIMENTACAO REALIZADA WHATSAPP</v11:Descricao>\n                        <v11:Motivo>\n                            <v11:Codigo>12</v11:Codigo>\n                        </v11:Motivo>\n                        <v11:Observacoes>ALTERACAO DADOS BANCARIOS REALIZADA EM ${horario}</v11:Observacoes>\n                    </v11:ParametrosDeMovimentacao>\n                </v11:MovimentacaoV2>\n            </v1:listaDeMovimentacoes>\n        </v1:CadastrarLista>\n    </soapenv:Body>\n\n    </soapenv:Envelope>`;;\n  } catch (error) {\n    return error.message;\n  }\n}\n\nfunction buildQueryParam() {\n  try {\n\n    return \"\";\n  } catch (error) {\n    return error.message;\n  }\n}\n\nfunction getJsonFromXml(xml) {\n  let obj = {};\n  let tagStack = [];\n  let currentNode = obj;\n\n  // Regex patterns for XML parsing\n  const tagPattern = /<([^>]+)>/g;\n  let match;\n  let lastIndex = 0;\n\n  while ((match = tagPattern.exec(xml)) !== null) {\n    const tagContent = match[1];\n    const isEndTag = tagContent[0] === '/';\n\n    const textContent = xml.substring(lastIndex, match.index).trim();\n    if (textContent && tagStack.length > 0) {\n      const parentNode = tagStack[tagStack.length - 1];\n      if (!parentNode[\"_text\"]) {\n        parentNode[\"_text\"] = textContent;\n      } else if (typeof parentNode[\"_text\"] === \"string\") {\n        parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n      } else {\n        parentNode[\"_text\"].push(textContent);\n      }\n    }\n\n    lastIndex = match.index + match[0].length;\n\n    if (isEndTag) {\n      tagStack.pop();\n      currentNode = tagStack[tagStack.length - 1] || obj;\n    } else {\n      const tagParts = tagContent.split(' ');\n      const tagName = tagParts[0];\n      const newNode = {};\n\n      if (currentNode[tagName] === undefined) {\n        currentNode[tagName] = newNode;\n      } else if (Array.isArray(currentNode[tagName])) {\n        currentNode[tagName].push(newNode);\n      } else {\n        currentNode[tagName] = [currentNode[tagName], newNode];\n      }\n\n      if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n        tagStack.push(newNode);\n        currentNode = newNode;\n      }\n    }\n  }\n\n  // Clean up _text keys\n  function cleanUp(obj) {\n    for (let key in obj) {\n      if (obj[key] && typeof obj[key] === \"object\") {\n        if (obj[key]._text) {\n          if (Object.keys(obj[key]).length === 1) {\n            obj[key] = obj[key]._text;\n          } else {\n            obj[key].textValue = obj[key]._text;\n            delete obj[key]._text;\n          }\n        } else if (Object.values(obj[key]).length === 0) {\n          delete obj[key];\n        }\n        cleanUp(obj[key]);\n      }\n    }\n  }\n\n  cleanUp(obj);\n  return obj\n  ['s:Envelope']\n  ['s:Body']\n  ['CadastrarListaResponse']\n  ['CadastrarListaResult']\n  ['a:ListaDeRetorno']\n  ['a:IdentificadorDeOcorrencias'];\n}\n\n\nasync function run(...args) {\n  const id = \"atualizar-dados-bancarios\";\n  let result = await dwnCompleteScript(id, dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nvar HttpError = class extends Error {\n  constructor(message, status, response) {\n    super(message);\n    this.name = \"HttpError\";\n    this.status = status;\n    this.response = response;\n  }\n};\nvar HttpClient = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Performs an HTTP request with comprehensive logging and error handling.\n   *\n   * Makes HTTP requests with automatic JSON handling, response validation, and detailed logging.\n   * All requests and responses are logged for debugging and monitoring purposes.\n   *\n   * @param {{url: string, method?: \"GET\" | \"POST\" | \"PUT\" | \"DELETE\" | \"PATCH\", params?: {[key: string]: string}, headers?: {[key: string]: string}, body?: Record<string, any> | Array<any> | string, valid?: ((status: number) => boolean) | number[] | number, reduce?: (response: FetchResponse) => string}} config HTTP request configuration:\n   * - `url`: The target URL for the HTTP request (required)\n   * - `method`: HTTP method to use (defaults to \"GET\")\n   * - `params`: Query parameters to append to the URL\n   * - `headers`: HTTP headers to include in the request\n   * - `body`: Request body (objects/arrays are automatically JSON stringified)\n   * - `valid`: Custom validation for HTTP status codes (function, array, or single number)\n   * - `reduce`: Custom function to process the response before logging\n   *\n   * @returns {Promise<{status: number, data: any, headers: {[key: string]: string}}>} Promise resolving to HTTP response:\n   * - `status`: HTTP status code\n   * - `data`: Parsed response body (JSON parsed if possible, otherwise raw string)\n   * - `headers`: Response headers as key-value object\n   *\n   * @throws {DwnError} Throws MISCONFIGURATION_ERROR if URL is missing or method is invalid\n   * @throws {HttpError} Throws HttpError if the request fails or returns invalid status code\n   *\n   * @example\n   * ```typescript\n   * // Simple GET request\n   * const response = await http.request({ url: \"https://api.example.com/users\" });\n   *\n   * // POST request with JSON body\n   * const createUser = await http.request({\n   *   url: \"https://api.example.com/users\",\n   *   method: \"POST\",\n   *   headers: { \"Authorization\": \"Bearer token123\" },\n   *   body: { name: \"John Doe\", email: \"john@example.com\" }\n   * });\n   *\n   * // GET with query parameters\n   * const filtered = await http.request({\n   *   url: \"https://api.example.com/users\",\n   *   params: { page: \"1\", limit: \"10\", status: \"active\" }\n   * });\n   *\n   * // Custom status validation\n   * const result = await http.request({\n   *   url: \"https://api.example.com/data\",\n   *   valid: [200, 201, 202] // Accept multiple success codes\n   * });\n   * ```\n   */\n  async request(config) {\n    if (!config || !config.url) {\n      throw new DwnError(\n        \"MISCONFIGURATION_ERROR\",\n        \"HTTP request must have a URL.\"\n      );\n    }\n    if (config.method && ![\"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\"].includes(config.method)) {\n      throw new DwnError(\n        \"MISCONFIGURATION_ERROR\",\n        `Invalid HTTP method: ${config.method}`\n      );\n    }\n    const req = this.prepareRequest(config);\n    const response = await request.fetchAsync(req.url, req.options);\n    const resp = this.prepareResponse(config, response);\n    const log = {\n      request: req.log,\n      response: resp.log,\n      duration: resp.log.at.getTime() - req.log.at.getTime()\n    };\n    this._logs.unshift(log);\n    if (!resp.success) {\n      throw new HttpError(\n        `HTTP request failed with status ${resp.response.status}.`,\n        resp.response.status,\n        resp.response\n      );\n    }\n    return resp.response;\n  }\n  /**\n   * Performs a GET HTTP request.\n   *\n   * @param {string} url The target URL for the GET request\n   * @param {{params?: {[key: string]: string}, headers?: {[key: string]: string}, valid?: ((status: number) => boolean) | number[] | number}} [config] Optional request configuration:\n   * - `params`: Query parameters to append to the URL\n   * - `headers`: HTTP headers to include in the request\n   * - `valid`: Custom validation for HTTP status codes\n   *\n   * @returns {Promise<{status: number, data: any, headers: {[key: string]: string}}>} Promise resolving to HTTP response\n   *\n   * @example\n   * ```typescript\n   * // Simple GET request\n   * const users = await http.get(\"https://api.example.com/users\");\n   *\n   * // GET with query parameters\n   * const filtered = await http.get(\"https://api.example.com/users\", {\n   *   params: { page: \"1\", limit: \"10\" }\n   * });\n   *\n   * // GET with custom headers\n   * const data = await http.get(\"https://api.example.com/protected\", {\n   *   headers: { \"Authorization\": \"Bearer token123\" }\n   * });\n   * ```\n   */\n  async get(url, config) {\n    return this.request({ ...config, url, method: \"GET\" });\n  }\n  /**\n   * Performs a POST HTTP request.\n   *\n   * @param {string} url The target URL for the POST request\n   * @param {Record<string, any> | Array<any> | string} [body] Request body (objects/arrays are automatically JSON stringified)\n   * @param {{params?: {[key: string]: string}, headers?: {[key: string]: string}, valid?: ((status: number) => boolean) | number[] | number}} [config] Optional request configuration:\n   * - `params`: Query parameters to append to the URL\n   * - `headers`: HTTP headers to include in the request\n   * - `valid`: Custom validation for HTTP status codes\n   *\n   * @returns {Promise<{status: number, data: any, headers: {[key: string]: string}}>} Promise resolving to HTTP response\n   *\n   * @example\n   * ```typescript\n   * // POST with JSON body\n   * const user = await http.post(\"https://api.example.com/users\", {\n   *   name: \"John Doe\",\n   *   email: \"john@example.com\"\n   * });\n   *\n   * // POST with custom headers\n   * const result = await http.post(\"https://api.example.com/data\", formData, {\n   *   headers: { \"Authorization\": \"Bearer token123\" }\n   * });\n   *\n   * // POST with string body\n   * const response = await http.post(\"https://api.example.com/webhook\", xmlData, {\n   *   headers: { \"Content-Type\": \"application/xml\" }\n   * });\n   * ```\n   */\n  async post(url, body, config) {\n    return this.request({ ...config, url, method: \"POST\", body });\n  }\n  /**\n   * Performs a PUT HTTP request.\n   *\n   * @param {string} url The target URL for the PUT request\n   * @param {Record<string, any> | Array<any> | string} [body] Request body (objects/arrays are automatically JSON stringified)\n   * @param {{params?: {[key: string]: string}, headers?: {[key: string]: string}, valid?: ((status: number) => boolean) | number[] | number}} [config] Optional request configuration:\n   * - `params`: Query parameters to append to the URL\n   * - `headers`: HTTP headers to include in the request\n   * - `valid`: Custom validation for HTTP status codes\n   *\n   * @returns {Promise<{status: number, data: any, headers: {[key: string]: string}}>} Promise resolving to HTTP response\n   *\n   * @example\n   * ```typescript\n   * // PUT to update a resource\n   * const updatedUser = await http.put(\"https://api.example.com/users/123\", {\n   *   name: \"Jane Doe\",\n   *   email: \"jane@example.com\"\n   * });\n   *\n   * // PUT with authorization\n   * const result = await http.put(\"https://api.example.com/settings\", settings, {\n   *   headers: { \"Authorization\": \"Bearer token123\" }\n   * });\n   * ```\n   */\n  async put(url, body, config) {\n    return this.request({ ...config, url, method: \"PUT\", body });\n  }\n  /**\n   * Performs a DELETE HTTP request.\n   *\n   * @param {string} url The target URL for the DELETE request\n   * @param {{params?: {[key: string]: string}, headers?: {[key: string]: string}, valid?: ((status: number) => boolean) | number[] | number}} [config] Optional request configuration:\n   * - `params`: Query parameters to append to the URL\n   * - `headers`: HTTP headers to include in the request\n   * - `valid`: Custom validation for HTTP status codes\n   *\n   * @returns {Promise<{status: number, data: any, headers: {[key: string]: string}}>} Promise resolving to HTTP response\n   *\n   * @example\n   * ```typescript\n   * // DELETE a resource\n   * await http.delete(\"https://api.example.com/users/123\");\n   *\n   * // DELETE with authorization\n   * await http.delete(\"https://api.example.com/posts/456\", {\n   *   headers: { \"Authorization\": \"Bearer token123\" }\n   * });\n   *\n   * // DELETE with query parameters\n   * await http.delete(\"https://api.example.com/cache\", {\n   *   params: { type: \"user\", id: \"123\" }\n   * });\n   * ```\n   */\n  async delete(url, config) {\n    return this.request({ ...config, url, method: \"DELETE\" });\n  }\n  /**\n   * Performs a PATCH HTTP request.\n   *\n   * @param {string} url The target URL for the PATCH request\n   * @param {Record<string, any> | Array<any> | string} [body] Request body (objects/arrays are automatically JSON stringified)\n   * @param {{params?: {[key: string]: string}, headers?: {[key: string]: string}, valid?: ((status: number) => boolean) | number[] | number}} [config] Optional request configuration:\n   * - `params`: Query parameters to append to the URL\n   * - `headers`: HTTP headers to include in the request\n   * - `valid`: Custom validation for HTTP status codes\n   *\n   * @returns {Promise<{status: number, data: any, headers: {[key: string]: string}}>} Promise resolving to HTTP response\n   *\n   * @example\n   * ```typescript\n   * // PATCH to partially update a resource\n   * const updatedUser = await http.patch(\"https://api.example.com/users/123\", {\n   *   email: \"newemail@example.com\"\n   * });\n   *\n   * // PATCH with authorization\n   * const result = await http.patch(\"https://api.example.com/profile\", changes, {\n   *   headers: { \"Authorization\": \"Bearer token123\" }\n   * });\n   * ```\n   */\n  async patch(url, body, config) {\n    return this.request({ ...config, url, method: \"PATCH\", body });\n  }\n  prepareRequest(config) {\n    const createQueryString = (params2 = {}) => {\n      const pairs = [];\n      for (const [key, value] of Object.entries(params2)) {\n        if (value !== undefined && value !== null) {\n          const encodedKey = encodeURIComponent(key);\n          const encodedValue = encodeURIComponent(String(value));\n          pairs.push(`${encodedKey}=${encodedValue}`);\n        }\n      }\n      return pairs.join(\"&\");\n    };\n    const params = createQueryString(config.params || {});\n    const method = config.method || \"GET\";\n    const headers = config.headers || {};\n    let length = 0;\n    let body = config.body || null;\n    if (body && typeof body === \"object\") {\n      body = JSON.stringify(body);\n      headers[\"Content-Type\"] = \"application/json\";\n    }\n    if (body && typeof body === \"string\") {\n      length = body.length;\n    }\n    let url = config.url;\n    if (params !== \"\") url += `?${params}`;\n    let options = {\n      method,\n      headers,\n      body\n    };\n    const log = {\n      at: new Date(),\n      url,\n      method: method || \"GET\",\n      headers: headers || {},\n      length\n    };\n    return { url, options, log };\n  }\n  prepareResponse(config, resp) {\n    const { status } = resp;\n    let headers = {};\n    for (const header of resp.headers) {\n      const key = header.key;\n      const values = header.value;\n      if (values.length > 0) {\n        headers[key] = values[0];\n      }\n    }\n    const length = headers[\"content-length\"] ? parseInt(headers[\"content-length\"], 10) : resp.body ? resp.body.length : 0;\n    let data = null;\n    try {\n      data = JSON.parse(resp.body);\n    } catch (err) {\n      data = resp.body;\n    }\n    let valid = (status2) => status2 >= 200 && status2 < 300;\n    if (config.valid) {\n      if (Array.isArray(config.valid)) {\n        const expectedSet = new Set(config.valid);\n        valid = (status2) => expectedSet.has(status2);\n      } else if (typeof config.valid === \"number\") {\n        const expectedNumber = config.valid;\n        valid = (status2) => status2 === expectedNumber;\n      } else if (typeof config.valid === \"function\") {\n        valid = config.valid;\n      }\n    }\n    const success = valid(status);\n    let reduce = (raw) => {\n      let body = \"\";\n      try {\n        if (typeof raw !== \"object\") {\n          throw new Error(\"Not an object\");\n        }\n        body = JSON.stringify(raw);\n      } catch (err) {\n        body = String(raw);\n      }\n      let reduced = false;\n      if (body.length > 1e3) {\n        body = body.substring(0, 1e3) + \"...(truncated)\";\n        reduced = true;\n      }\n      return { body, reduced };\n    };\n    const log = {\n      at: new Date(),\n      status,\n      length,\n      success,\n      ...reduce(resp.body)\n    };\n    const response = {\n      status,\n      data,\n      headers\n    };\n    return { response, log, success };\n  }\n};\nvar http = new HttpClient();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"a2731e4e\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n\n\nasync function dwnCompleteScript(id, fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n    if (!id && (console._logs.length > 0 || http._logs.length > 0)) {\n      throw new DwnError(\n        \"MISCONFIGURATION_ERROR\",\n        \"Script must have an ID to capture logs.\"\n      );\n    }\n  } catch (err) {\n    if (err instanceof HttpError) {\n      const description = `[${id}] HTTP request failed with status ${err.status}.`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"HTTP_ERROR\", description, {\n        code: `S-${err.status}`,\n        stack,\n        goto: null\n      });\n    } else if (!(err instanceof DwnError)) {\n      const description = `[${id}] Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    if (id) {\n      await dwnCompleteFlush(id);\n      await dwnBasicFlush();\n    }\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnCompleteFlush(id) {\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  let config = {};\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const { datetime } = formatDate(new Date(), config);\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { time } = formatDate(date, config);\n    return `[${time}](${level}) ${message}`;\n  });\n  const _http = http._logs.map((log) => log);\n  const data = { datetime, logs: _logs, http: _http };\n  await context.setVariableAsync(\n    `${\"dwnScript\"}-${id}`,\n    JSON.stringify(data)\n  );\n}\n",
                        "inputVariables": [
                            "dwn"
                        ],
                        "outputVariable": "setDataBank",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                }
            ],
            "id": "e398983e-1808-4c55-8c96-68bcf281a6dd",
            "root": false,
            "$title": "[API] Atualiza√ß√£o dados banc√°rios",
            "$position": {
                "top": "1925px",
                "left": "5275px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "199722a1-d045-499e-a2d1-1ea54de0660c": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "1f2406bb-7b34-4e93-bcda-ca631f4e5e42",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "57af017c-7929-407a-8023-08553d8d403f",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "57af017c-7929-407a-8023-08553d8d403f",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "ba45c59d-0962-44b0-9cbd-cfa98d0f03a2",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "267659f4-312a-4547-86cd-a2c761b33e7a",
                            "type": "text/plain",
                            "content": "Certo, anotei aqui os seus dados, agrade√ßo pelo envio. üòâ",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "267659f4-312a-4547-86cd-a2c761b33e7a",
                                "type": "text/plain",
                                "content": "Certo, anotei aqui os seus dados, agrade√ßo pelo envio. üòâ"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "ce74d82c-31bc-494d-8ca5-09968d5005c4",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#b229c0f2-4a88-4593-876d-cc65d8ce74b3",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "2eb179bd-7ffc-4418-a516-04f75913e468",
                    "typeOfStateId": "state",
                    "$connId": "con_408",
                    "$id": "5c6e967c-a71e-420f-8e70-ffca4a0d5b73",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "199722a1-d045-499e-a2d1-1ea54de0660c",
            "root": false,
            "$title": "[Msg] Dados banc√°rios atualizados",
            "$position": {
                "top": "2215px",
                "left": "5407px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "1089f29b-39f9-4ec0-b891-4d024e26ce9b": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuBancoPagamentoBuild@type}}",
                            "rawContent": "{{menuBancoPagamentoBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#2108f2d6-6d51-4b8e-9991-1112a24baff5",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "6d0abde8-797e-4af3-8ccf-fbe81c39eab2",
                    "typeOfStateId": "state",
                    "$connId": "con_413",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Banco Neon",
                                "Receber na Neon"
                            ],
                            "variable": "menuBancoPagamentoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "b34272eb-fd25-4f3f-99fb-a215d5bafa48",
                    "typeOfStateId": "state",
                    "$connId": "con_418",
                    "$id": "291ca451-0cb6-4f03-b7df-c7322abe62ba",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Outro banco"
                            ],
                            "variable": "menuBancoPagamentoEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "c14a01bb-9db0-47b3-a9ae-6dae49c5f74b",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare - Checkpoint",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-banco-para-pagamento\",\n    checkpoint: true,\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"cdf026f6\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuBancoPagamentoOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Receber na Neon\",\n\t\ttitle: \"Receber na Neon\", // At√© 24 caracteres\n\t\ttitleShort: `Receber na Neon`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Outro banco\",\n\t\ttitle: \"Outro banco\", // At√© 24 caracteres\n\t\ttitleShort: `Outro banco`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Voltar\",\n\t\ttitle: \"Voltar\", // At√© 24 caracteres\n\t\ttitleShort: `Voltar`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuBancoPagamentoOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuBancoPagamentoBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Para receber seu pagamento P4P, escolha uma das op√ß√µes abaixo:\n-\tBanco Neon: j√° temos seus dados, s√≥ vamos confirmar se est√£o corretos.\n-\tOutro banco: precisaremos que informe seus dados para atualiza√ß√£o no sistema.`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuBancoPagamentoOptions"
                        ],
                        "outputVariable": "menuBancoPagamentoBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuBancoPagamentoEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuBancoPagamentoOptions"
                        ],
                        "outputVariable": "menuBancoPagamentoEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuBancoPagamentoEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuBancoPagamentoEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuBancoPagamentoEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuBancoPagamentoEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuBancoPagamentoEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "1089f29b-39f9-4ec0-b891-4d024e26ce9b",
            "root": false,
            "$title": "[Menu] Banco para pagamento",
            "$position": {
                "top": "1481px",
                "left": "5424px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "6d0abde8-797e-4af3-8ccf-fbe81c39eab2": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "38fcedec-5af4-407d-b7ef-1bacf1402a21",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#2108f2d6-6d51-4b8e-9991-1112a24baff5",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "7016f674-b59b-4afb-b790-8009910d2c6b",
                    "typeOfStateId": "state",
                    "$connId": "con_423",
                    "$id": "f760d4d8-5253-4565-8835-4efcfa5aba19",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "b08d6dc3-c902-47fc-bdd9-bc0a8245b0a8",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET_V2 'jsonDadosBancariosNeon'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(empresaId, matricula) {\n    try {\n            const body = buildBodyRequest(empresaId, matricula);\n            const response = await requestLG(body);\n            \n            // SET RESPONSE ON CONTEXT\n            await context.setVariableAsync('responseConsultaDadosBancarios', response);\n\n            const responseFormatted = XMLConvert(response.data);\n\n\n        return responseFormatted;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v2/ServicoDeContratoDeTrabalho`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v2/ServicoDeContratoDeTrabalho/ConsultarDadosBancarios`\n    }\n    const BODY = body;\n\n    // SET BODY ON CONTEXT\n    await context.setVariableAsync('corpoConsultaDadosBancarios', BODY);\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n\n        return {\n            success: isSuccessStatus(response.status),\n            status: response.status,\n            data: tryParseJson(response.body)\n        }\n    } catch (error) {\n        return {\n            error: true,\n            message: error.message || \"Erro inesperado\"\n        }\n    }\n}\n\nfunction isSuccessStatus(status) {\n    if (!status) {\n        return false;\n    }\n\n    return status >= 200 && status < 300;\n}\n\nfunction tryParseJson(response) {\n    try {\n        return JSON.parse(response);\n    } catch (error) {\n        return response;\n    }\n}\n\nfunction buildBodyRequest(empresaId, matricula) {\n    try {\n\n        return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v2=\"lg.com.br/api/v2\" \n    xmlns:v1=\"lg.com.br/api/dto/v1\">\n\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      \n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n   <soapenv:Body>\n        <v2:ConsultarDadosBancarios>\n            <v2:filtro>\n                <v1:Colaborador>\n                    <v1:Empresa>\n                        <v1:Codigo>${empresaId}</v1:Codigo>\n                    </v1:Empresa>\n                    <v1:Matricula>${matricula}</v1:Matricula>\n                </v1:Colaborador>\n            </v2:filtro>\n        </v2:ConsultarDadosBancarios>\n    </soapenv:Body>\n\n    </soapenv:Envelope>`;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    try {\n        let obj = {};\n        let tagStack = [];\n        let currentNode = obj;\n\n        // Regex patterns for XML parsing\n        const tagPattern = /<([^>]+)>/g;\n        let match;\n        let lastIndex = 0;\n\n        while ((match = tagPattern.exec(xml)) !== null) {\n            const tagContent = match[1];\n            const isEndTag = tagContent[0] === '/';\n\n            const textContent = xml.substring(lastIndex, match.index).trim();\n            if (textContent && tagStack.length > 0) {\n                const parentNode = tagStack[tagStack.length - 1];\n                if (!parentNode[\"_text\"]) {\n                    parentNode[\"_text\"] = textContent;\n                } else if (typeof parentNode[\"_text\"] === \"string\") {\n                    parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n                } else {\n                    parentNode[\"_text\"].push(textContent);\n                }\n            }\n\n            lastIndex = match.index + match[0].length;\n\n            if (isEndTag) {\n                tagStack.pop();\n                currentNode = tagStack[tagStack.length - 1] || obj;\n            } else {\n                const tagParts = tagContent.split(' ');\n                const tagName = tagParts[0];\n                const newNode = {};\n\n                if (currentNode[tagName] === undefined) {\n                    currentNode[tagName] = newNode;\n                } else if (Array.isArray(currentNode[tagName])) {\n                    currentNode[tagName].push(newNode);\n                } else {\n                    currentNode[tagName] = [currentNode[tagName], newNode];\n                }\n\n                if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                    tagStack.push(newNode);\n                    currentNode = newNode;\n                }\n            }\n        }\n\n        // Clean up _text keys\n        function cleanUp(obj) {\n            for (let key in obj) {\n                if (obj[key] && typeof obj[key] === \"object\") {\n                    if (obj[key]._text) {\n                        if (Object.keys(obj[key]).length === 1) {\n                            obj[key] = obj[key]._text;\n                        } else {\n                            obj[key].textValue = obj[key]._text;\n                            delete obj[key]._text;\n                        }\n                    } else if (Object.values(obj[key]).length === 0) {\n                        delete obj[key];\n                    }\n                    cleanUp(obj[key]);\n                }\n            }\n        }\n\n        cleanUp(obj);\n\n        return obj['s:Envelope']['s:Body'].ConsultarDadosBancariosResponse.ConsultarDadosBancariosResult['a:Retorno']\n    } catch (error) {\n        return false\n    }\n}",
                        "inputVariables": [
                            "contact.extras.empresaId",
                            "contact.extras.matricula"
                        ],
                        "outputVariable": "jsonDadosBancariosNeon",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "6d0abde8-797e-4af3-8ccf-fbe81c39eab2",
            "root": false,
            "$title": "[API] Busca dados banc√°rios Neon",
            "$position": {
                "top": "1757px",
                "left": "5568px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "7016f674-b59b-4afb-b790-8009910d2c6b": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuDadosBancariosNeonBuild@type}}",
                            "rawContent": "{{menuDadosBancariosNeonBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#2108f2d6-6d51-4b8e-9991-1112a24baff5",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "199722a1-d045-499e-a2d1-1ea54de0660c",
                    "typeOfStateId": "state",
                    "$connId": "con_428",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Receber nessa conta"
                            ],
                            "variable": "menuDadosBancariosNeonEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "2eb179bd-7ffc-4418-a516-04f75913e468",
                    "typeOfStateId": "state",
                    "$connId": "con_433",
                    "$id": "d32777b6-96d4-44bc-9a4b-899e71e85015",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Encerrar atendimento"
                            ],
                            "variable": "menuDadosBancariosNeonEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "58b89705-d16b-4a5b-9d32-cf48881b08a7",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'messageDadosBancariosNeon'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(response) {\n    try {\n        response = response.replace(/a\\:/g, '');\n        const { Agencia, Banco, Conta, Digito } = JSON.parse(response);\n        \n        return `Encontrei seus dados da conta Neon: üòâ\n\n*Cr√©dito em conta-corrente*\n\n*Banco*: ${Banco.Codigo} - NEON PAGAMENTOS\n*Ag√™ncia*: ${Agencia.Codigo}\n*Conta*: ${Conta}-${Digito}`\n    } catch (error) {\n        return error.message;\n    }\n}",
                        "inputVariables": [
                            "jsonDadosBancariosNeon"
                        ],
                        "outputVariable": "messageDadosBancariosNeon",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuDadosBancariosNeonOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Receber nessa conta\",\n\t\ttitle: \"Receber nessa conta\", // At√© 24 caracteres\n\t\ttitleShort: `Receber nessa conta`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Voltar\",\n\t\ttitle: \"Voltar\", // At√© 24 caracteres\n\t\ttitleShort: `Voltar`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Encerrar atendimento\",\n\t\ttitle: \"Encerrar atendimento\", // At√© 24 caracteres\n\t\ttitleShort: `Encerrar atendimento`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  }\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuDadosBancariosNeonOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuDadosBancariosNeonBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options, messageDadosBancariosNeon) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = messageDadosBancariosNeon;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuDadosBancariosNeonOptions",
                            "messageDadosBancariosNeon"
                        ],
                        "outputVariable": "menuDadosBancariosNeonBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuDadosBancariosNeonEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuDadosBancariosNeonOptions"
                        ],
                        "outputVariable": "menuDadosBancariosNeonEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuDadosBancariosNeonEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuDadosBancariosNeonEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuDadosBancariosNeonEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuDadosBancariosNeonEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuDadosBancariosNeonEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "7016f674-b59b-4afb-b790-8009910d2c6b",
            "root": false,
            "$title": "[Menu] Dados banc√°rios Neon",
            "$position": {
                "top": "1916px",
                "left": "5568px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "2eb179bd-7ffc-4418-a516-04f75913e468": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "131e408a-2462-4b2d-a972-f4f205cb136e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#2108f2d6-6d51-4b8e-9991-1112a24baff5",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "72cfd94e-b775-428c-9a2d-d1df0fdb83a5",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'algoMaisTransbordo' to true",
                    "$invalid": false,
                    "settings": {
                        "variable": "algoMaisTransbordo",
                        "value": "true"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "32e5f224-1cf3-4733-a916-dfe04b984054",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "2eb179bd-7ffc-4418-a516-04f75913e468",
            "root": false,
            "$title": "[GO TO] Algo mais",
            "$position": {
                "top": "2370px",
                "left": "5597px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "ca14f1e2-85d0-4baa-bd19-75d5c44cc9ac": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "6d325296-2fd4-4cc3-a42e-96b6c10e2f8a",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#a1bbaeaf-0f2f-4449-b263-5bcb95a32e7e",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "83a2b248-307a-42b3-8eac-350af7ab2c4a",
                    "typeOfStateId": "state",
                    "$connId": "con_438",
                    "$id": "a263736f-8bcc-4f2b-b69e-f1e3397c15c2",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "bbeae915-4e13-4ce7-be76-10dd442badef",
                    "$typeOfContent": "",
                    "type": "ProcessCommand",
                    "$title": "[DWNT] Delete 'boolSociedade'",
                    "settings": {
                        "to": "postmaster@msging.net",
                        "method": "delete",
                        "uri": "/contexts/{{contact.identity}}/boolSociedade",
                        "variable": "boolSociedadeDeleteCmdResp"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "boolSociedade"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "8a02ddc2-c331-4efa-8ac0-deae67a03191",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET_V2 'boolSociedade'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(empresaId, matricula) {\n    try {\n        const body = buildBodyRequest(empresaId, matricula);\n        const response = await requestLG(body);\n\n        // SET RESPONSE ON CONTEXT\n        await context.setVariableAsync('responseConsultaSociedade', response);\n\n        const responseFormatted = XMLConvert(response.data);\n\n        return responseFormatted.find(item => item['a:Codigo'] === '133')['a:Valor'] === 'S';\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v2/ServicoDeContratoDeTrabalho`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v2/ServicoDeContratoDeTrabalho/ConsultarListaValorDaInformacaoAdicional`\n    }\n    const BODY = body;\n\n    // SET BODY ON CONTEXT\n    await context.setVariableAsync('corpoConsultaSociedade', BODY);\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n\n        return {\n            success: isSuccessStatus(response.status),\n            status: response.status,\n            data: tryParseJson(response.body)\n        }\n    } catch (error) {\n        return {\n            error: true,\n            message: error.message || \"Erro inesperado\"\n        }\n    }\n}\n\nfunction isSuccessStatus(status) {\n    if (!status) {\n        return false;\n    }\n\n    return status >= 200 && status < 300;\n}\n\nfunction tryParseJson(response) {\n    try {\n        return JSON.parse(response);\n    } catch (error) {\n        return response;\n    }\n}\n\nfunction buildBodyRequest(empresaId, matricula) {\n    try {\n\n        return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v2=\"lg.com.br/api/v2\" \n    xmlns:v1=\"lg.com.br/api/dto/v1\">\n\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      \n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n   <soapenv:Body>\n        <v2:ConsultarListaValorDaInformacaoAdicional>\n            <v2:filtro>\n                <v1:Colaborador>\n                    <v1:Empresa>\n                        <v1:Codigo>${empresaId}</v1:Codigo>\n                    </v1:Empresa>\n                    <v1:Matricula>${matricula}</v1:Matricula>\n                </v1:Colaborador>\n            </v2:filtro>\n        </v2:ConsultarListaValorDaInformacaoAdicional>\n    </soapenv:Body>\n\n    </soapenv:Envelope>`;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n\n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n\n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n\n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n    return obj\n    ['s:Envelope']\n    ['s:Body']\n    [\"ConsultarListaValorDaInformacaoAdicionalResponse\"]\n    [\"ConsultarListaValorDaInformacaoAdicionalResult\"]\n    ['a:Retorno']\n    ['a:ValorDaInformacaoAdicional']\n}",
                        "inputVariables": [
                            "contact.extras.empresaId",
                            "contact.extras.matricula"
                        ],
                        "outputVariable": "boolSociedade",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "15f438f4-3c5e-4721-8d3b-dce9a74601d0",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "RETRY SET_V2 'boolSociedade'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(empresaId, matricula) {\n    try {\n        const body = buildBodyRequest(empresaId, matricula);\n        const response = await requestLG(body);\n\n        // SET RESPONSE ON CONTEXT\n        await context.setVariableAsync('responseConsultaSociedade', response);\n\n        const responseFormatted = XMLConvert(response.data);\n\n        return responseFormatted.find(item => item['a:Codigo'] === '133')['a:Valor'] === 'S';\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v2/ServicoDeContratoDeTrabalho`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v2/ServicoDeContratoDeTrabalho/ConsultarListaValorDaInformacaoAdicional`\n    }\n    const BODY = body;\n\n    // SET BODY ON CONTEXT\n    await context.setVariableAsync('corpoConsultaSociedade', BODY);\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n\n        return {\n            success: isSuccessStatus(response.status),\n            status: response.status,\n            data: tryParseJson(response.body)\n        }\n    } catch (error) {\n        return {\n            error: true,\n            message: error.message || \"Erro inesperado\"\n        }\n    }\n}\n\nfunction isSuccessStatus(status) {\n    if (!status) {\n        return false;\n    }\n\n    return status >= 200 && status < 300;\n}\n\nfunction tryParseJson(response) {\n    try {\n        return JSON.parse(response);\n    } catch (error) {\n        return response;\n    }\n}\n\nfunction buildBodyRequest(empresaId, matricula) {\n    try {\n\n        return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v2=\"lg.com.br/api/v2\" \n    xmlns:v1=\"lg.com.br/api/dto/v1\">\n\n   <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n      \n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n   <soapenv:Body>\n        <v2:ConsultarListaValorDaInformacaoAdicional>\n            <v2:filtro>\n                <v1:Colaborador>\n                    <v1:Empresa>\n                        <v1:Codigo>${empresaId}</v1:Codigo>\n                    </v1:Empresa>\n                    <v1:Matricula>${matricula}</v1:Matricula>\n                </v1:Colaborador>\n            </v2:filtro>\n        </v2:ConsultarListaValorDaInformacaoAdicional>\n    </soapenv:Body>\n\n    </soapenv:Envelope>`;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n\n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n\n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n\n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n    return obj\n    ['s:Envelope']\n    ['s:Body']\n    [\"ConsultarListaValorDaInformacaoAdicionalResponse\"]\n    [\"ConsultarListaValorDaInformacaoAdicionalResult\"]\n    ['a:Retorno']\n    ['a:ValorDaInformacaoAdicional']\n}",
                        "inputVariables": [
                            "contact.extras.empresaId",
                            "contact.extras.matricula"
                        ],
                        "outputVariable": "boolSociedade",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "source": "context",
                            "comparison": "notExists",
                            "values": [],
                            "variable": "boolSociedade"
                        }
                    ]
                },
                {
                    "$id": "b4aa5da1-19e6-47c5-b3fe-0ac5cab20c5a",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Definir Time to 'Sociedade'",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "Time": "Sociedade"
                        }
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                }
            ],
            "id": "ca14f1e2-85d0-4baa-bd19-75d5c44cc9ac",
            "root": false,
            "$title": "[API] Busca sociedade",
            "$position": {
                "top": "1494px",
                "left": "4203px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "ffdf562f-2c3b-460d-858f-e3a5b346bcba": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "206178ca-1bbb-4585-ad68-a4c761ded85c",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#44dd8fb9-2b46-4942-8b4f-ed00b6b6b963",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "02f993a9-4786-4c01-a307-60336bd4c8a3",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "user-multiple-registrations",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "action": "{{contact.taxDocument}} | {{contact.identity}}",
                        "category": "user-multiple-registrations"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "4dae7092-0465-4c97-a618-c17afc668698",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "ffdf562f-2c3b-460d-858f-e3a5b346bcba",
            "root": false,
            "$title": "[GO TO] M√∫ltiplas matr√≠culas",
            "$position": {
                "top": "851px",
                "left": "536px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "4dae7092-0465-4c97-a618-c17afc668698": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuMultiplasMatriculasBuild@type}}",
                            "rawContent": "{{menuMultiplasMatriculasBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#44dd8fb9-2b46-4942-8b4f-ed00b6b6b963",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "9a190f49-8c82-4bc8-b8ce-f5ab6e9d3c8f",
                    "typeOfStateId": "state",
                    "$connId": "con_443",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "notEquals",
                            "values": [
                                "inv√°lido"
                            ],
                            "variable": "menuMultiplasMatriculasEscolha"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "560a967c-0feb-41bf-959e-50148d0ae626",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'listaMatriculas'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(xml) {\n\tlet obj = {};\n\tlet tagStack = [];\n\tlet currentNode = obj;\n\n\t// Regex patterns for XML parsing\n\tconst tagPattern = /<([^>]+)>/g;\n\tlet match;\n\tlet lastIndex = 0;\n\n\twhile ((match = tagPattern.exec(xml)) !== null) {\n\t\tconst tagContent = match[1];\n\t\tconst isEndTag = tagContent[0] === '/';\n\n\t\tconst textContent = xml.substring(lastIndex, match.index).trim();\n\t\tif (textContent && tagStack.length > 0) {\n\t\t\tconst parentNode = tagStack[tagStack.length - 1];\n\t\t\tif (!parentNode[\"_text\"]) {\n\t\t\t\tparentNode[\"_text\"] = textContent;\n\t\t\t} else if (typeof parentNode[\"_text\"] === \"string\") {\n\t\t\t\tparentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n\t\t\t} else {\n\t\t\t\tparentNode[\"_text\"].push(textContent);\n\t\t\t}\n\t\t}\n\n\t\tlastIndex = match.index + match[0].length;\n\n\t\tif (isEndTag) {\n\t\t\ttagStack.pop();\n\t\t\tcurrentNode = tagStack[tagStack.length - 1] || obj;\n\t\t} else {\n\t\t\tconst tagParts = tagContent.split(' ');\n\t\t\tconst tagName = tagParts[0];\n\t\t\tconst newNode = {};\n\n\t\t\tif (currentNode[tagName] === undefined) {\n\t\t\t\tcurrentNode[tagName] = newNode;\n\t\t\t} else if (Array.isArray(currentNode[tagName])) {\n\t\t\t\tcurrentNode[tagName].push(newNode);\n\t\t\t} else {\n\t\t\t\tcurrentNode[tagName] = [currentNode[tagName], newNode];\n\t\t\t}\n\n\t\t\tif (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n\t\t\t\ttagStack.push(newNode);\n\t\t\t\tcurrentNode = newNode;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Clean up _text keys\n\tfunction cleanUp(obj) {\n\t\tfor (let key in obj) {\n\t\t\tif (obj[key] && typeof obj[key] === \"object\") {\n\t\t\t\tif (obj[key]._text) {\n\t\t\t\t\tif (Object.keys(obj[key]).length === 1) {\n\t\t\t\t\t\tobj[key] = obj[key]._text;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj[key].textValue = obj[key]._text;\n\t\t\t\t\t\tdelete obj[key]._text;\n\t\t\t\t\t}\n\t\t\t\t} else if (Object.values(obj[key]).length === 0) {\n\t\t\t\t\tdelete obj[key];\n\t\t\t\t}\n\t\t\t\tcleanUp(obj[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcleanUp(obj);\n\n\tconst json = obj\n\t['s:Envelope']\n\t['s:Body']\n\t[\"ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfilResponse\"]\n\t[\"ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfilResult\"]\n\t['a:Retorno']\n\t['a:ContratosDeTrabalho']\n\t['a:ContratoDeTrabalhoV3']\n\n\treturn filtraListaMatriculas(json);\n}\n\nfunction filtraListaMatriculas(json) {\n\ttry {\n\n\t\tconst listaAtividades = returnCodigosAfastamento();\n\n\t\treturn atividadesFiltradas = json.filter(matricula =>\n\t\t\tlistaAtividades.some(atividade => atividade.codigoSituacao == matricula['a:DadosGerais']['a:Situacao']['a:Codigo'])\n\t\t)\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}\n\nfunction returnCodigosAfastamento() {\n\treturn [\n\t\t{\n\t\t\t\"codigoSituacao\": 1,\n\t\t\t\"descricao\": \"ATIVIDADE NORMAL\",\n\t\t\t\"codigoTipoSituacao\": 2,\n\t\t\t\"tipoSituacao\": \"Atividade Normal\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 2,\n\t\t\t\"descricao\": \"AF ACID TRAB ACIMA PRAZO LEGAL\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 3,\n\t\t\t\"descricao\": \"AF DOENCA ACIMA PRAZO LEGAL\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 4,\n\t\t\t\"descricao\": \"AF LIC MATERNIDADE\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 5,\n\t\t\t\"descricao\": \"AF SERVICO MILITAR\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 6,\n\t\t\t\"descricao\": \"AF SEM BENEFICIO\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 7,\n\t\t\t\"descricao\": \"FERIAS NOR AD 13 SAL/AB PECUN\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 8,\n\t\t\t\"descricao\": \"FERIAS NOR AD 13 SAL\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 9,\n\t\t\t\"descricao\": \"FERIAS NOR\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 10,\n\t\t\t\"descricao\": \"FERIAS NOR AB PECUN\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 11,\n\t\t\t\"descricao\": \"FERIAS COL AD 13 SAL/AB PECUN\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 12,\n\t\t\t\"descricao\": \"FERIAS COL AD 13 SAL\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 13,\n\t\t\t\"descricao\": \"FERIAS COL\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 14,\n\t\t\t\"descricao\": \"FERIAS COL AB PECUN\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 15,\n\t\t\t\"descricao\": \"RESC PEDIDO DEMISS NA EXP\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 16,\n\t\t\t\"descricao\": \"RESC PEDIDO DEMISS AVISO IND\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 17,\n\t\t\t\"descricao\": \"RESC PEDIDO DEMISS AVISO TRAB\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 18,\n\t\t\t\"descricao\": \"RESC TER CON NA EXPERIENCIA\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 19,\n\t\t\t\"descricao\": \"RESC DEMIS NA EXPERIENCIA\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 20,\n\t\t\t\"descricao\": \"RESC DEMIS S/ JC AVISO IND\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 21,\n\t\t\t\"descricao\": \"RESC DEMIS S/ JC AVISO TRAB\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 22,\n\t\t\t\"descricao\": \"RESC DEMIS COM JUSTA CAUSA\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 23,\n\t\t\t\"descricao\": \"RESC FALECIMENTO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 24,\n\t\t\t\"descricao\": \"RESC APOSENT TEMPO SERVICO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 25,\n\t\t\t\"descricao\": \"RESC APOSENT POR INVALIDEZ\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 26,\n\t\t\t\"descricao\": \"TRANSFERENCIA C/ONUS P/CEDENTE\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 27,\n\t\t\t\"descricao\": \"TRANSFERENCIA S/ONUS P/CEDENTE\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 28,\n\t\t\t\"descricao\": \"RESC TER CON TRA APOS TEMP SER\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 29,\n\t\t\t\"descricao\": \"APOSENTADORIA ACID TRABALHO\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 30,\n\t\t\t\"descricao\": \"APOSENTADORIA EXCETO DOE/AC TR\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 31,\n\t\t\t\"descricao\": \"APOSENTADORIA DOENCA/PROFIS\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 32,\n\t\t\t\"descricao\": \"AF LICENCA REMUNERADA\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 33,\n\t\t\t\"descricao\": \"ATIVIDADE NORMAL ESTAGIARIO\",\n\t\t\t\"codigoTipoSituacao\": 2,\n\t\t\t\"tipoSituacao\": \"Atividade Normal\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 34,\n\t\t\t\"descricao\": \"AF LIC PATERNIDADE\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 35,\n\t\t\t\"descricao\": \"AF ACID TRAB ATE O PRAZO LEGAL\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 36,\n\t\t\t\"descricao\": \"ATIVIDADE NORMAL PRO LABORE\",\n\t\t\t\"codigoTipoSituacao\": 2,\n\t\t\t\"tipoSituacao\": \"Atividade Normal\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 37,\n\t\t\t\"descricao\": \"AF DOENCA ATE O PRAZO LEGAL\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 38,\n\t\t\t\"descricao\": \"RESC APOSENT POR IDADE\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 39,\n\t\t\t\"descricao\": \"RESCISAO  ESTAGIARIO EXTINCAO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 40,\n\t\t\t\"descricao\": \"RESCISAO  ESTAGIARIO DISPENSA\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 41,\n\t\t\t\"descricao\": \"RESCISAO  ESTAGIARIO PEDIDO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 42,\n\t\t\t\"descricao\": \"AF LIC MATERNIDADE PRORROG\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 43,\n\t\t\t\"descricao\": \"AF OUTROS MOTIVOS\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 44,\n\t\t\t\"descricao\": \"ESTAGIARIO EM RECESSO\",\n\t\t\t\"codigoTipoSituacao\": 4,\n\t\t\t\"tipoSituacao\": \"Recesso\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 45,\n\t\t\t\"descricao\": \"AF LICENCA NAO REMUNERADA\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 46,\n\t\t\t\"descricao\": \"AF EXPATRIADO COM FGTS\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 47,\n\t\t\t\"descricao\": \"GESTANTE DESLOCADA AMBIENTE INSALUBRE\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 48,\n\t\t\t\"descricao\": \"AF OUTROS MOTIVOS ( MIGRA√á√ÉO)\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 50,\n\t\t\t\"descricao\": \"ATIVIDADE NORMAL VINCULO INTERMITENTE\",\n\t\t\t\"codigoTipoSituacao\": 2,\n\t\t\t\"tipoSituacao\": \"Atividade Normal\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 51,\n\t\t\t\"descricao\": \"FERIAS VINCULO INTERMITENTE\",\n\t\t\t\"codigoTipoSituacao\": 3,\n\t\t\t\"tipoSituacao\": \"F√©rias\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 52,\n\t\t\t\"descricao\": \"RESC VINCULO INTERMITENTE DEMISSAO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 53,\n\t\t\t\"descricao\": \"RESC VINCULO INTERMITENTE PEDIDO DEMISSAO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 54,\n\t\t\t\"descricao\": \"RESC VINCULO INTERMITENTE TERMINO CONTRATO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 79,\n\t\t\t\"descricao\": \"ATIVIDADE NORMAL APRENDIZ\",\n\t\t\t\"codigoTipoSituacao\": 2,\n\t\t\t\"tipoSituacao\": \"Atividade Normal\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 80,\n\t\t\t\"descricao\": \"AF LIC MATERNIDADE EMP CIDADA\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 81,\n\t\t\t\"descricao\": \"RESCISAO PRO LABORE\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 82,\n\t\t\t\"descricao\": \"RESC TER CON MENOR APRENDIZ\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 83,\n\t\t\t\"descricao\": \"AF SUSPENSAO CONTR TRABALHO\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 84,\n\t\t\t\"descricao\": \"AF SUSPENSAO CONTR TRABALHO LEI 14020\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 85,\n\t\t\t\"descricao\": \"AF LIC ABORTO NAO CRIMINOSO\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 86,\n\t\t\t\"descricao\": \"ATIVIDADE NORMAL DIRETOR ESTAT\",\n\t\t\t\"codigoTipoSituacao\": 2,\n\t\t\t\"tipoSituacao\": \"Atividade Normal\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 87,\n\t\t\t\"descricao\": \"ATIVIDADE NORMAL CONSELHEIRO\",\n\t\t\t\"codigoTipoSituacao\": 2,\n\t\t\t\"tipoSituacao\": \"Atividade Normal\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 88,\n\t\t\t\"descricao\": \"RESCISAO DIRETOR ESTATUTARIO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 89,\n\t\t\t\"descricao\": \"RESCISAO CONSELHEIRO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 90,\n\t\t\t\"descricao\": \"AF LIC PATERNIDADE EMP CIDADA\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 91,\n\t\t\t\"descricao\": \"RESC PEDIDO DEM C/JUSTA CAUSA\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 92,\n\t\t\t\"descricao\": \"RESC PEDIDO ANT CONTR APRENDIZ\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 93,\n\t\t\t\"descricao\": \"RESC DEMIS ANT CONTR APRENDIZ\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 94,\n\t\t\t\"descricao\": \"RESC DEMIS ANT CONTR TRABALHO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 95,\n\t\t\t\"descricao\": \"RESC TERMINO CONTR TRABALHO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 96,\n\t\t\t\"descricao\": \"RESC INDIRETA\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 97,\n\t\t\t\"descricao\": \"RESC DEMIS S/ JC PDV\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 98,\n\t\t\t\"descricao\": \"AF LIC MATERNIDADE ADOCAO\",\n\t\t\t\"codigoTipoSituacao\": 1,\n\t\t\t\"tipoSituacao\": \"Afastamento\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 99,\n\t\t\t\"descricao\": \"RESC DEMIS S/ JC MUTUO ACORDO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 100,\n\t\t\t\"descricao\": \"ATIVIDADE NORMAL AUTONOMO\",\n\t\t\t\"codigoTipoSituacao\": 2,\n\t\t\t\"tipoSituacao\": \"Atividade Normal\"\n\t\t},\n\t\t{\n\t\t\t\"codigoSituacao\": 101,\n\t\t\t\"descricao\": \"VINCULO AUTONOMO INATIVO\",\n\t\t\t\"codigoTipoSituacao\": 5,\n\t\t\t\"tipoSituacao\": \"Rescis√£o\"\n\t\t}\n\t]\n}",
                        "inputVariables": [
                            "responseBuscaColaborador"
                        ],
                        "outputVariable": "listaMatriculas"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMultiplasMatriculasOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(listaMatriculas) {\n\ttry {\n\n\t\tconst allOptions = JSON.parse(listaMatriculas).map(item => ({\n\t\t\tid: item['a:DadosGerais']['a:Matricula'],\n\t\t\ttitle: `Matr√≠cula: ${item['a:DadosGerais']['a:Matricula']}`, // At√© 24 caracteres\n\t\t\ttitleShort: `Matr√≠cula: ${item['a:DadosGerais']['a:Matricula']}`, // At√© 20 caracteres\n\t\t\tdescription: `Cargo: ${item['a:Alocacao']['a:CargoEFuncaoEfetivo']['a:Cargo']['a:Descricao']}`,\n\t\t\tactive: true,\n\t\t}))\n\n\t\treturn allOptions.filter(item => item.active);\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}",
                        "inputVariables": [
                            "listaMatriculas"
                        ],
                        "outputVariable": "menuMultiplasMatriculasOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMultiplasMatriculasBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && true; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n    const textBody = `Toque em \"Ver op√ß√µes\" e escolha uma das matr√≠culas abaixo seguir.`;\n    const textFooter = ``;\n    const nameButton = `Ver op√ß√µes`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuMultiplasMatriculasOptions"
                        ],
                        "outputVariable": "menuMultiplasMatriculasBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "c4140cd4-7ac3-4879-b56b-cec7bbf07c2b",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "convertXmlToJson",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n    \n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n    \n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n        \n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n\n    const isMultipleId = validaMultiplasMatriculasHabeisJornada(obj)\n\n    if (isMultipleId) {\n        return \"MULTIPLE\";\n    } else {\n        return obj;\n    }\n}\n\nfunction validaMultiplasMatriculasHabeisJornada(json) {\n    try {\n        \n        const xmlConverted = json['s:Envelope']\n            ['s:Body']\n            [\"ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfilResponse\"]\n            [\"ConsultarPessoaPorCPFAplicandoAutorizacaoDePerfilResult\"]\n            ['a:Retorno']\n            ['a:ContratosDeTrabalho']\n            ['a:ContratoDeTrabalhoV3'];\n\n        const listaAtividades = returnCodigosAfastamento();\n\n        const atividadesFiltradas = xmlConverted.filter(matricula =>\n            listaAtividades.some(atividade => atividade.codigoSituacao == matricula['a:DadosGerais']['a:Situacao']['a:Codigo'])\n        )\n\n        return atividadesFiltradas.length > 1;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction returnCodigosAfastamento() {\n    return [\n        {\n            \"codigoSituacao\": 1,\n            \"descricao\": \"ATIVIDADE NORMAL\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 2,\n            \"descricao\": \"AF ACID TRAB ACIMA PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 3,\n            \"descricao\": \"AF DOENCA ACIMA PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 4,\n            \"descricao\": \"AF LIC MATERNIDADE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 5,\n            \"descricao\": \"AF SERVICO MILITAR\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 6,\n            \"descricao\": \"AF SEM BENEFICIO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 7,\n            \"descricao\": \"FERIAS NOR AD 13 SAL/AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 8,\n            \"descricao\": \"FERIAS NOR AD 13 SAL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 9,\n            \"descricao\": \"FERIAS NOR\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 10,\n            \"descricao\": \"FERIAS NOR AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 11,\n            \"descricao\": \"FERIAS COL AD 13 SAL/AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 12,\n            \"descricao\": \"FERIAS COL AD 13 SAL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 13,\n            \"descricao\": \"FERIAS COL\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 14,\n            \"descricao\": \"FERIAS COL AB PECUN\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 15,\n            \"descricao\": \"RESC PEDIDO DEMISS NA EXP\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 16,\n            \"descricao\": \"RESC PEDIDO DEMISS AVISO IND\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 17,\n            \"descricao\": \"RESC PEDIDO DEMISS AVISO TRAB\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 18,\n            \"descricao\": \"RESC TER CON NA EXPERIENCIA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 19,\n            \"descricao\": \"RESC DEMIS NA EXPERIENCIA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 20,\n            \"descricao\": \"RESC DEMIS S/ JC AVISO IND\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 21,\n            \"descricao\": \"RESC DEMIS S/ JC AVISO TRAB\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 22,\n            \"descricao\": \"RESC DEMIS COM JUSTA CAUSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 23,\n            \"descricao\": \"RESC FALECIMENTO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 24,\n            \"descricao\": \"RESC APOSENT TEMPO SERVICO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 25,\n            \"descricao\": \"RESC APOSENT POR INVALIDEZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 26,\n            \"descricao\": \"TRANSFERENCIA C/ONUS P/CEDENTE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 27,\n            \"descricao\": \"TRANSFERENCIA S/ONUS P/CEDENTE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 28,\n            \"descricao\": \"RESC TER CON TRA APOS TEMP SER\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 29,\n            \"descricao\": \"APOSENTADORIA ACID TRABALHO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 30,\n            \"descricao\": \"APOSENTADORIA EXCETO DOE/AC TR\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 31,\n            \"descricao\": \"APOSENTADORIA DOENCA/PROFIS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 32,\n            \"descricao\": \"AF LICENCA REMUNERADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 33,\n            \"descricao\": \"ATIVIDADE NORMAL ESTAGIARIO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 34,\n            \"descricao\": \"AF LIC PATERNIDADE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 35,\n            \"descricao\": \"AF ACID TRAB ATE O PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 36,\n            \"descricao\": \"ATIVIDADE NORMAL PRO LABORE\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 37,\n            \"descricao\": \"AF DOENCA ATE O PRAZO LEGAL\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 38,\n            \"descricao\": \"RESC APOSENT POR IDADE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 39,\n            \"descricao\": \"RESCISAO  ESTAGIARIO EXTINCAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 40,\n            \"descricao\": \"RESCISAO  ESTAGIARIO DISPENSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 41,\n            \"descricao\": \"RESCISAO  ESTAGIARIO PEDIDO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 42,\n            \"descricao\": \"AF LIC MATERNIDADE PRORROG\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 43,\n            \"descricao\": \"AF OUTROS MOTIVOS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 44,\n            \"descricao\": \"ESTAGIARIO EM RECESSO\",\n            \"codigoTipoSituacao\": 4,\n            \"tipoSituacao\": \"Recesso\"\n        },\n        {\n            \"codigoSituacao\": 45,\n            \"descricao\": \"AF LICENCA NAO REMUNERADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 46,\n            \"descricao\": \"AF EXPATRIADO COM FGTS\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 47,\n            \"descricao\": \"GESTANTE DESLOCADA AMBIENTE INSALUBRE\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 48,\n            \"descricao\": \"AF OUTROS MOTIVOS ( MIGRA√á√ÉO)\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 50,\n            \"descricao\": \"ATIVIDADE NORMAL VINCULO INTERMITENTE\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 51,\n            \"descricao\": \"FERIAS VINCULO INTERMITENTE\",\n            \"codigoTipoSituacao\": 3,\n            \"tipoSituacao\": \"F√©rias\"\n        },\n        {\n            \"codigoSituacao\": 52,\n            \"descricao\": \"RESC VINCULO INTERMITENTE DEMISSAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 53,\n            \"descricao\": \"RESC VINCULO INTERMITENTE PEDIDO DEMISSAO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 54,\n            \"descricao\": \"RESC VINCULO INTERMITENTE TERMINO CONTRATO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 79,\n            \"descricao\": \"ATIVIDADE NORMAL APRENDIZ\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 80,\n            \"descricao\": \"AF LIC MATERNIDADE EMP CIDADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 81,\n            \"descricao\": \"RESCISAO PRO LABORE\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 82,\n            \"descricao\": \"RESC TER CON MENOR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 83,\n            \"descricao\": \"AF SUSPENSAO CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 84,\n            \"descricao\": \"AF SUSPENSAO CONTR TRABALHO LEI 14020\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 85,\n            \"descricao\": \"AF LIC ABORTO NAO CRIMINOSO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 86,\n            \"descricao\": \"ATIVIDADE NORMAL DIRETOR ESTAT\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 87,\n            \"descricao\": \"ATIVIDADE NORMAL CONSELHEIRO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 88,\n            \"descricao\": \"RESCISAO DIRETOR ESTATUTARIO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 89,\n            \"descricao\": \"RESCISAO CONSELHEIRO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 90,\n            \"descricao\": \"AF LIC PATERNIDADE EMP CIDADA\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 91,\n            \"descricao\": \"RESC PEDIDO DEM C/JUSTA CAUSA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 92,\n            \"descricao\": \"RESC PEDIDO ANT CONTR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 93,\n            \"descricao\": \"RESC DEMIS ANT CONTR APRENDIZ\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 94,\n            \"descricao\": \"RESC DEMIS ANT CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 95,\n            \"descricao\": \"RESC TERMINO CONTR TRABALHO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 96,\n            \"descricao\": \"RESC INDIRETA\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 97,\n            \"descricao\": \"RESC DEMIS S/ JC PDV\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 98,\n            \"descricao\": \"AF LIC MATERNIDADE ADOCAO\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 99,\n            \"descricao\": \"RESC DEMIS S/ JC MUTUO ACORDO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        },\n        {\n            \"codigoSituacao\": 100,\n            \"descricao\": \"ATIVIDADE NORMAL AUTONOMO\",\n            \"codigoTipoSituacao\": 2,\n            \"tipoSituacao\": \"Atividade Normal\"\n        },\n        {\n            \"codigoSituacao\": 101,\n            \"descricao\": \"VINCULO AUTONOMO INATIVO\",\n            \"codigoTipoSituacao\": 5,\n            \"tipoSituacao\": \"Rescis√£o\"\n        }\n    ]\n}",
                        "inputVariables": [
                            "responseBuscaColaborador"
                        ],
                        "outputVariable": "convertXmlToJson"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "continueOnError": true
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuMultiplasMatriculasEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuMultiplasMatriculasOptions"
                        ],
                        "outputVariable": "menuMultiplasMatriculasEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuMultiplasMatriculasEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuMultiplasMatriculasEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuMultiplasMatriculasEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "errorType",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuMultiplasMatriculasEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuMultiplasMatriculasEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "4dae7092-0465-4c97-a618-c17afc668698",
            "root": false,
            "$title": "[Menu] M√∫ltiplas matr√≠culas",
            "$position": {
                "top": "1804px",
                "left": "271px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "9a190f49-8c82-4bc8-b8ce-f5ab6e9d3c8f": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "cef0b19e-00a3-46d9-84bf-92c775e44942",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#44dd8fb9-2b46-4942-8b4f-ed00b6b6b963",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "62e584c3-a91a-4da2-8278-f308c2eae602",
                    "typeOfStateId": "state",
                    "$connId": "con_448",
                    "$id": "8f64a675-f1de-4c2b-baa7-a1e20a7e6fff",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "d87a182c-3ec2-4075-8b64-813a7777c8f4",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'colaboradorInfo'",
                    "$invalid": false,
                    "settings": {
                        "function": "dwnt_run",
                        "source": "function run(listaMatriculas, escolha) {\n    try {\n        const { id } = JSON.parse(escolha);\n\n        let corpo = JSON.parse(listaMatriculas).find(item => item[\"a:DadosGerais\"][\"a:Matricula\"] == id);\n\n        const contact = {\n            empresa: {\n                codigo: corpo && corpo['a:Alocacao'] && corpo['a:Alocacao']['a:Empresa'] && corpo['a:Alocacao']['a:Empresa']['a:Codigo'] ? corpo['a:Alocacao']['a:Empresa']['a:Codigo'] : (corpo['a:Estabelecimento']['a:Codigo'] || ''),\n                descricao: corpo && corpo['a:Alocacao'] && corpo['a:Alocacao']['a:Empresa'] && corpo['a:Alocacao']['a:Empresa']['a:Descricao'] ? corpo['a:Alocacao']['a:Empresa']['a:Descricao'] : (corpo['a:Estabelecimento']['a:Descricao'] || ''),\n                identificacao: corpo && corpo['a:Alocacao'] && corpo['a:Alocacao']['a:Empresa'] && corpo['a:Alocacao']['a:Empresa']['a:Inscricao'] ? corpo['a:Alocacao']['a:Empresa']['a:Inscricao'] : '',\n                tipoDeIdentificacao: corpo && corpo['a:Alocacao'] && corpo['a:Alocacao']['a:Empresa'] && corpo['a:Alocacao']['a:Empresa']['a:TipoDeInscricao'] ? corpo['a:Alocacao']['a:Empresa']['a:TipoDeInscricao'] : '',\n            },\n            estabelecimento: {\n                codigo: corpo['a:Estabelecimento'] && corpo['a:Estabelecimento']['a:Codigo'] ? corpo['a:Estabelecimento']['a:Codigo'] : '',\n                descricao: corpo['a:Estabelecimento'] && corpo['a:Estabelecimento']['a:Descricao'] ? corpo['a:Estabelecimento']['a:Descricao'] : '',\n                identificacao: corpo['a:Estabelecimento'] && corpo['a:Estabelecimento']['a:Identificacao'] ? corpo['a:Estabelecimento']['a:Identificacao'] : '',\n                tipoDeIdentificacao: corpo['a:Estabelecimento'] && corpo['a:Estabelecimento']['a:TipoDeIdentificacao'] ? corpo['a:Estabelecimento']['a:TipoDeIdentificacao'] : '',\n            },\n            dadosGerais: {\n                dataAdmissao: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:DataAdmissao'] ? corpo['a:DadosGerais']['a:DataAdmissao'].split(\"T\")[0] : '',\n                dataInicioDaSituacaoAtual: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:DataInicioDaSituacaoAtual'] ? corpo['a:DadosGerais']['a:DataInicioDaSituacaoAtual'] : '',\n                matricula: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:Matricula'] ? corpo['a:DadosGerais']['a:Matricula'] : '',\n                tipoDeAdmissao: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:TipoDeAdmissao'] ? corpo['a:DadosGerais']['a:TipoDeAdmissao'] : '',\n                vinculoEmpregaticio: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:VinculoEmpregaticio'] ? corpo['a:DadosGerais']['a:VinculoEmpregaticio'] : '',\n                situacao: {\n                    codigo: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:Situacao'] && corpo['a:DadosGerais']['a:Situacao']['a:Codigo'] ? corpo['a:DadosGerais']['a:Situacao']['a:Codigo'] : '',\n                    descricao: corpo['a:DadosGerais'] && corpo['a:DadosGerais']['a:Situacao'] && corpo['a:DadosGerais']['a:Situacao']['a:Descricao'] ? corpo['a:DadosGerais']['a:Situacao']['a:Descricao'] : '',\n                },\n\n            },\n            pessoa: {\n                contato: {\n                    emailCorporativo: corpo['a:Pessoa'] && corpo['a:Pessoa']['a:Contato'] && corpo['a:Pessoa']['a:Contato']['a:EmailCorporativo'] ? corpo['a:Pessoa']['a:Contato']['a:EmailCorporativo'] : '',\n                },\n                dadosPessoais: {\n                    cpfCnpj: corpo['a:Pessoa'] && corpo['a:Pessoa']['a:DadosPessoais'] && corpo['a:Pessoa']['a:DadosPessoais']['a:CpfCnpj'] ? corpo['a:Pessoa']['a:DadosPessoais']['a:CpfCnpj'] : '',\n                    nome: corpo['a:Pessoa'] && corpo['a:Pessoa']['a:DadosPessoais'] && corpo['a:Pessoa']['a:DadosPessoais']['a:Nome'] ? corpo['a:Pessoa']['a:DadosPessoais']['a:Nome'] : '',\n                    pessoaId: corpo['a:Pessoa'] && corpo['a:Pessoa']['a:DadosPessoais'] && corpo['a:Pessoa']['a:DadosPessoais']['a:PessoaID'] ? corpo['a:Pessoa']['a:DadosPessoais']['a:PessoaID'] : '',\n                },\n\n            },\n            dadosDaEscalaEPontoDoContrato: {\n                marcaPonto: corpo['a:DadosDaEscalaEPontoDoContrato'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:MarcaPonto'] ? corpo['a:DadosDaEscalaEPontoDoContrato']['a:MarcaPonto'] : '',\n                escala: {\n                    cargaHorariaMensal: corpo['a:DadosDaEscalaEPontoDoContrato'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala']['a:CargaHorariaMensal'] ? corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala']['a:CargaHorariaMensal'] : '',\n                    cargaHorariaSemanal: corpo['a:DadosDaEscalaEPontoDoContrato'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala'] && corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala']['a:CargaHorariaSemanal'] ? corpo['a:DadosDaEscalaEPontoDoContrato']['a:Escala']['a:CargaHorariaSemanal'] : '',\n                },\n            }\n        }\n\n        return contact;\n    } catch (e) {\n        return false\n    }\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [SET 'colaboradorInfo'] \"+String(err);}}",
                        "inputVariables": [
                            "listaMatriculas",
                            "menuMultiplasMatriculasEscolha"
                        ],
                        "outputVariable": "colaboradorInfo",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "continueOnError": true
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "9a190f49-8c82-4bc8-b8ce-f5ab6e9d3c8f",
            "root": false,
            "$title": "Define colaboradorInfo",
            "$position": {
                "top": "1982px",
                "left": "271px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "62e584c3-a91a-4da2-8278-f308c2eae602": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "f9ca40d6-78c9-468f-afab-cdce303613e5",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#44dd8fb9-2b46-4942-8b4f-ed00b6b6b963",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "4d3349fc-7fd7-47a4-aaa5-b5e5135d49a0",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "62e584c3-a91a-4da2-8278-f308c2eae602",
            "root": false,
            "$title": "[GO TO] Busca telefone por PessoaID",
            "$position": {
                "top": "2154px",
                "left": "271px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "e1631861-2e4c-4b0b-bad6-37ca2d46bf21": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "017d0aa5-7472-425b-bb66-da906bd9aaa9",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#44dd8fb9-2b46-4942-8b4f-ed00b6b6b963",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "d26b41ea-20ea-436b-b0c8-a2b3ab32baf4",
                    "typeOfStateId": "state",
                    "$connId": "con_453",
                    "$id": "d5895795-afb4-49cf-b1eb-7450433360e3",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Afastamento"
                            ],
                            "variable": "situacaoColaborador@tipoSituacao"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "stateId": "80887b9c-099e-4193-8e8d-e747adb7e8bd",
                    "typeOfStateId": "state",
                    "$connId": "con_458",
                    "$id": "0820245f-7804-4669-8e23-698728491607",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Atividade normal",
                                "F√©rias",
                                "Recesso"
                            ],
                            "variable": "situacaoColaborador@tipoSituacao"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "4660919f-346e-453c-9572-e2af43806584",
                    "typeOfStateId": "state",
                    "$connId": "con_463",
                    "$id": "73b21a23-1b08-41f4-81eb-58b42b479eb3",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "628069a4-40b2-4978-bdef-ef3f214eaf92",
                    "$typeOfContent": "",
                    "type": "ProcessCommand",
                    "$title": "[DWNT] Delete 'processAfastamento'",
                    "settings": {
                        "to": "postmaster@msging.net",
                        "method": "delete",
                        "uri": "/contexts/{{contact.identity}}/processAfastamento",
                        "variable": "processAfastamentoDeleteCmdResp"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "processAfastamento"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "5734795f-4172-4266-9e0c-f07b45cfb6c3",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET_V2 'processAfastamento'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(colaboradorInfo) {\n    try {\n        colaboradorInfo = JSON.parse(colaboradorInfo);\n        const { empresa, dadosGerais } = colaboradorInfo;\n\n        const body = buildBodyRequest(empresa, dadosGerais);\n        const response = await requestLG(body);\n\n        // SET RESPONSE ON CONTEXT\n        await context.setVariableAsync('responseBuscaAfastamentoN2', response);\n\n        const responseFormatted = XMLConvert(response.data);\n\n        // SET JSONCONVERT ON CONTEXT\n        await context.setVariableAsync('convertAfastamentoN2XmlToJson', responseFormatted);\n\n        const newColaborador = await verificaAfastamentosUsuario(colaboradorInfo, responseFormatted);\n\n        if (!newColaborador) return false;\n\n        // SET COLABORADORINFO ON CONTEXT\n        await context.setVariableAsync('colaboradorInfo', newColaborador);\n\n        return true;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v2/ServicoDeAfastamento`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v2/ServicoDeAfastamento/ConsultarLista`\n    }\n    const BODY = body;\n\n    // SET BODY ON CONTEXT\n    await context.setVariableAsync('corpoBuscaAfastamentoN2', BODY);\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n\n        return {\n            success: isSuccessStatus(response.status),\n            status: response.status,\n            data: tryParseJson(response.body)\n        }\n    } catch (error) {\n        return {\n            error: true,\n            message: error.message || \"Erro inesperado\"\n        }\n    }\n}\n\nfunction isSuccessStatus(status) {\n    if (!status) {\n        return false;\n    }\n\n    return status >= 200 && status < 300;\n}\n\nfunction tryParseJson(response) {\n    try {\n        return JSON.parse(response);\n    } catch (error) {\n        return response;\n    }\n}\n\nfunction buildBodyRequest(empresa, dadosGerais) {\n    try {\n\n        return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v2=\"lg.com.br/api/v2\" \n    xmlns:v1=\"lg.com.br/api/dto/v1\">\n\n    <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n\n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n    <soapenv:Body>\n        <v2:ConsultarLista>\n            <v2:filtro>\n                <v1:Colaborador>\n                    <v1:Empresa>\n                        <v1:Codigo>${empresa.codigo}</v1:Codigo>\n                    </v1:Empresa>\n                    <v1:Matricula>${dadosGerais.matricula}</v1:Matricula>\n                </v1:Colaborador>\n            </v2:filtro>\n        </v2:ConsultarLista>\n    </soapenv:Body>\n</soapenv:Envelope>`;\n\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction XMLConvert(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n\n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n\n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n\n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n    return obj\n    ['s:Envelope']\n    ['s:Body']\n    [\"ConsultarListaResponse\"]\n    [\"ConsultarListaResult\"]\n    ['a:Retorno']\n    ['a:AfastamentoParcial']\n}\n\nasync function verificaAfastamentosUsuario(colaborador, listaAfastamentosUsuario) {\n    try {\n        const listaAfastamentosN2 = returnCodigosAfastamento();\n        const afastamentoRecente = verificaUltimoAfastamento(listaAfastamentosUsuario)\n\n        if (!afastamentoRecente) return false;\n\n        const dataFimAfastasmentoRecente = new Date(afastamentoRecente['a:DataFim']);\n        const now = new Date();\n\n        if (now > dataFimAfastasmentoRecente) {\n            return false\n        }\n\n        const situacaoAtual = listaAfastamentosN2.find(item => item.codigoSituacao == afastamentoRecente['a:Motivo']);\n\n        if (situacaoAtual) {\n            // SET situacaoColaborador ON CONTEXT\n            await context.setVariableAsync('situacaoColaborador', situacaoAtual);\n            \n            colaborador.dadosGerais.situacao = {\n                \"codigo\": situacaoAtual.codigoSituacao,\n                \"descricao\": situacaoAtual.descricao.toUpperCase().normalize(\"NFD\").replace(/([^¬™¬∫a-zA-Z0-9 ]+)/g, \"\")\n            }\n        }\n\n\n        return colaborador;\n    } catch (error) {\n        return false;\n    }\n}\n\nfunction returnCodigosAfastamento() {\n    return [\n        {\n            \"codigoSituacao\": 4,\n            \"descricao\": \"Licen√ßa Gestante\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 5,\n            \"descricao\": \"Motivo de Doen√ßa, per. superior a 15 dias\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 6,\n            \"descricao\": \"Sem Benef√≠cios\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 7,\n            \"descricao\": \"Outros\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 11,\n            \"descricao\": \"Por Acidente de Trabalho, per. inferior ou igual a 15 dias\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 12,\n            \"descricao\": \"Prorroga√ß√£o da Licen√ßa Maternidade\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 17,\n            \"descricao\": \"Licen√ßa Paternidade\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 18,\n            \"descricao\": \"Suspens√£o de Contrato de Trabalho\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 19,\n            \"descricao\": \"Motivo de Doen√ßa, per. igual ou inferior a 15 dias\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        }\n    ]\n}\n\nfunction verificaUltimoAfastamento(listaAfastamentos) {\n    if (listaAfastamentos.length > 0) {\n        let ultimoAfastamento = listaAfastamentos[0];\n\n        for (afastamento of listaAfastamentos) {\n            const dateA = new Date(ultimoAfastamento['a:DataFim'])\n            const dateB = new Date(afastamento['a:DataFim'])\n\n            if (dateB > dateA) ultimoAfastamento = afastamento\n        }\n\n        return ultimoAfastamento;\n    } else {\n        return false\n    }\n}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "outputVariable": "processAfastamento",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "0e59af9a-9c81-48e2-95b6-d14104dee790",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "RETRY SET_V2 'processAfastamento'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(colaboradorInfo) {\n    try {\n        const colaboradorInfo = JSON.parse(colaboradorInfo);\n        const { empresa, dadosGerais } = colaboradorInfo;\n\n        const body = buildBodyRequest(empresa, dadosGerais);\n        const response = await requestLG(body);\n\n        // SET RESPONSE ON CONTEXT\n        await context.setVariableAsync('responseBuscaAfastamentoN2', response);\n\n        const responseFormatted = XMLConvert(response.data);\n\n        // SET JSONCONVERT ON CONTEXT\n        await context.setVariableAsync('convertAfastamentoN2XmlToJson', responseFormatted);\n\n        const newColaborador = await verificaAfastamentosUsuario(colaboradorInfo, responseFormatted);\n\n        if (!newColaborador) return false;\n\n        // SET COLABORADORINFO ON CONTEXT\n        await context.setVariableAsync('colaboradorInfo', newColaborador);\n\n        return true;\n    } catch (error) {\n        return error.message;\n    }\n}\n\nasync function requestLG(body) {\n    const baseURL = `{{config.LGBaseUrl}}`\n    const URL = `${baseURL}/v2/ServicoDeAfastamento`;\n    const METHOD = 'POST';\n    const HEADERS = {\n        'Content-Type': 'text/xml',\n        'SOAPAction': `lg.com.br/api/v2/ServicoDeAfastamento/ConsultarLista`\n    }\n    const BODY = body;\n\n    // SET BODY ON CONTEXT\n    await context.setVariableAsync('corpoBuscaAfastamentoN2', BODY);\n\n    const OPTIONS = {\n        method: METHOD,\n        headers: HEADERS,\n        body: BODY\n    }\n\n    try {\n        const response = await request.fetchAsync(URL, OPTIONS);\n\n        return {\n            success: isSuccessStatus(response.status),\n            status: response.status,\n            data: tryParseJson(response.body)\n        }\n    } catch (error) {\n        return {\n            error: true,\n            message: error.message || \"Erro inesperado\"\n        }\n    }\n}\n\nfunction isSuccessStatus(status) {\n    if (!status) {\n        return false;\n    }\n\n    return status >= 200 && status < 300;\n}\n\nfunction tryParseJson(response) {\n    try {\n        return JSON.parse(response);\n    } catch (error) {\n        return response;\n    }\n}\n\nfunction buildBodyRequest(empresa, dadosGerais) {\n    try {\n\n        return `<soapenv:Envelope \n    xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n    xmlns:dto=\"lg.com.br/svc/dto\" \n    xmlns:v2=\"lg.com.br/api/v2\" \n    xmlns:v1=\"lg.com.br/api/dto/v1\">\n\n    <soapenv:Header>\n      <dto:LGAutenticacao>\n         <dto:TokenUsuario>\n            <dto:Senha>{{config.LGAuthPassword}}</dto:Senha>\n            <dto:Usuario>{{config.LGAuthUser}}</dto:Usuario>\n            <dto:GuidTenant>{{config.LGAuthGuidTenant}}</dto:GuidTenant>\n         </dto:TokenUsuario>\n      </dto:LGAutenticacao>\n\n      <dto:LGContextoAmbiente>\n        <dto:Ambiente>{{config.LGAuthEnviroment}}</dto:Ambiente>\n      </dto:LGContextoAmbiente>\n   </soapenv:Header>\n\n    <soapenv:Body>\n        <v2:ConsultarLista>\n            <v2:filtro>\n                <v1:Colaborador>\n                    <v1:Empresa>\n                        <v1:Codigo>${empresa.codigo}</v1:Codigo>\n                    </v1:Empresa>\n                    <v1:Matricula>${dadosGerais.matricula}</v1:Matricula>\n                </v1:Colaborador>\n            </v2:filtro>\n        </v2:ConsultarLista>\n    </soapenv:Body>\n</soapenv:Envelope>`;\n\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction convertXML(xml) {\n    let obj = {};\n    let tagStack = [];\n    let currentNode = obj;\n\n    // Regex patterns for XML parsing\n    const tagPattern = /<([^>]+)>/g;\n    let match;\n    let lastIndex = 0;\n\n    while ((match = tagPattern.exec(xml)) !== null) {\n        const tagContent = match[1];\n        const isEndTag = tagContent[0] === '/';\n\n        const textContent = xml.substring(lastIndex, match.index).trim();\n        if (textContent && tagStack.length > 0) {\n            const parentNode = tagStack[tagStack.length - 1];\n            if (!parentNode[\"_text\"]) {\n                parentNode[\"_text\"] = textContent;\n            } else if (typeof parentNode[\"_text\"] === \"string\") {\n                parentNode[\"_text\"] = [parentNode[\"_text\"], textContent];\n            } else {\n                parentNode[\"_text\"].push(textContent);\n            }\n        }\n\n        lastIndex = match.index + match[0].length;\n\n        if (isEndTag) {\n            tagStack.pop();\n            currentNode = tagStack[tagStack.length - 1] || obj;\n        } else {\n            const tagParts = tagContent.split(' ');\n            const tagName = tagParts[0];\n            const newNode = {};\n\n            if (currentNode[tagName] === undefined) {\n                currentNode[tagName] = newNode;\n            } else if (Array.isArray(currentNode[tagName])) {\n                currentNode[tagName].push(newNode);\n            } else {\n                currentNode[tagName] = [currentNode[tagName], newNode];\n            }\n\n            if (!isEndTag && tagContent[tagContent.length - 1] !== '/') {\n                tagStack.push(newNode);\n                currentNode = newNode;\n            }\n        }\n    }\n\n    // Clean up _text keys\n    function cleanUp(obj) {\n        for (let key in obj) {\n            if (obj[key] && typeof obj[key] === \"object\") {\n                if (obj[key]._text) {\n                    if (Object.keys(obj[key]).length === 1) {\n                        obj[key] = obj[key]._text;\n                    } else {\n                        obj[key].textValue = obj[key]._text;\n                        delete obj[key]._text;\n                    }\n                } else if (Object.values(obj[key]).length === 0) {\n                    delete obj[key];\n                }\n                cleanUp(obj[key]);\n            }\n        }\n    }\n\n    cleanUp(obj);\n    return obj\n    ['s:Envelope']\n    ['s:Body']\n    [\"ConsultarListaResponse\"]\n    [\"ConsultarListaResult\"]\n    ['a:Retorno']\n    ['a:AfastamentoParcial']\n}\n\nasync function verificaAfastamentosUsuario(colaborador, listaAfastamentosUsuario) {\n    try {\n        const listaAfastamentosN2 = returnCodigosAfastamento();\n        const afastamentoRecente = verificaUltimoAfastamento(listaAfastamentosUsuario)\n\n        if (!afastamentoRecente) return false;\n\n        const dataFimAfastasmentoRecente = new Date(afastamentoRecente['a:DataFim']);\n        const now = new Date();\n\n        if (now > dataFimAfastasmentoRecente) {\n            return false\n        }\n\n        const situacaoAtual = listaAfastamentosN2.find(item => item.codigoSituacao == afastamentoRecente['a:Motivo']);\n\n        if (situacaoAtual) {\n            // SET situacaoColaborador ON CONTEXT\n            await context.setVariableAsync('situacaoColaborador', situacaoAtual);\n            \n            colaborador.dadosGerais.situacao = {\n                \"codigo\": situacaoAtual.codigoSituacao,\n                \"descricao\": situacaoAtual.descricao.toUpperCase().normalize(\"NFD\").replace(/([^¬™¬∫a-zA-Z0-9 ]+)/g, \"\")\n            }\n        }\n\n\n        return colaborador;\n    } catch (error) {\n        return false;\n    }\n}\n\nfunction returnCodigosAfastamento() {\n    return [\n        {\n            \"codigoSituacao\": 4,\n            \"descricao\": \"Licen√ßa Gestante\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 5,\n            \"descricao\": \"Motivo de Doen√ßa, per. superior a 15 dias\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 6,\n            \"descricao\": \"Sem Benef√≠cios\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 7,\n            \"descricao\": \"Outros\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 11,\n            \"descricao\": \"Por Acidente de Trabalho, per. inferior ou igual a 15 dias\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 12,\n            \"descricao\": \"Prorroga√ß√£o da Licen√ßa Maternidade\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 17,\n            \"descricao\": \"Licen√ßa Paternidade\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 18,\n            \"descricao\": \"Suspens√£o de Contrato de Trabalho\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        },\n        {\n            \"codigoSituacao\": 19,\n            \"descricao\": \"Motivo de Doen√ßa, per. igual ou inferior a 15 dias\",\n            \"codigoTipoSituacao\": 1,\n            \"tipoSituacao\": \"Afastamento\"\n        }\n    ]\n}\n\nfunction verificaUltimoAfastamento(listaAfastamentos) {\n    if (listaAfastamentos.length > 0) {\n        let ultimoAfastamento = listaAfastamentos[0];\n\n        for (afastamento of listaAfastamentos) {\n            const dateA = new Date(ultimoAfastamento['a:DataFim'])\n            const dateB = new Date(afastamento['a:DataFim'])\n\n            if (dateB > dateA) ultimoAfastamento = afastamento\n        }\n\n        return ultimoAfastamento;\n    } else {\n        return false\n    }\n}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "outputVariable": "processAfastamento",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "source": "context",
                            "variable": "processAfastamento",
                            "comparison": "notExists",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "e1631861-2e4c-4b0b-bad6-37ca2d46bf21",
            "root": false,
            "$title": "[API] Verifica afastamento recente",
            "$position": {
                "top": "402px",
                "left": "1560px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "d26b41ea-20ea-436b-b0c8-a2b3ab32baf4": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "a442e235-9e87-4190-ae64-56176f5ec294",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#7b85c5f3-2b2a-49af-ab8b-6370fe43c97e",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "18bf6646-9840-4e58-86a5-a17fc4d118fb",
                    "typeOfStateId": "state",
                    "$connId": "con_468",
                    "$id": "c5904460-5843-4f5e-887f-6ec61d659c0d",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "1b864d0a-578a-4cdb-866c-0c59b0e8cbbf",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Definir contato",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "situacao": "{{colaboradorInfo@dadosGerais.situacao.descricao}}"
                        }
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "34ebe715-a59d-4bd5-b262-32bb63f1aff8",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "TrackEvent",
                    "$title": "user-registration-available",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "user-registration-available",
                        "action": "{{contact.taxDocument}} | {{contact.identity}} | {{colaboradorInfo@dadosGerais.matricula}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#00FF00",
                    "label": "DWN - Merge Contact",
                    "id": "DWN/TAG_MRG_CNT#75550d25-28a5-43f4-b509-3306608554fa",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "d26b41ea-20ea-436b-b0c8-a2b3ab32baf4",
            "root": false,
            "$title": "Atualiza Infos Extras",
            "$position": {
                "top": "535px",
                "left": "1928px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "57db7b75-a6f1-42ad-ac17-1c11827d58ba": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "08844dfc-eafb-49ff-b6cf-7f2916d4d92c",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "b0602510-5e66-4477-8a8e-82ee2b151023",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "b0602510-5e66-4477-8a8e-82ee2b151023",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "2ac812be-f069-43af-b0f5-b12388f50719",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "438832c3-8131-43ad-a11c-d7897921071b",
                            "type": "text/plain",
                            "content": "N√£o consegui fazer o cadastro por aqui, mas j√° estou chamando ajuda para finalizar o seu processo.",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "438832c3-8131-43ad-a11c-d7897921071b",
                                "type": "text/plain",
                                "content": "N√£o consegui fazer o cadastro por aqui, mas j√° estou chamando ajuda para finalizar o seu processo."
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "b9fc1a81-596c-4b07-8e8a-c743ccf8e227",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#7b85c5f3-2b2a-49af-ab8b-6370fe43c97e",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "a9f971df-6326-4d18-801b-d20829052441",
                    "typeOfStateId": "state",
                    "$connId": "con_473",
                    "$id": "922f5c39-aeb2-4c63-bd0c-28b12550802f",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "57db7b75-a6f1-42ad-ac17-1c11827d58ba",
            "root": false,
            "$title": "[Msg] Falha agencia n√£o cadastrada",
            "$position": {
                "top": "2219px",
                "left": "5193px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "f8baef42-bb3c-40b7-8992-ea3d034bf345": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "131e408a-2462-4b2d-a972-f4f205cb136e",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#7b85c5f3-2b2a-49af-ab8b-6370fe43c97e",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "72cfd94e-b775-428c-9a2d-d1df0fdb83a5",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "SetVariable",
                    "$title": "SET 'algoMaisTransbordo' to true",
                    "$invalid": false,
                    "settings": {
                        "variable": "algoMaisTransbordo",
                        "value": "true"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "32e5f224-1cf3-4733-a916-dfe04b984054",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "f8baef42-bb3c-40b7-8992-ea3d034bf345",
            "root": false,
            "$title": "[GO TO] Algo mais",
            "$position": {
                "top": "2111px",
                "left": "5032px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "a9f971df-6326-4d18-801b-d20829052441": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "1010d344-8058-4ea6-814f-ae1649c0edd6",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#7b85c5f3-2b2a-49af-ab8b-6370fe43c97e",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "b7285f90-9cd0-4444-861f-ae4066975833",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "a9f971df-6326-4d18-801b-d20829052441",
            "root": false,
            "$title": "[GO TO] Redirect Ath1",
            "$position": {
                "top": "2391px",
                "left": "5193px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "555bc847-63da-44a2-b085-2ed458ad724b": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "03ca771a-c8b5-4c42-b8ff-6419b73a0f5d",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "844114ad-bd11-4c20-9d54-a0fbcdcb1508",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "7075245a-3fd0-4661-af23-a26dba9c38e0",
                        "$typeOfContent": "raw-content",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendRawMessage",
                        "settings": {
                            "metadata": {},
                            "type": "{{menuNomeMaeBuild@type}}",
                            "rawContent": "{{menuNomeMaeBuild@content}}"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": false,
                        "$cardContent": {
                            "document": {
                                "id": "eebd3dfc-8a95-43be-b580-0a3d51f361c2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#a0fea368-d9ef-45e6-9a9b-3dc7722f09bd",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "fd2f521e-b579-49b9-b6f9-24c24ae38000",
                    "typeOfStateId": "state",
                    "$connId": "con_478",
                    "$id": "908622ff-3872-44cb-a368-58aa2c308278",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Atendente"
                            ],
                            "variable": "menuNomeMaeEscolha@id"
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                },
                {
                    "stateId": "2ef3d22f-1971-4836-8489-5baa0e77770d",
                    "typeOfStateId": "state",
                    "$connId": "con_483",
                    "$id": "223fff62-65ea-4bc3-b9d7-9179ad7df383",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "Tentar novamente"
                            ],
                            "variable": "menuNomeMaeEscolha@id"
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "66725947-5434-4dc8-a8a8-4cb7496a5a51",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "DWN Prepare menu-servicos",
                    "settings": {
                        "function": "run",
                        "source": "/*\nenum INTENT_TYPE { REGEX = \"regex\", FUZZY = \"fuzzy\", STATIC = \"static\" }\nenum INPUT_TYPE { \n\tFLOWS = \"FLOWS\", TEXT = \"TEXT\", CART = \"CART\", IMAGE = \"IMAGE\", STICKER = \"STICKER\", VIDEO = \"VIDEO\",\n\tAUDIO = \"AUDIO\", DOCUMENT = \"DOCUMENT\", LOCATION = \"LOCATION\", CTWA = \"CTWA\", INACTIVITY = \"INACTIVITY\"\n}\nenum INPUT_MODEL {\n\tGOTO = \"GOTO\", DEBUG = \"DEBUG\", CEP = \"CEP\", CPF = \"CPF\", CNPJ = \"CNPJ\",\n\tBIRTH_DAY = \"BIRTH_DAY\", NAME = \"NAME\", FULL_NAME = \"FULL_NAME\", EMAIL = \"EMAIL\",\n\tCTWA = \"CTWA\", FLOWS = \"FLOWS\", CART = \"CART\",\n}\ninterface IntentSpec {\n\t// Unique identifier for the intent (e.g., \"dwn@intent.id\")\n\tid: string;\n\t// Human-readable label describing the intent's purpose\n\tlabel: string;\n\t// Type of intent matching. Defaults to static\n\ttype?: INTENT_TYPE;\n\t// Array of patterns to match against user input (regex patterns or words)\n\tpatterns?: string[];\n\t// Custom payload data to associate with this intent (maps to dwn@input.payload)\n\tpayload?: any | null;\n\t// Target state to transition to when this intent is matched\n\tgoto?: State | null;\n}\ninterface State {\n\t// Unique identifier for the state\n\tid: string;\n\t// Service context for this state\n\tservice?: string;\n\t// Human-readable name for the state\n\tname?: string;\n}\ninterface Prepare {\n\t// Unique identifier for the preparation configuration\n\tid: string;\n\t// Whether to add a checkpoint to the flow for potential rollback. Default: false\n\tcheckpoint?: boolean;\n\t// Number of times to push the intent to the execution stack. Default: 0\n\tstack?: number;\n\t// Confidence score threshold for intent matching. Default: 0.75\n\tscore?: number;\n\t// Configuration for disabling specific flow features\n\tdisabled?: {\n\t\t// Whether to disable inactivity timeout handling. Default: false\n\t\tinactivity?: boolean;\n\t\t// Array of intent IDs to disable during execution\n\t\tintents?: string[];\n\t};\n\t// Custom error message configurations\n\terror?: {\n\t\t// Default error message when reaching the fallback state\n\t\tdefault?: string;\n\t\t// Custom inactivity error message. Default: 'INACTIVITY'\n\t\tinactivity?: string;\n\t};\n\t// Custom messages to override default configuration messages. Set to null to disable messages\n\tmessages?: string[];\n\t// Custom labels for flow states\n\tlabel?: {\n\t\t// Custom label for unexpected input handling\n\t\tunexpected?: string;\n\t};\n\t// Array of intent specifications for the flow\n\tintents?: IntentSpec[];\n\t// Input types to be processed in the flow\n\ttypes?: INPUT_TYPE[];\n\t// AI models to be used for intent processing in the flow\n\tmodels?: INPUT_MODEL[];\n}\n*/\n\nasync function dwnRun() {\n  const dwnPrepare = {\n    id: \"menu-menuNomeMae\",\n    checkpoint: true\n  };\n  return dwnPrepare;\n}\nasync function run(...args) {\n  let result = await dwnBasicScript(dwnRun, ...args);\n  return result;\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nvar Logger = class {\n  constructor() {\n    this._logs = [];\n  }\n  /**\n   * Logs an informational message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.log(\"User logged in\", { userId: 123, timestamp: new Date() });\n   * console.log(\"Processing\", 5, \"items\");\n   * ```\n   */\n  log(...args) {\n    this._log(\"info\", ...args);\n  }\n  /**\n   * Logs a warning message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.warn(\"Deprecated API usage\", { method: \"oldMethod\" });\n   * console.warn(\"Rate limit approaching:\", rateLimitInfo);\n   * ```\n   */\n  warn(...args) {\n    this._log(\"warn\", ...args);\n  }\n  /**\n   * Logs an error message.\n   *\n   * @param {...any} args Arguments to log (objects are automatically JSON stringified)\n   *\n   * @example\n   * ```typescript\n   * console.error(\"Failed to process request\", error);\n   * console.error(\"Validation failed:\", validationErrors);\n   * ```\n   */\n  error(...args) {\n    this._log(\"error\", ...args);\n  }\n  _log(level, ...args) {\n    const message = args.map((arg) => {\n      let parsed = \"\";\n      try {\n        if (typeof arg !== \"object\") throw new Error(\"Not an object\");\n        parsed = JSON.stringify(arg);\n      } catch (err) {\n        try {\n          parsed = String(arg);\n        } catch (err2) {\n          parsed = \"(unserializable)\";\n        }\n      }\n      return parsed;\n    }).join(\" \");\n    const log = { date: new Date(), message, level };\n    this._logs.unshift(log);\n  }\n};\nvar console = new Logger();\n\n\nfunction formatDate(date, config) {\n  let tzOffset = config ? config.gmt || -3 : -3;\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const datetimeFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return {\n    datetime: `${datetimeFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`,\n    time: dateTz.toISOString().split(\"T\")[1].split(\"Z\")[0]\n  };\n}\n\n\nasync function dwnBasicScript(fn, ...args) {\n  let result = undefined;\n  let error = null;\n  try {\n    result = await fn(...args);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `Unexpected error ${String(err)}`;\n      const stack = err && err.stack ? String(err.stack) : \"\";\n      err = new DwnError(\"SCRIPT_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    await dwnBasicFlush();\n  }\n  if (error) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return result;\n}\nasync function dwnBasicFlush() {\n  const id = \"9980ba16\";\n  const configStr = await context.getVariableAsync(\"dwnConfig\");\n  const logsStr = await context.getVariableAsync(\"dwnLogger\");\n  let config = {};\n  let logs = [];\n  try {\n    config = JSON.parse(configStr || \"\");\n  } catch (err) {\n  }\n  const stackSize = config.stackSize ? config.stackSize.logs || 10 : 10;\n  try {\n    logs = JSON.parse(logsStr || \"[]\");\n  } catch (err) {\n  }\n  const _logs = console._logs.map((log) => {\n    const { level, message, date } = log;\n    const { datetime } = formatDate(date, config);\n    return `[${datetime}]{${id}}(${level}) ${message}`;\n  });\n  logs = [..._logs, ...logs].slice(0, stackSize);\n  await context.setVariableAsync(\"dwnLogger\", JSON.stringify(logs));\n}\n",
                        "inputVariables": [],
                        "outputVariable": "dwnPrepare",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "$invalid": false
                },
                {
                    "$id": "aff845dd-c9ca-4b69-87bc-09226a1ca028",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuNomeMaeOptions'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run() {\n  try {\n\tconst allOptions = [\n\t  {\n\t\tid: \"Tentar novamente\",\n\t\ttitle: \"Tentar novamente\", // At√© 24 caracteres\n\t\ttitleShort: `Tentar novamente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Atendente\",\n\t\ttitle: \"Atendente\", // At√© 24 caracteres\n\t\ttitleShort: `Atendente`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t  {\n\t\tid: \"Encerrar\",\n\t\ttitle: \"Encerrar\", // At√© 24 caracteres\n\t\ttitleShort: `Encerrar`, // At√© 20 caracteres\n\t\tdescription: \"\",\n\t\tactive: true,\n\t  },\n\t];\n\n\treturn allOptions.filter(item => item.active);\n  } catch (error) {\n\treturn error.message;\n  }\n}",
                        "inputVariables": [],
                        "outputVariable": "menuNomeMaeOptions",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "5da4d80e-3989-4ffc-b607-4fe5cb4113df",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuNomeMaeBuild'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "async function run(dwnt, options) {\n  try {\n    const { source } = JSON.parse(dwnt).user;\n    const allOptions = JSON.parse(options);\n    const isMenuList = source === \"WHATSAPP\" && allOptions.length > 3; // Para sempre menu quick reply, setar como 'false'\n\n    const textHeader = \"\";\n\n    let textBody = `Selecione uma das op√ß√µes abaixo`;\n    if(source === \"WHATSAPP\") textBody = textBody.replace(/<\\/?b>/g, \"*\");\n\n    const textFooter = ``;\n    const nameButton = `Menu`;\n\n    let arrayOptionButtons;\n\n    if (isMenuList) {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger24Chars = item.title.length > 24;\n          acc.push({\n            id: item.id,\n            title: titleLonger24Chars ? item.title.titleShort : item.title,\n            description: item.description,\n          });\n        }\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"list\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              button: nameButton,\n              sections: [\n                {\n                  title: \"\",\n                  rows: arrayOptionButtons,\n                },\n              ],\n            },\n          },\n        },\n      };\n    } else if (source === \"WHATSAPP\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          const titleLonger20Chars = item.title.length > 20;\n          acc.push({\n            type: \"reply\",\n            reply: {\n              id: item.id,\n              title: titleLonger20Chars ? item.titleShort : item.title,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/json\",\n        content: {\n          recipient_type: \"individual\",\n          type: \"interactive\",\n          interactive: {\n            type: \"button\",\n            header: {\n              type: \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              buttons: arrayOptionButtons,\n            },\n          },\n        },\n      };\n    } else if (source === \"INSTAGRAM\") {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            scope: \"immediate\",\n            options: arrayOptionButtons,\n        },\n      };\n    } else {\n      arrayOptionButtons = allOptions.reduce((acc, item) => {\n        if (item.active) {\n          acc.push({\n            type: \"application/json\",\n            text: item.title,\n            value: {\n              button_id: item.id,\n            },\n          });\n        }\n\n        return acc;\n      }, []);\n\n      return {\n        type: \"application/vnd.lime.select+json\",\n        content: {\n            text: textBody,\n            // \"scope\":\"persistent\",\n            options: arrayOptionButtons,\n        },\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}",
                        "inputVariables": [
                            "DWN",
                            "menuNomeMaeOptions"
                        ],
                        "outputVariable": "menuNomeMaeBuild",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                }
            ],
            "$leavingCustomActions": [
                {
                    "$id": "97e87635-3871-439b-ae59-b0239f150590",
                    "$typeOfContent": "",
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'menuNomeMaeEscolha'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(userInput, options) {\n  try {\n    if (!userInput) {\n      return \"inv√°lido\";\n    }\n\n    const optionsMenu = JSON.parse(options);\n    const { metadata, content } = JSON.parse(userInput) || \"inv√°lido\";\n\n    const isBlipChatClick = content.hasOwnProperty(\"button_id\") || false;\n    const isWAClick =\n      metadata[\"#wa.interactive.list.id\"] ||\n      metadata[\"#wa.interactive.button.id\"] ||\n      false;\n\n    let optionIdChoosed = null;\n\n    if (isWAClick) {\n      optionIdChoosed = isWAClick;\n    } else if (isBlipChatClick) {\n      optionIdChoosed = content[\"button_id\"] || \"inv√°lido\";\n    }\n  \n    if (!optionIdChoosed) {\n      const formattedContent = textNormalizer(content);\n      return (\n        optionsMenu.find(\n          (item) =>\n            textNormalizer(item.title) === formattedContent ||\n            textNormalizer(item.titleShort) === formattedContent\n        ) || \"inv√°lido\"\n      );\n    }\n\n    return (\n      optionsMenu.find((item) => item.id === optionIdChoosed) || \"inv√°lido\"\n    );\n  } catch (e) {\n    return \"inv√°lido\";\n  }\n}\n\nfunction textNormalizer(dataToNormalize) {\n  return dataToNormalize\n    .normalize(\"NFD\")\n    .replace(/([^¬™a-z√°√†√¢√£√©√®√™√≠√Ø√≥√¥√µ√∂√∫√ß√±0-9]+)/gi, \"\")\n    .toLowerCase();\n}",
                        "inputVariables": [
                            "input.message",
                            "menuNomeMaeOptions"
                        ],
                        "outputVariable": "menuNomeMaeEscolha",
                        "LocalTimeZoneEnabled": false
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ]
                },
                {
                    "$id": "f9cc69fa-b946-4e01-a324-dafb7b92bd21",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}}",
                        "action": "{{menuNomeMaeEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuNomeMaeEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuNomeMaeEscolha"
                        }
                    ]
                },
                {
                    "$id": "76d6af65-6333-4bfa-bfa1-fa0cd91ac3b2",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[MENU ESCOLHA] state.name infos",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[MENU ESCOLHA] - {{state.name}} - details",
                        "action": "{{calendar.datetime}} | {{contact.identity}} | {{menuNomeMaeEscolha@title}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "notEquals",
                            "variable": "menuPrincipalEscolha"
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuPrincipalEscolha"
                        }
                    ]
                },
                {
                    "$id": "23a27921-49a6-4d80-9fb5-128c61d5f401",
                    "$typeOfContent": "",
                    "type": "TrackEvent",
                    "$title": "[ESCOLHA INV√ÅLIDA] state.name",
                    "$invalid": false,
                    "settings": {
                        "extras": {},
                        "category": "[ESCOLHA INV√ÅLIDA] - {{state.name}}",
                        "action": "{{input.content}}"
                    },
                    "conditions": [
                        {
                            "comparison": "notExists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        },
                        {
                            "values": [],
                            "source": "context",
                            "comparison": "exists",
                            "variable": "menuNomeMaeEscolha"
                        },
                        {
                            "values": [
                                "inv√°lido"
                            ],
                            "source": "context",
                            "comparison": "equals",
                            "variable": "menuNomeMaeEscolha"
                        }
                    ]
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [
                {
                    "background": "#8B00FF",
                    "label": "DWN - Input",
                    "id": "DWN/TAG_INP#ec687a82-cfa6-4f64-acae-0ed4e6209764",
                    "canChangeBackground": false
                },
                {
                    "background": "#0080FF",
                    "label": "DWN - Track Events",
                    "id": "DWN/TAG_TRK_EVT#c9ac2aa2-f775-44ee-bd9a-ab6da9d7c548",
                    "canChangeBackground": false
                }
            ],
            "id": "555bc847-63da-44a2-b085-2ed458ad724b",
            "root": false,
            "$title": "[Menu] Nome m√£e inv√°lido",
            "$position": {
                "top": "1028px",
                "left": "1071px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "e14e04ff-500f-43e3-b47e-02546cc7b03c": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "b1dffc2e-3879-466e-9ea3-0f7fb14d1bc7",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "f623224f-d61a-4731-b91f-3ed3306f2000",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "f623224f-d61a-4731-b91f-3ed3306f2000",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "94c8d9c3-1374-4d3c-a226-514f5eaf8356",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "1b4a5d12-e408-42d3-b4ac-4d6157140eaa",
                            "type": "text/plain",
                            "content": "Muito obrigada, validei aqui e est√° certinho",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "1b4a5d12-e408-42d3-b4ac-4d6157140eaa",
                                "type": "text/plain",
                                "content": "Muito obrigada, validei aqui e est√° certinho"
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        },
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ]
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "a03f6329-79f3-436b-a050-a957db83d6a2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false,
                        "conditions": [
                            {
                                "comparison": "notExists",
                                "source": "context",
                                "variable": "dwnError",
                                "values": []
                            }
                        ],
                        "expiration": "01:00"
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "$id": "DWN/ERR_COND#a0fea368-d9ef-45e6-9a9b-3dc7722f09bd",
                    "conditions": [
                        {
                            "comparison": "exists",
                            "source": "context",
                            "variable": "dwnError",
                            "values": []
                        }
                    ],
                    "stateId": "{{dwnCore@fallback}}",
                    "typeOfStateId": "variable",
                    "$invalid": false
                },
                {
                    "stateId": "e45ebdbd-3d62-410e-a193-33d4258874ba",
                    "typeOfStateId": "state",
                    "$connId": "con_488",
                    "$id": "1e3061a1-694d-4ea4-8c80-f3867700095b",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [
                {
                    "$id": "0399a7fe-a551-42f5-a9e8-6d2cfe47a94f",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "NomeMaeVerificado = true",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "NomeMaeVerificado": "true"
                        }
                    },
                    "conditions": []
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "e14e04ff-500f-43e3-b47e-02546cc7b03c",
            "root": false,
            "$title": "[Msg] Confirma√ß√£o nome",
            "$position": {
                "top": "843px",
                "left": "1325px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "80887b9c-099e-4193-8e8d-e747adb7e8bd": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "c7a3a47a-fdf9-4c29-93e1-6a99b9429ac2",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "stateId": "307a3c19-359f-43ba-a500-e903225b8d64",
                    "typeOfStateId": "state",
                    "$connId": "con_493",
                    "$id": "169983a4-2268-4603-a21f-a93311396401",
                    "conditions": [
                        {
                            "source": "context",
                            "comparison": "equals",
                            "values": [
                                "true"
                            ],
                            "variable": "isNewHire"
                        }
                    ],
                    "$invalid": false
                },
                {
                    "stateId": "a259153d-a9f4-4998-8893-ad7036579787",
                    "typeOfStateId": "state",
                    "$connId": "con_498",
                    "$id": "0ba37dac-1d1c-4f48-95fb-3e68d4070c3f",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [
                {
                    "$id": "eef64071-e156-4f27-b011-d1b69f17b51c",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "ExecuteScriptV2",
                    "$title": "SET 'isNewHire'",
                    "$invalid": false,
                    "settings": {
                        "function": "run",
                        "source": "function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (!data || !data.dadosGerais || !data.dadosGerais.dataAdmissao) {\n            return false;\n        }\n\n        const dataAdmissaoStr = data.dadosGerais.dataAdmissao;\n\n        const dataAdmissao = new Date(dataAdmissaoStr);\n        const hoje = new Date();\n\n        const diffTime = Math.abs(hoje - dataAdmissao);\n        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n        return diffDays <= 31;\n    } catch (e) {\n        return false;\n    }\n}",
                        "inputVariables": [
                            "colaboradorInfo"
                        ],
                        "outputVariable": "isNewHire"
                    },
                    "conditions": []
                }
            ],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "80887b9c-099e-4193-8e8d-e747adb7e8bd",
            "root": false,
            "$title": "[Verifica] Data admiss√£o",
            "$position": {
                "top": "414px",
                "left": "1927px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "307a3c19-359f-43ba-a500-e903225b8d64": {
            "$contentActions": [
                {
                    "action": {
                        "$id": "4b8732b2-058c-48a3-b696-82566b70bb56",
                        "$typeOfContent": "chat-state",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "cdc0f583-7ca3-46a4-8b65-6b97c38cc907",
                            "type": "application/vnd.lime.chatstate+json",
                            "content": {
                                "state": "composing",
                                "interval": 1000
                            }
                        },
                        "$cardContent": {
                            "document": {
                                "id": "cdc0f583-7ca3-46a4-8b65-6b97c38cc907",
                                "type": "application/vnd.lime.chatstate+json",
                                "content": {
                                    "state": "composing",
                                    "interval": 1000
                                }
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        }
                    },
                    "$invalid": false
                },
                {
                    "action": {
                        "$id": "fef7dbbf-f05e-4df2-b615-57506d94e403",
                        "$typeOfContent": "text",
                        "$description": "",
                        "$inputSchema": {
                            "type": "object",
                            "properties": {},
                            "required": []
                        },
                        "type": "SendMessage",
                        "settings": {
                            "id": "ba0ed0f6-b16c-465d-8905-f4df62859b35",
                            "type": "text/plain",
                            "content": "Que alegria ter voc√™ aqui na Neon! Neste in√≠cio de jornada, quero garantir que todas as suas d√∫vidas sejam solucionadas rapidamente. \n\nPor isso, sempre que precisar, vou direcionar voc√™ diretamente para o nosso time de especialistas. Eles est√£o prontos para te ajudar com todo o suporte que voc√™ precisa nesta fase inicial.",
                            "metadata": {}
                        },
                        "$cardContent": {
                            "document": {
                                "id": "ba0ed0f6-b16c-465d-8905-f4df62859b35",
                                "type": "text/plain",
                                "content": "Que alegria ter voc√™ aqui na Neon! Neste in√≠cio de jornada, quero garantir que todas as suas d√∫vidas sejam solucionadas rapidamente. \n\nPor isso, sempre que precisar, vou direcionar voc√™ diretamente para o nosso time de especialistas. Eles est√£o prontos para te ajudar com todo o suporte que voc√™ precisa nesta fase inicial."
                            },
                            "editable": true,
                            "deletable": true,
                            "position": "left"
                        }
                    },
                    "$invalid": false
                },
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "fbe24e7e-641c-4d11-979f-f7d72d84c806",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [
                {
                    "stateId": "21595fd2-899c-4cc7-b318-4436cdae79d8",
                    "typeOfStateId": "state",
                    "$connId": "con_503",
                    "$id": "db024d7b-2cce-4e2c-b525-d4ffa4c16c49",
                    "conditions": [
                        {
                            "source": "input",
                            "comparison": "exists",
                            "values": []
                        }
                    ],
                    "$isBuilderDefaultOutput": true,
                    "$invalid": false
                }
            ],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [
                {
                    "$id": "ea5a490b-cc25-47b0-8ad4-ef98cc498c66",
                    "$typeOfContent": "",
                    "$description": "",
                    "$inputSchema": {
                        "type": "object",
                        "properties": {},
                        "required": []
                    },
                    "type": "MergeContact",
                    "$title": "Time = 'Admiss√£o'",
                    "$invalid": false,
                    "settings": {
                        "extras": {
                            "Time": "Admiss√£o"
                        }
                    },
                    "conditions": []
                }
            ],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "fallback",
                "$invalid": false
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "307a3c19-359f-43ba-a500-e903225b8d64",
            "root": false,
            "$title": "[Msg] Colaborador recem admitido",
            "$position": {
                "top": "472px",
                "left": "2197px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        },
        "21595fd2-899c-4cc7-b318-4436cdae79d8": {
            "$contentActions": [
                {
                    "input": {
                        "bypass": true,
                        "$cardContent": {
                            "document": {
                                "id": "32f278ee-0b7d-4301-a736-d76e36be414f",
                                "type": "text/plain",
                                "textContent": "Entrada do usu√°rio",
                                "content": "Entrada do usu√°rio"
                            },
                            "editable": false,
                            "deletable": true,
                            "position": "right",
                            "editing": false
                        },
                        "$invalid": false
                    },
                    "$invalid": false
                }
            ],
            "$conditionOutputs": [],
            "$enteringCustomActions": [],
            "$leavingCustomActions": [],
            "$inputSuggestions": [],
            "$defaultOutput": {
                "stateId": "b7285f90-9cd0-4444-861f-ae4066975833",
                "$invalid": false,
                "typeOfStateId": "state"
            },
            "$localCustomActions": [],
            "isAiGenerated": false,
            "$tags": [],
            "id": "21595fd2-899c-4cc7-b318-4436cdae79d8",
            "root": false,
            "$title": "[GO TO] Redirect Ath2",
            "$position": {
                "top": "484px",
                "left": "2410px"
            },
            "$invalidContentActions": false,
            "$invalidOutputs": false,
            "$invalidCustomActions": false,
            "$invalid": false
        }
    },
    "globalActions": {
        "$contentActions": [],
        "$conditionOutputs": [],
        "$enteringCustomActions": [
            {
                "$id": "DWN/GLB_CFG_SCT#cda99ec4-1f5f-44e5-80aa-612986059e15",
                "$typeOfContent": "",
                "type": "ExecuteScriptV2",
                "$title": "DWN [SETTINGS] Config",
                "settings": {
                    "function": "dwnRun",
                    "source": "\nvar DEFAULT_LIST = {\n  block: false,\n  allow: true\n};\nvar DEFAULT_THRESHOLD = {\n  minScore: 0.75,\n  maxStack: 3\n};\nvar DEFAULT_DISABLE = {\n  inactivity: false,\n  intents: []\n};\nvar DEFAULT_STACK_SIZES = {\n  requests: 3,\n  logs: 10,\n  intents: 3,\n  errors: 5,\n  checkpoints: 5\n};\nvar DEFAULT_GLOBAL_INTENTS = [\n  {\n    id: \"CLOSE\",\n    label: \"Sair\",\n    type: \"regex\",\n    patterns: [\"sair\", \"^encerrar$\", \"finalizar\", \"encerrar atendimento\"],\n    goto: {\n      id: \"5327ac8e-4ad7-47a6-84fb-f85ab6a864fc\",\n      service: \"Ex-colaboradores\"\n    }\n  },\n  {\n    id: \"MAIN_MENU\",\n    label: \"Menu principal\",\n    type: \"regex\",\n    patterns: [\"^(menu)$\", \"^(menu principal)$\"],\n    goto: {\n      id: \"18bf6646-9840-4e58-86a5-a17fc4d118fb\",\n      service: \"Ex-colaboradores\"\n    }\n  },\n  {\n    id: \"CHECKPOINT_BACK\",\n    label: \"Voltar\",\n    type: \"regex\",\n    patterns: [\"voltar\", \"menu anterior\", \"voltar menu\", \"voltar menu anterior\"]\n  }\n];\nvar DEFAULT_GREETING = {\n  [\"MORNING\"]: \"Bom dia\",\n  [\"AFTERNOON\"]: \"Boa tarde\",\n  [\"EVENING\"]: \"Boa noite\",\n  [\"NIGHT\"]: \"Boa noite\"\n};\nvar DEFAULT_ERROR_MESSAGES = {\n  [\"UNEXPECTED_INPUT\"]: [\n    \"Desculpe, n√£o consegui entender.\\n\\n<b>Escolha uma op√ß√£o do menu ou tente com outras palavras,</b> por favor.\",\n    \"N√£o entendi o que voc√™ quis dizer.\\n\\n<b>Poderia tentar novamente?</b>\"\n  ],\n  [\"UNEXPECTED_OPTION\"]: [\n    \"N√£o entendi sua mensagem, desculpe...\\n\\n<b>Confira as op√ß√µes do menu e escolha uma,</b> por favor.\",\n    \"Essa n√£o √© uma das op√ß√µes...\\n\\n<b>Confira as op√ß√µes do menu e escolha uma,</b> por favor.\"\n  ],\n  [\"INACTIVITY\"]: [\n    //\"J√° faz uns minutinhos desde a sua √∫ltima mensagem...\",\n    \"Faz um tempo que voc√™ n√£o envia mensagens...\\n\\n<b>Vou encerrar a conversa, mas √© s√≥ enviar um ‚ÄúOi‚Äù para retomar!</b>\"\n  ],\n  [\"HTTP_ERROR\"]: [\n    \"Desculpe, meu sistema est√° indispon√≠vel agora...\\n\\n<b>Por favor, tente novamente mais tarde.</b>\"\n  ],\n  [\"SCRIPT_ERROR\"]: [\n    \"Desculpe, n√£o consigo te ajudar nesse momento...\\n\\n<b>Por favor, tente novamente mais tarde.</b>\"\n  ],\n  [\"RECURRENT_ERROR\"]: [\n    \"Ainda n√£o entendi, vou finalizar o seu atendimento para que voc√™ possa recome√ßar! Se precisar falar comigo novamente, √© s√≥ me chamar. üòä\"\n  ]\n};\nvar DEFAULT_TYPE_MESSAGES = {\n  [\"AUDIO\"]: [\n    \"N√£o consigo ouvir √°udios agora...\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\",\n    \"Opa, n√£o posso ouvir √°udios agora! üîàüö´\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\"\n  ],\n  [\"VIDEO\"]: [\n    \"N√£o consigo ver v√≠deos agora...\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\",\n    \"Opa, n√£o posso ver v√≠deos agora... üé•üö´\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\"\n  ],\n  [\"IMAGE\"]: [\n    \"N√£o consigo ver imagens agora...\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\",\n    \"Opa, n√£o posso ver imagens agora... üñºüö´\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\"\n  ],\n  [\"STICKER\"]: [\n    \"N√£o consigo ver figurinhas...\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\",\n    \"Opa, n√£o posso ver figurinhas... üñºüö´\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\"\n  ],\n  [\"DOCUMENT\"]: [\n    \"N√£o consigo ver arquivos agora...\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\",\n    \"Opa, n√£o posso ver arquivos agora... üìÑüö´\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\"\n  ],\n  [\"LOCATION\"]: [\n    \"N√£o consigo ver a localiza√ß√£o agora...\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\",\n    \"Opa, n√£o posso ver a localiza√ß√£o agora... üìçüö´\\n\\n<b>Envie apenas texto ou uma das op√ß√µes do menu, por favor.</b>\"\n  ]\n};\nvar DEFAULT_INTENT_MESSAGES = {\n  [\"CLOSE\"]: [\n    \"Obrigado por nos contatar! üòä Se precisar de mais ajuda, n√£o hesite em nos procurar novamente.\"\n  ]\n};\nvar DEFAULT_ERROR = {\n  default: \"UNEXPECTED_INPUT\",\n  inactivity: \"INACTIVITY\"\n};\nvar DEFAULT_DAYPARTS = {\n  [\"MORNING\"]: [6, 7, 8, 9, 10, 11],\n  [\"AFTERNOON\"]: [12, 13, 14, 15, 16, 17],\n  [\"EVENING\"]: [18, 19, 20, 21],\n  [\"NIGHT\"]: [22, 23, 0, 1, 2, 3, 4, 5]\n};\nvar DEFAULT_LABEL = {\n  [\"UNEXPECTED\"]: \"Inesperado\",\n  [\"ABANDONED\"]: \"Abandonado\",\n  [\"RESOLVED\"]: \"Finalizado\",\n  [\"ERROR\"]: \"Erro\"\n};\nvar DEFAULT_PASSWORD = \"admin\";\nvar DEFAULT_PROPAGATE = null;\nvar DEFAULT_CONTACT_GROUPS = [1];\nvar DEFAULT_DEBUG = false;\nasync function dwnRun(stateId, errorStr, setupStr) {\n  let config = {\n    ...await process(stateId, errorStr, setupStr)\n    // Define your custom config here\n  };\n  return JSON.stringify(config);\n}\n/**\n * @imports\n * @version    1.1.1\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nasync function process(stateId, errorStr, setupStr) {\n  stateId = stateId || \"\";\n  errorStr = errorStr || \"\";\n  setupStr = setupStr || \"\";\n  let error = DwnError.fromDwnError(errorStr);\n  let config = {};\n  try {\n    const setup = JSON.parse(setupStr);\n    config = createDefaultConfig(setup);\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `[create-config] Unexpected error ${String(err)}`;\n      const stack = err.stack || \"\";\n      err = new DwnError(\n        \"MISCONFIGURATION_ERROR\",\n        description,\n        {\n          stack,\n          goto: null\n        }\n      );\n    }\n    error = err;\n  }\n  if (error && error.toString() !== errorStr) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  if (stateId && stateId.startsWith(\"desk:\")) {\n    await context.setVariableAsync(\"dwnBypass\", \"true\");\n  } else {\n    await context.deleteVariableAsync(\"dwnBypass\");\n  }\n  return config;\n}\nfunction createDefaultConfig(setup) {\n  const current = setup.services ? setup.services.current : undefined;\n  const main = setup.services ? setup.services.main : undefined;\n  const contract = setup.connection ? setup.connection.contract : undefined;\n  const key = setup.connection ? setup.connection.key : undefined;\n  const gmt = setup.gmt;\n  if ([current, main, contract, key, gmt].some((v) => v === undefined)) {\n    throw new Error(\"Invalid Setup Configuration\");\n  }\n  if (!DEFAULT_ERROR_MESSAGES || !DEFAULT_ERROR_MESSAGES[\"UNEXPECTED_INPUT\"]) {\n    throw new Error(\n      \"Default error messages for UNEXPECTED_INPUT are not defined.\"\n    );\n  }\n  const service = {\n    current,\n    main\n  };\n  const connection = {\n    contract,\n    key\n  };\n  let config = {\n    gmt,\n    service,\n    connection,\n    list: DEFAULT_LIST,\n    threshold: DEFAULT_THRESHOLD,\n    stackSize: DEFAULT_STACK_SIZES,\n    intents: DEFAULT_GLOBAL_INTENTS,\n    disabled: DEFAULT_DISABLE,\n    messages: {\n      error: DEFAULT_ERROR_MESSAGES,\n      type: DEFAULT_TYPE_MESSAGES,\n      greeting: DEFAULT_GREETING,\n      intent: DEFAULT_INTENT_MESSAGES\n    },\n    daypart: DEFAULT_DAYPARTS,\n    error: DEFAULT_ERROR,\n    label: DEFAULT_LABEL,\n    password: DEFAULT_PASSWORD,\n    propagate: DEFAULT_PROPAGATE,\n    groups: DEFAULT_CONTACT_GROUPS,\n    debug: DEFAULT_DEBUG\n  };\n  return config;\n}\n",
                    "inputVariables": [
                        "state.id",
                        "dwnError",
                        "config.dwnSetup"
                    ],
                    "outputVariable": "dwnLocalConfig"
                },
                "conditions": [],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_UPD_CORE#920145f6-74fe-41b3-98e8-0b635065d935",
                "$typeOfContent": "",
                "type": "ExecuteScriptV2",
                "$title": "DWN Update Core",
                "settings": {
                    "function": "dwnRun",
                    "source": "/**\n * @author     [Beuren Bechlin] <beuren.bechlin@dawntech.dev>\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n *\n * ---\n *\n * This software is the proprietary property of Dawntech.\n * Possession, use, duplication, or dissemination of this software is strictly\n * prohibited unless you have received prior written permission from\n * Dawntech.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nvar dwnGlobalConfig = \"resource.dwnGlobalConfig\".replace(\"resource.\", \"\");\nasync function dwnRun(coreStr, setupStr, localStr, globalStr, statesStr, prepareStr, errorStr, inputContent, inputType, inputMessage, stateId) {\n  coreStr = coreStr || \"\";\n  localStr = localStr || \"\";\n  globalStr = globalStr || \"\";\n  statesStr = statesStr || \"\";\n  prepareStr = prepareStr || \"\";\n  errorStr = errorStr || \"\";\n  let core;\n  let config = undefined;\n  let local;\n  let global;\n  let states = {};\n  let prepare = undefined;\n  let error = DwnError.fromDwnError(errorStr);\n  let warnings = [];\n  let _states = {\n\t\t\"onboarding\": \"Onboarding - Ex-colaboradores\",\n\t\t\"fallback\": \"Fallback - Ex-colaboradores\",\n\t\t\"welcome\": \"Pre Set\",\n\t\t\"error\": \"DWN Error\",\n\t\t\"DWN/TAGS_BLK#8d275a58-1ea2-441d-95e0-c1dbfb357b90\": \"DWN Tags\",\n\t\t\"b2232aff-c7b1-4bd1-9f58-4e40a4da43c8\": \"Boas vindas - Novo usu√°rio\",\n\t\t\"cdfdb7f6-8c86-4794-a1cd-85cd8a03f61e\": \"[Msg] Coleta CPF\",\n\t\t\"2247a5fe-4bca-48de-af95-55b9e45afa26\": \"[Input] Coleta CPF\",\n\t\t\"e57edce0-5a77-4618-a3a7-4a8745c43a9f\": \"[API] Busca cadastro CPF\",\n\t\t\"884ed89d-0ede-44c2-a7ba-beb3e0a33d89\": \"[Menu] CPF inv√°lido\",\n\t\t\"7f1fb014-9d58-44f7-91bc-e6ec477124d8\": \"[Redirect] Main - PRD\",\n\t\t\"94590715-5781-4ca7-b53a-cbf020abf655\": \"Boas vindas - Retorno\",\n\t\t\"ae52c68c-daa4-4c2e-a789-f9f124ccfd53\": \"[GO TO] Coleta CPF\",\n\t\t\"b7285f90-9cd0-4444-861f-ae4066975833\": \"[Redirect] Ath\",\n\t\t\"225ad478-3dbb-4489-b61c-3ec0b8ca38c6\": \"[GO TO] Encerramento\",\n\t\t\"5327ac8e-4ad7-47a6-84fb-f85ab6a864fc\": \"Encerramento\",\n\t\t\"a259153d-a9f4-4998-8893-ad7036579787\": \"[Msg] CPF colaborador ativo\",\n\t\t\"b7a30720-2f18-4205-96c7-7703fda7a6db\": \"[Menu] Colaborador n√£o encontrado\",\n\t\t\"fc5a8fc5-fb90-48a1-a7e1-bdd09ac118ca\": \"[GO TO] Coleta CPF\",\n\t\t\"fd2f521e-b579-49b9-b6f9-24c24ae38000\": \"[GO TO] Redirect Ath\",\n\t\t\"18bf6646-9840-4e58-86a5-a17fc4d118fb\": \"[Menu] Principal\",\n\t\t\"44ad5cb5-8db9-40af-9f43-315d1ee1d0a9\": \"[GO TO] Afastamento\",\n\t\t\"149f416a-1d20-42e8-b332-db8d4142541b\": \"[GO TO] D√∫vidas de Rescis√£o\",\n\t\t\"84ff054b-2935-47f6-a855-7b2bea5ccfe6\": \"[GO TO] P4P\",\n\t\t\"38939352-72d0-424f-b0ad-2efb1e69a7da\": \"[GO TO] Informe de rendimentos\",\n\t\t\"e2daf0ad-4eb4-4249-87a5-91bd8969239a\": \"Retorno ao trabalho\",\n\t\t\"a5f35cf6-0755-4fef-b177-64f1e5916aae\": \"Complemento previd√™ncia\",\n\t\t\"31317339-ec29-402d-bde9-c30b6dbe977a\": \"[Valida] Tipo afastamento\",\n\t\t\"078be3ee-3405-4be6-9c8a-992678d7570f\": \"[Menu] Meu afastamento\",\n\t\t\"5f1475e3-f6f1-48a4-8279-19e01607fe54\": \"[Menu] Holerite\",\n\t\t\"e0b9aa1e-eb38-415d-8a45-6ec728a711d1\": \"[Menu] Afastamento\",\n\t\t\"3fe5d760-3084-4777-8e02-5e8db7c41255\": \"[Menu] Sele√ß√£o m√™s holerite\",\n\t\t\"3500e819-756e-48d0-8a93-a43088a700fc\": \"Resumo holerite\",\n\t\t\"32e5f224-1cf3-4733-a916-dfe04b984054\": \"[Menu] Algo mais\",\n\t\t\"a98902d7-7d20-4112-b50a-46b529b3aa1c\": \"[GO TO] Redirect Ath\",\n\t\t\"8efb02ba-7a1b-40cf-85b9-30e8bbbe2e69\": \"[GO TO] Menu principal\",\n\t\t\"7d87df52-c279-4f10-abf4-83bab974431a\": \"[GO TO] Encerramento\",\n\t\t\"d5ab2e50-1d08-41ea-9215-701968ee7188\": \"[GO TO] Fallback - Voltar\",\n\t\t\"e45ebdbd-3d62-410e-a193-33d4258874ba\": \"[Valida] Afastamento-Rescis√£o\",\n\t\t\"886f7e93-ca7f-400e-9615-a920d1da936d\": \"[GO TO] Algo mais Ath\",\n\t\t\"499116aa-7ba3-4814-9da6-81718a4c6ab6\": \"[GO TO] Redirect Ath\",\n\t\t\"ca7529a0-43a2-4668-b8ed-95e0133432ac\": \"[API] Informa√ß√µes holerite\",\n\t\t\"24b1aca0-2afb-4551-ad25-166845ae6d24\": \"[API] Meses de pagamento\",\n\t\t\"4bedd28d-c3f9-4b9b-ba98-ffd84e0e5718\": \"[GO TO] Algo mais\",\n\t\t\"6ffaf47b-15de-44e7-841e-6f086a57be38\": \"[Menu] Informe de rendimentos\",\n\t\t\"9bb74dec-a595-4f1f-8e6e-4505ff7f2afe\": \"[GO TO] Redirect Ath\",\n\t\t\"a763c0c0-6420-4e98-a351-072e656db3de\": \"Data disponibiliza√ß√£o Inf Rendimentos\",\n\t\t\"d29d6d20-5586-467f-aba2-88b136b72167\": \"[GO TO] Algo mais\",\n\t\t\"100f34ad-4c27-4274-bbf2-c3f18d26ffb8\": \"Valores do IRRF\",\n\t\t\"1a99da74-3723-4464-8be4-444c3bc535b8\": \"[Menu] Rescis√£o\",\n\t\t\"8ab2ba9a-94ca-459c-814b-67006e9fbe4b\": \"Data pagamento rescis√£o\",\n\t\t\"57416802-b614-48a8-89b0-47f89730f146\": \"[GO TO] Algo mais\",\n\t\t\"9bcc3f9c-f6bd-4681-85ca-c8a75f4a5008\": \"PDF homologa√ß√£o\",\n\t\t\"8ebdb738-130e-4e0e-896f-a09eae7bf162\": \"Link agendamento demissional\",\n\t\t\"a260da85-b3f0-41ae-a7f2-9cefece6244b\": \"[Menu] Resid√™ncia devolu√ß√£o equip.\",\n\t\t\"1b223ce3-a37b-45f1-a0a6-e70733feca65\": \"[Menu] Regi√£o metropolitana\",\n\t\t\"7a4a708f-9575-4960-bc9e-99a017c6006a\": \"Link agendar devolu√ß√£o\",\n\t\t\"1baad63f-9452-47eb-bef7-ec4854395364\": \"[GO TO] Redirect Ath\",\n\t\t\"83a2b248-307a-42b3-8eac-350af7ab2c4a\": \"[Valida] Sociedade\",\n\t\t\"714f0ce2-d989-4072-83ce-29c86411e33f\": \"[Menu] Sociedade n√£o encontrada\",\n\t\t\"f3efaf1b-d82a-46c6-a7e5-2ce99539b3b3\": \"Informa√ß√µes de sociedade\",\n\t\t\"8196b0f7-b280-4304-b4cd-2dbb7311d41d\": \"[GO TO] Algo mais sem Ath\",\n\t\t\"15ffd56f-9795-4a35-bfd7-a03ef916d8f9\": \"[GO TO] Encerramento\",\n\t\t\"360f0a20-9da4-4aff-981c-2e69ab81590c\": \"[Menu] P4P\",\n\t\t\"1bfaf96f-2fc6-4daf-bcf7-74d3e33f7681\": \"FALTANDO Elegibilidade\",\n\t\t\"293fd567-898b-4821-8047-1c4a7b887834\": \"Data pagamento P4P\",\n\t\t\"634eed54-e949-4a46-887a-19934022b336\": \"[GO TO] Algo mais\",\n\t\t\"4660919f-346e-453c-9572-e2af43806584\": \"[Msg] Situa√ß√£o inv√°lida\",\n\t\t\"2ef3d22f-1971-4836-8489-5baa0e77770d\": \"[Msg] Telefone diferente do cadastro\",\n\t\t\"4d3349fc-7fd7-47a4-aaa5-b5e5135d49a0\": \"[API] Busca telefone por PessoaID\",\n\t\t\"6611aecf-96e6-4cdf-807f-e42de6f92369\": \"[API] Informa√ß√µes rescis√£o\",\n\t\t\"c356fe5a-1102-4079-92ed-3489f733441d\": \"[API] Data de pagamento\",\n\t\t\"f73ca752-4b68-4b52-92b5-7fcf56d07058\": \"[GO TO] Next block\",\n\t\t\"e853bc21-e205-4805-af86-6884c0ac1d02\": \"[GO TO] Busca data de pagamento\",\n\t\t\"b34272eb-fd25-4f3f-99fb-a215d5bafa48\": \"[Flows] Dados banc√°rios\",\n\t\t\"e398983e-1808-4c55-8c96-68bcf281a6dd\": \"[API] Atualiza√ß√£o dados banc√°rios\",\n\t\t\"199722a1-d045-499e-a2d1-1ea54de0660c\": \"[Msg] Dados banc√°rios atualizados\",\n\t\t\"1089f29b-39f9-4ec0-b891-4d024e26ce9b\": \"[Menu] Banco para pagamento\",\n\t\t\"6d0abde8-797e-4af3-8ccf-fbe81c39eab2\": \"[API] Busca dados banc√°rios Neon\",\n\t\t\"7016f674-b59b-4afb-b790-8009910d2c6b\": \"[Menu] Dados banc√°rios Neon\",\n\t\t\"2eb179bd-7ffc-4418-a516-04f75913e468\": \"[GO TO] Algo mais\",\n\t\t\"ca14f1e2-85d0-4baa-bd19-75d5c44cc9ac\": \"[API] Busca sociedade\",\n\t\t\"ffdf562f-2c3b-460d-858f-e3a5b346bcba\": \"[GO TO] M√∫ltiplas matr√≠culas\",\n\t\t\"4dae7092-0465-4c97-a618-c17afc668698\": \"[Menu] M√∫ltiplas matr√≠culas\",\n\t\t\"9a190f49-8c82-4bc8-b8ce-f5ab6e9d3c8f\": \"Define colaboradorInfo\",\n\t\t\"62e584c3-a91a-4da2-8278-f308c2eae602\": \"[GO TO] Busca telefone por PessoaID\",\n\t\t\"e1631861-2e4c-4b0b-bad6-37ca2d46bf21\": \"[API] Verifica afastamento recente\",\n\t\t\"d26b41ea-20ea-436b-b0c8-a2b3ab32baf4\": \"Atualiza Infos Extras\",\n\t\t\"57db7b75-a6f1-42ad-ac17-1c11827d58ba\": \"[Msg] Falha agencia n√£o cadastrada\",\n\t\t\"f8baef42-bb3c-40b7-8992-ea3d034bf345\": \"[GO TO] Algo mais\",\n\t\t\"a9f971df-6326-4d18-801b-d20829052441\": \"[GO TO] Redirect Ath1\",\n\t\t\"555bc847-63da-44a2-b085-2ed458ad724b\": \"[Menu] Nome m√£e inv√°lido\",\n\t\t\"e14e04ff-500f-43e3-b47e-02546cc7b03c\": \"[Msg] Confirma√ß√£o nome\"\n\t};\n  try {\n    core = JSON.parse(coreStr || \"{}\");\n  } catch (err) {\n    warnings.push(`[update-core] Unexpected core JSON ${String(err)}`);\n    core = {};\n  }\n  let setup;\n  try {\n    setup = JSON.parse(setupStr || \"{}\");\n  } catch (err) {\n    warnings.push(`[update-core] Unexpected setup JSON ${String(err)}`);\n    setup = {};\n  }\n  try {\n    local = JSON.parse(localStr);\n  } catch (err) {\n    warnings.push(`[update-core] Unexpected localConfig JSON ${String(err)}`);\n    local = {};\n  }\n  try {\n    global = JSON.parse(globalStr || \"{}\");\n  } catch (err) {\n    warnings.push(`[update-core] Unexpected globalConfig JSON ${String(err)}`);\n    global = {};\n  }\n  try {\n    prepare = JSON.parse(prepareStr || \"null\");\n  } catch (err) {\n    warnings.push(`[update-core] Unexpected prepare JSON ${String(err)}`);\n    prepare = undefined;\n  }\n  try {\n    states = JSON.parse(statesStr || \"{}\");\n  } catch (err) {\n    warnings.push(`[update-core] Unexpected states JSON ${String(err)}`);\n    states = {};\n  }\n  try {\n    if (error && error.type === \"MISCONFIGURATION_ERROR\") {\n      throw error;\n    }\n    const service = setup.services ? setup.services.current : null;\n    if (!service) {\n      throw new DwnError(\n        \"MISCONFIGURATION_ERROR\",\n        `Setup must have 'services.current' property.`,\n        { goto: null }\n      );\n    }\n    _states = Object.keys(_states).reduce((acc, key) => {\n      acc[`${key}@${service}`] = _states[key];\n      return acc;\n    }, {});\n    states = {\n      ...states,\n      ..._states\n    };\n    await context.setVariableAsync(\"dwnStates\", JSON.stringify(states));\n    local = sanitizeLocalConfig(local, service, states);\n    global = sanitizeGlobalConfig(global, service, states);\n    prepare = sanitizePrepare(prepare, service, states);\n    config = createConfig(global, local, prepare, setup);\n    await context.setVariableAsync(dwnGlobalConfig, JSON.stringify(global));\n    const state = enforceState(\n      stateId || \"onboarding\",\n      service,\n      states\n    );\n    if (prepare.stack > config.threshold.maxStack) {\n      throw new DwnError(\n        \"MISCONFIGURATION_ERROR\",\n        `Stack size (prepare.stack) is greater than the maximum stack size (config.threshold.maxStack).`,\n        { goto: null }\n      );\n    }\n    let replyContent = inputContent || \"\";\n    let replyType = inputType || \"text/plain\";\n    let replyMessage = inputMessage || \"\";\n    let replyPayload = undefined;\n    let replyIntent = null;\n    let replyError = null;\n    let replyState = null;\n    try {\n      const EXPECTED_ERRORS = [\"RUNTIME_ERROR\"];\n      if (error && EXPECTED_ERRORS.includes(error.type)) {\n        throw error;\n      }\n      const content = JSON.parse(inputContent || \"\");\n      if (content.state && content.service) {\n        replyState = {\n          id: content.state,\n          service: content.service\n        };\n        const payload = content;\n        if (payload.payload) {\n          replyPayload = payload.payload;\n        }\n        if (payload.intent) {\n          replyIntent = payload.intent;\n        }\n        if (payload.error) {\n          replyError = payload.error;\n        }\n      }\n    } catch (err) {\n    }\n    try {\n      const metadata = JSON.parse(inputMessage || \"\").metadata;\n      if (metadata && metadata[\"#replyContent\"]) {\n        const replyMenu = JSON.parse(metadata[\"#replyContent\"]);\n        replyContent = replyMenu[\"replied\"][\"value\"];\n        replyType = replyMenu[\"replied\"][\"type\"];\n      }\n    } catch (err) {\n    }\n    const reply = {\n      content: replyContent,\n      type: replyType,\n      message: replyMessage,\n      payload: replyPayload\n    };\n    let intent = null;\n    if (replyIntent) {\n      intent = {\n        id: replyIntent,\n        type: \"static\",\n        scope: \"redirect\",\n        label: `Intent redirect ${replyIntent}`,\n        event: \"dwn-redirect-intents\",\n        pattern: \"\",\n        score: 0\n      };\n    }\n    if (replyError && replyError !== \"PROPAGATE\" && replyState) {\n      if (replyError === \"GOTO\") {\n        error = new DwnError(\"GOTO\", \"Goto error\", {\n          goto: replyState\n        });\n      } else {\n        error = new DwnError(replyError, \"Redirect error\", {\n          state: replyState\n        });\n      }\n    }\n    if (error && error.type === \"PROPAGATE\" && core.error) {\n      error = DwnError.fromJson(core.error);\n    }\n    const stack = core.intents ? core.intents.stack || [] : [];\n    const intents = prepare.intents.length ? [\n      {\n        id: `prepare-${state.service}-${state.id}`,\n        intents: prepare.intents,\n        scope: \"prepare\",\n        event: prepare.id\n      }\n    ] : [];\n    let groups = [\n      ...intents,\n      ...stack,\n      {\n        id: \"config\",\n        intents: config.intents,\n        scope: \"config\",\n        event: \"config\"\n      }\n    ];\n    const checkpoints = core.checkpoints || [];\n    if (checkpoints.length === 0) {\n      config.disabled.intents.push(\"CHECKPOINT_BACK\");\n    }\n    if (config.disabled.intents.length > 0) {\n      groups = groups.map((group) => {\n        group.intents = group.intents.filter((intent2) => {\n          return !config.disabled.intents.includes(intent2.id);\n        });\n        return group;\n      });\n    }\n    let services = core.services || [];\n    const serviceIndex = services.findIndex((_service) => _service === service);\n    if (serviceIndex >= 0) {\n      services.splice(0, serviceIndex + 1);\n    }\n    services.unshift(service);\n    let propagate = config.propagate ? config.propagate : services[1];\n    if (config.service.current === propagate) {\n      propagate = undefined;\n    }\n    core.version = \"2.0.0\";\n    core.errors = core.errors || [];\n    core.checkpoint = prepare.checkpoint || false;\n    core.checkpoints = core.checkpoints || [];\n    core.services = services;\n    core.intent = intent;\n    core.intents = { stack, groups };\n    core.prepare = prepare;\n    core.state = state;\n    core.reply = reply;\n    core.group = core.group || \"A\";\n    core.journey = core.journey || \"{{random.guid}}\";\n    core.sessions = core.sessions || 1;\n    core.service = config.service.current;\n    core.visits = core.visits || [];\n    core.main = config.service.current === config.service.main || undefined;\n    core.propagate = propagate;\n    core.redirect = undefined;\n    await context.setVariableAsync(\"dwnConfig\", JSON.stringify(config));\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `[update-core] Unexpected error ${String(err)}`;\n      const stack = err.stack || \"\";\n      err = new DwnError(\"RUNTIME_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    if (!core || typeof core !== \"object\") {\n      core = {};\n    }\n    core.warnings = warnings;\n    core.error = error ? error.toJson() : null;\n    core.fallback = \"fallback\";\n    coreStr = JSON.stringify(core);\n  }\n  if (prepare) {\n    await context.deleteVariableAsync(\"dwnPrepare\");\n  }\n  if (config && typeof config === \"object\") {\n    await context.setVariableAsync(\"dwnConfig\", JSON.stringify(config));\n  }\n  if (error && error.toString() !== errorStr) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return coreStr;\n}\nfunction sanitizeLocalConfig(config, service, states) {\n  const intents = config.intents || [];\n  config.intents = intents.map(\n    (intent) => sanitizeIntentSpec(intent, service, states)\n  );\n  return config;\n}\nfunction sanitizeGlobalConfig(config, service, states) {\n  const intents = config.intents || [];\n  config.intents = intents.map(\n    (intent) => sanitizeIntentSpec(intent, service, states, true)\n  );\n  return config;\n}\nfunction createConfig(global, local, prepare, setup) {\n  const config = merge(global, local);\n  const minScore = config.threshold.minScore || prepare.score;\n  if (!minScore) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      \"Threshold score (config.threshold.score) is required in the configuration.\",\n      { goto: null }\n    );\n  }\n  if (setup.services) {\n    config.service = setup.services;\n  }\n  if (setup.connection) {\n    config.connection = setup.connection;\n  }\n  if (setup.gmt) {\n    config.gmt = setup.gmt;\n  }\n  if (global.service && global.service.main) {\n    config.service.main = global.service.main;\n  }\n  if (global.connection && global.connection.contract && global.connection.key) {\n    config.connection.contract = global.connection.contract;\n    config.connection.key = global.connection.key;\n  }\n  config.threshold.minScore = minScore;\n  config.error = merge(\n    config.error,\n    prepare.error\n  );\n  config.inactivity = prepare.inactivity || config.inactivity;\n  config.disabled = merge(config.disabled, prepare.disabled);\n  config.disabled.intents = Array.from(new Set(config.disabled.intents));\n  if (!config.inactivity) {\n    config.inactivity = \"INACTIVITY\";\n  }\n  if (!config.service || !config.service.current || !config.service.main || !config.gmt) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      `Config must have 'service.current', 'service.main', and 'gmt' properties.`,\n      { goto: null }\n    );\n  }\n  if (!config.label[\"UNEXPECTED\"]) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      `Label for 'unexpected' (config.label['${\"UNEXPECTED\"}']) input is required in the configuration.`,\n      { goto: null }\n    );\n  }\n  return config;\n}\nfunction sanitizePrepare(prepare, service, states) {\n  if (!prepare) {\n    prepare = { id: \"prepare-not-set\" };\n  } else {\n    if (!prepare.id) {\n      throw new DwnError(\n        \"MISCONFIGURATION_ERROR\",\n        `Prepare must have 'id' property.`,\n        { goto: null }\n      );\n    }\n  }\n  const v0 = prepare;\n  const latest = prepare;\n  prepare = prepare;\n  prepare.id = kebabCase(prepare.id);\n  prepare.checkpoint = prepare.checkpoint || false;\n  prepare.stack = prepare.stack || 0;\n  prepare.score = prepare.score;\n  prepare.disabled = prepare.disabled || {};\n  prepare.disabled.inactivity = prepare.disabled.inactivity || false;\n  prepare.disabled.intents = prepare.disabled.intents || [];\n  prepare.label = prepare.label;\n  prepare.intents = prepare.intents || [];\n  prepare.models = prepare.models || [];\n  prepare.types = prepare.types || [];\n  let inactivity = latest.inactivity || \"INACTIVITY\";\n  if (v0.error && v0.error.inactivity) {\n    inactivity = v0.error.inactivity;\n  }\n  prepare.inactivity = inactivity;\n  const error = {\n    type: \"UNEXPECTED_INPUT\",\n    messages: [],\n    goto: undefined\n  };\n  if (latest.error && latest.error.type) {\n    error.type = latest.error.type;\n  } else if (v0.error && v0.error.default) {\n    error.type = v0.error.default;\n  }\n  if (latest.error && latest.error.goto) {\n    error.goto = enforceState(latest.error.goto, service, states);\n  }\n  if (latest.error && latest.error.messages) {\n    error.messages = latest.error.messages;\n  } else if (v0.messages) {\n    error.messages = v0.messages;\n  }\n  prepare.error = error;\n  prepare.intents = prepare.intents.map(\n    (intent) => sanitizeIntentSpec(intent, service, states)\n  );\n  return prepare;\n}\nfunction sanitizeIntentSpec(intent, service, states, global = false) {\n  if (!intent.id || !intent.label) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      `Intent ${JSON.stringify(intent)} must have 'id' and 'label' properties.`,\n      { goto: null }\n    );\n  }\n  intent.type = intent.type || \"static\";\n  intent.patterns = intent.patterns || [];\n  intent.payload = intent.payload || null;\n  if (global) {\n    const incompleteGoto = intent.goto && !intent.goto.service;\n    if (incompleteGoto) {\n      throw new DwnError(\n        \"MISCONFIGURATION_ERROR\",\n        `Intent ${JSON.stringify(\n          intent\n        )} has an incomplete goto. Service is required in the global config.`,\n        { goto: null }\n      );\n    }\n  }\n  intent.goto = enforceState(intent.goto, service, states);\n  return intent;\n}\n/**\n * @imports\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nfunction enforceState(state, currentService, states) {\n  if (!state && typeof state !== \"string\") {\n    return state;\n  }\n  const id = typeof state === \"string\" ? state : state.id;\n  if (!id) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      `State ${JSON.stringify(state)} must have 'id' property.`\n    );\n  }\n  const key = `${id}@${currentService}`;\n  let service = typeof state === \"string\" ? currentService : state.service;\n  if (!service) {\n    service = currentService;\n  }\n  let name = typeof state === \"string\" ? \"\" : state.name;\n  if (!name) {\n    name = states[key] || undefined;\n  }\n  return { id, service, name };\n}\n\n\nfunction kebabCase(str) {\n  if (!str) return \"\";\n  const matches = str.match(\n    /[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g\n  );\n  if (!matches) return \"\";\n  return matches.map((x) => x.toLowerCase()).join(\"-\");\n}\n\n\nfunction deepClone(source) {\n  if (source === null || typeof source !== \"object\") {\n    return source;\n  }\n  if (source instanceof Date) {\n    return new Date(source.getTime());\n  }\n  if (Array.isArray(source)) {\n    const newArray = [];\n    for (let i = 0; i < source.length; i++) {\n      newArray[i] = deepClone(source[i]);\n    }\n    return newArray;\n  }\n  const newObject = {};\n  for (const key in source) {\n    if (Object.prototype.hasOwnProperty.call(source, key)) {\n      newObject[key] = deepClone(source[key]);\n    }\n  }\n  return newObject;\n}\nfunction internalMerge(...objects) {\n  const validObjects = objects.filter((obj) => obj && typeof obj === \"object\");\n  if (validObjects.length === 0) return {};\n  const result = deepClone(validObjects[0] || {});\n  for (let i = 1; i < validObjects.length; i++) {\n    const source = validObjects[i];\n    for (const key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        const sourceValue = source[key];\n        const resultValue = result[key];\n        const isPlainObject = (v) => v && typeof v === \"object\" && !Array.isArray(v);\n        if (isPlainObject(resultValue) && isPlainObject(sourceValue)) {\n          result[key] = internalMerge(resultValue, sourceValue);\n        } else if (Array.isArray(resultValue) && Array.isArray(sourceValue)) {\n          result[key] = [...sourceValue, ...resultValue];\n        } else {\n          result[key] = deepClone(sourceValue);\n        }\n      }\n    }\n  }\n  return result;\n}\nfunction merge(...objects) {\n  return internalMerge(...objects);\n}\n",
                    "inputVariables": [
                        "dwnCore",
                        "config.dwnSetup",
                        "dwnLocalConfig",
                        "resource.dwnGlobalConfig",
                        "dwnStates",
                        "dwnPrepare",
                        "dwnError",
                        "input.content",
                        "input.type",
                        "input.message",
                        "state.id"
                    ],
                    "outputVariable": "dwnCore"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "notExists",
                        "variable": "dwnBypass"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_UPD_DWN#3880d3c2-0b32-464d-8e34-40525e9b6ac7",
                "$typeOfContent": "",
                "type": "ExecuteScriptV2",
                "$title": "DWN Update DWN",
                "settings": {
                    "function": "dwnRun",
                    "source": "/**\n * @author     [Beuren Bechlin] <beuren.bechlin@dawntech.dev>\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n *\n * ---\n *\n * This software is the proprietary property of Dawntech.\n * Possession, use, duplication, or dissemination of this software is strictly\n * prohibited unless you have received prior written permission from\n * Dawntech.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nasync function dwnRun(dwnStr, coreStr, configStr, statesStr, errorStr, listsConfigStr, tunnelOriginator, contactSerialized) {\n  dwnStr = dwnStr || \"\";\n  coreStr = coreStr || \"\";\n  configStr = configStr || \"\";\n  statesStr = statesStr || \"\";\n  errorStr = errorStr || \"\";\n  listsConfigStr = listsConfigStr || \"\";\n  let warnings = [];\n  let error = DwnError.fromDwnError(errorStr);\n  let dwn = null;\n  let core = null;\n  let config = null;\n  let contact;\n  let states = {};\n  let intent = null;\n  let goto = undefined;\n  let lists = { allow: [], block: [] };\n  try {\n    try {\n      core = JSON.parse(coreStr);\n    } catch (err) {\n      warnings.push(`[update-dwn] Unexpected core JSON ${String(err)}`);\n      throw new Error(`core parsing ${String(err)}`);\n    }\n    warnings = core.warnings;\n    const EXPECTED_ERRORS = [\n      \"RUNTIME_ERROR\",\n      \"MISCONFIGURATION_ERROR\",\n      \"PROPAGATE\"\n    ];\n    if (error && EXPECTED_ERRORS.includes(error.type)) {\n      throw error;\n    }\n    try {\n      dwn = JSON.parse(dwnStr || \"{}\");\n    } catch (err) {\n      warnings.push(`[update-dwn] Unexpected dwn JSON ${String(err)}`);\n      dwn = {};\n    }\n    try {\n      states = JSON.parse(statesStr);\n    } catch (err) {\n      warnings.push(`[update-dwn] Unexpected states JSON ${String(err)}`);\n      states = {};\n    }\n    try {\n      config = JSON.parse(configStr);\n    } catch (err) {\n      warnings.push(`[update-dwn] Unexpected config JSON ${String(err)}`);\n      throw new Error(`config parsing ${String(err)}`);\n    }\n    try {\n      contact = JSON.parse(contactSerialized);\n    } catch (err) {\n      warnings.push(`[update-dwn] Unexpected contact JSON ${String(err)}`);\n      throw new Error(`contact parsing ${String(err)}`);\n    }\n    try {\n      lists = JSON.parse(listsConfigStr || \"{}\");\n    } catch (err) {\n      warnings.push(`[update-dwn] Unexpected listsConfig JSON ${String(err)}`);\n      throw new Error(`listsConfig parsing ${String(err)}`);\n    }\n    dwn.error = undefined;\n    dwn.intent = undefined;\n    const prepare = core.prepare;\n    let allowList = [];\n    try {\n      if (!config.list.allow) {\n        throw new Error(\"DISABLED_LIST\");\n      }\n      if (!Array.isArray(lists.allow) || lists.allow.length === 0) {\n        throw new Error(\"allow list is not filled or invalid\");\n      }\n      allowList = lists.allow.map(\n        (id) => user__id(id, contact.identity)\n      );\n    } catch (err) {\n      allowList = [];\n      const _err = err instanceof Error ? err.message : String(err);\n      if (_err !== \"DISABLED_LIST\") {\n        warnings.push(`[update-dwn] Unexpected allowList JSON ${String(err)}`);\n      }\n    }\n    let blockList = [];\n    try {\n      if (!config.list.block) {\n        throw new Error(\"DISABLED_LIST\");\n      }\n      if (!Array.isArray(lists.block) || lists.block.length === 0) {\n        throw new Error(\"blockList is not filled or invalid\");\n      }\n      blockList = lists.block.map(\n        (id) => user__id(id, contact.identity)\n      );\n    } catch (err) {\n      blockList = [];\n      const _err = err instanceof Error ? err.message : String(err);\n      if (_err !== \"DISABLED_LIST\") {\n        warnings.push(`[update-dwn] Unexpected blockList JSON ${err}`);\n      }\n    }\n    let calendar = datetime__process(new Date(), config.gmt);\n    let daypart = daypart__find(calendar.hour, config.daypart);\n    let user = user__process(\n      contact,\n      tunnelOriginator,\n      !Boolean(dwn.user),\n      config.debug,\n      core.group,\n      core.sessions,\n      allowList,\n      blockList\n    );\n    if (user.blocked) {\n      let _error = new DwnError(\n        \"BLOCKED_CONTACT\",\n        \"Blocked contact\",\n        {\n          recurrence: { type: -1, state: -1, combined: -1 },\n          goto: null\n        }\n      );\n      error = error || _error;\n    }\n    let input = input__process(core.reply, prepare.models);\n    if (input.model == \"DEBUG\" && input.payload[\"password\"] === config.password) {\n      user.debug = !user.debug || undefined;\n      const _error = new DwnError(\n        \"DEBUG\",\n        `Debug mode toggled ${user.debug ? \"on\" : \"off\"}`\n      );\n      error = error || _error;\n    }\n    if (input.model == \"GOTO\" && input.payload[\"password\"] === config.password && user.debug) {\n      goto = {\n        id: input.payload.state,\n        service: input.payload.service\n      };\n      const _error = new DwnError(\n        \"GOTO\",\n        `Force state change`,\n        { goto }\n      );\n      error = error || _error;\n    }\n    if (input.type === \"INACTIVITY\" && !config.disabled.inactivity) {\n      const _error = new DwnError(config.inactivity, \"Inactivity detected\", {\n        goto: null\n      });\n      error = error || _error;\n    }\n    if (!intent) {\n      const [_intent, _goto] = redirect__intent(\n        core.intent,\n        core.intents.groups\n      );\n      if (_intent) {\n        intent = _intent;\n        goto = _goto;\n      }\n    }\n    if (!intent) {\n      const [_intent, _goto, _payload] = user__intent(\n        contact,\n        core.intents.groups\n      );\n      if (_intent) {\n        intent = _intent;\n        goto = _goto;\n        input.payload = input.payload || _payload;\n        let _error = new DwnError(\n          \"INTENT\",\n          `Contact intent ${intent.id} matched.`,\n          { goto }\n        );\n        error = error || _error;\n      }\n    }\n    if (!intent) {\n      for (const intentSpec of core.intents.groups) {\n        let [_intent, _goto, _payload] = reply__intent(\n          core.reply,\n          intentSpec,\n          config\n        );\n        if (_intent) {\n          intent = _intent;\n          goto = _goto;\n          input.payload = input.payload || _payload;\n          break;\n        }\n      }\n    }\n    if (intent && intent.id === \"CHECKPOINT_BACK\") {\n      const _goto = core.checkpoints.shift();\n      if (_goto) {\n        goto = goto || _goto;\n      } else {\n        intent = null;\n      }\n    }\n    if (intent && (intent.scope !== \"prepare\" || goto)) {\n      const _error = new DwnError(\n        \"INTENT\",\n        `Intent ${intent.id} in scope ${intent.scope} matched.`,\n        { goto }\n      );\n      error = error || _error;\n    }\n    if (!intent && prepare) {\n      const messages = config.error.messages || [];\n      const goto2 = config.error.goto || undefined;\n      if (prepare.models && prepare.models.length > 0 && !input.model) {\n        const _error = new DwnError(\n          config.error.type,\n          `Unexpected input model. Expected one of: ${prepare.models.join(\n            \", \"\n          )}`,\n          { messages, goto: goto2 }\n        );\n        error = error || _error;\n      } else if (prepare.types && prepare.types.length > 0 && input.type && !prepare.types.includes(input.type)) {\n        const _error = new DwnError(\n          config.error.type,\n          `Unexpected input type: ${input.type}. Expected one of: ${prepare.types.join(\", \")}`,\n          { messages, goto: goto2 }\n        );\n        error = error || _error;\n      } else if (prepare.intents && prepare.intents.length > 0) {\n        intent = {\n          id: undefined,\n          type: \"static\",\n          label: config.label[\"UNEXPECTED\"],\n          scope: \"prepare\",\n          event: prepare.id,\n          pattern: \"\",\n          score: 0\n        };\n      }\n    }\n    if (core.checkpoint) {\n      const checkpointIndex = core.checkpoints.findIndex(\n        (checkpoint) => checkpoint.id === core.state.id && checkpoint.service === core.service\n      );\n      if (checkpointIndex >= 0) {\n        core.checkpoints.splice(0, checkpointIndex + 1);\n      }\n      core.checkpoints.unshift(core.state);\n      core.checkpoints = core.checkpoints.slice(\n        0,\n        config.stackSize.checkpoints\n      );\n    }\n    if (prepare.intents && prepare.stack > 0) {\n      const intentsGroup = {\n        id: prepare.id,\n        intents: prepare.intents,\n        scope: \"stack\",\n        event: prepare.id\n      };\n      const stackLastIndex = core.intents.stack.reduce(\n        (lastIndex, intent2, index) => intent2.id === prepare.id ? index : lastIndex,\n        -1\n      );\n      if (stackLastIndex >= 0) {\n        core.intents.stack.splice(0, stackLastIndex + 1);\n      }\n      const groups = new Array(prepare.stack).fill(intentsGroup);\n      core.intents.stack.unshift(...groups);\n      core.intents.stack = core.intents.stack.slice(\n        0,\n        config.stackSize.intents\n      );\n    }\n    dwn.journey = core.journey;\n    dwn.daypart = daypart;\n    dwn.greeting = config.messages.greeting[daypart];\n    dwn.calendar = calendar;\n    dwn.input = input;\n    dwn.user = user;\n    dwn.service = config.service.current;\n    dwn.main = core.main || false;\n    dwn.error = undefined;\n    if (error) {\n      error.goto = enforceState(error.goto, config.service.current, states);\n      dwn.error = error.toJson();\n    }\n    dwn.intent = intent || undefined;\n    core.intent = intent || null;\n  } catch (err) {\n    if (!(err instanceof DwnError)) {\n      const description = `[update-dwn] Unexpected error ${String(err)}`;\n      const stack = err.stack || \"\";\n      err = new DwnError(\"RUNTIME_ERROR\", description, {\n        stack,\n        goto: null\n      });\n    }\n    error = err;\n  } finally {\n    if (!core || typeof core !== \"object\") {\n      core = {};\n    }\n    if (!dwn || typeof dwn !== \"object\") {\n      dwn = {};\n    }\n    if (error) {\n      dwn.error = error.toJson();\n    }\n    core.warnings = warnings;\n    dwn.warnings = core.warnings.join(\"\\n\");\n    dwnStr = JSON.stringify(dwn);\n  }\n  if (core && typeof core === \"object\") {\n    await context.setVariableAsync(\"dwnCore\", JSON.stringify(core));\n  }\n  if (error && error.toString() !== errorStr) {\n    await context.setVariableAsync(\"dwnError\", error.toString());\n  }\n  return dwnStr;\n}\nfunction user__source(contactIdentity) {\n  contactIdentity = String(contactIdentity);\n  if (contactIdentity.includes(\"@0mn.io\")) return \"BLIP_CHAT\";\n  if (contactIdentity.includes(\"@mailgun.gw.msging.net\"))\n    return \"E_MAIL\";\n  if (contactIdentity.includes(\"@messenger.gw.msging.net\"))\n    return \"MESSENGER\";\n  if (contactIdentity.includes(\"@skype.gw.msging.net\"))\n    return \"SKYPE\";\n  if (contactIdentity.includes(\"@take.io\")) return \"SMS_TAKE\";\n  if (contactIdentity.includes(\"@tangram.com.br\"))\n    return \"SMS_TANGRAM\";\n  if (contactIdentity.includes(\"@telegram.gw.msging.net\"))\n    return \"TELEGRAM\";\n  if (contactIdentity.includes(\"@wa.gw.msging.net\"))\n    return \"WHATSAPP\";\n  if (contactIdentity.includes(\"@instagram.gw.msging.net\"))\n    return \"INSTAGRAM\";\n  if (contactIdentity.includes(\"@googlercs.gw.msging.net\"))\n    return \"GOOGLE_RCS\";\n  if (contactIdentity.includes(\"@abs.gw.msging.net\"))\n    return \"MICROSOFT_TEAMS\";\n  if (contactIdentity.includes(\"@businesschat.gw.msging.net\"))\n    return \"APPLE_BUSINESS_CHAT\";\n  if (contactIdentity.includes(\"@workplace.gw.msging.net\"))\n    return \"WORKPLACE\";\n  return \"OUTRO\";\n}\nfunction user__id(contactPrefix, contactId) {\n  if (contactPrefix.includes(\"@\")) return contactPrefix;\n  const source = user__source(contactId);\n  const domains = {\n    [\"BLIP_CHAT\"]: \"@0mn.io\",\n    [\"E_MAIL\"]: \"@mailgun.gw.msging.net\",\n    [\"MESSENGER\"]: \"@messenger.gw.msging.net\",\n    [\"SKYPE\"]: \"@skype.gw.msging.net\",\n    [\"SMS_TAKE\"]: \"@take.io\",\n    [\"SMS_TANGRAM\"]: \"@tangram.com.br\",\n    [\"TELEGRAM\"]: \"@telegram.gw.msging.net\",\n    [\"WHATSAPP\"]: \"@wa.gw.msging.net\",\n    [\"INSTAGRAM\"]: \"@instagram.gw.msging.net\",\n    [\"GOOGLE_RCS\"]: \"@googlercs.gw.msging.net\",\n    [\"MICROSOFT_TEAMS\"]: \"@abs.gw.msging.net\",\n    [\"APPLE_BUSINESS_CHAT\"]: \"@businesschat.gw.msging.net\",\n    [\"WORKPLACE\"]: \"@workplace.gw.msging.net\",\n    [\"OUTRO\"]: \"\"\n  };\n  return `${contactPrefix}${domains[source] || \"\"}`;\n}\nfunction redirect__intent(intent, groups) {\n  const { id, scope } = intent || {};\n  let goto = undefined;\n  const group = groups.find((group2) => group2.id === \"config\");\n  intent = null;\n  if (id && group && scope === \"redirect\") {\n    const _intent = group.intents.find((_intent2) => _intent2.id === id);\n    if (_intent) {\n      intent = {\n        id: _intent.id,\n        type: \"static\",\n        label: `Intent redirect ${_intent.id}`,\n        scope: \"redirect\",\n        event: \"dwn-redirect-intents\",\n        pattern: \"\",\n        score: 0\n      };\n      goto = _intent.goto || undefined;\n    }\n  }\n  return [intent, goto];\n}\nfunction user__intent(contact, groups) {\n  let intent = null;\n  let goto = undefined;\n  let payload = null;\n  let id = undefined;\n  let event = \"dwn-contact-intents\";\n  const group = groups.find((group2) => group2.id === \"config\");\n  try {\n    if (!contact.extras[\"intent\"]) throw new Error(\"Intent not found\");\n    let extras = {};\n    const [intent2, extrasStr] = contact.extras[\"intent\"].split(\"-|-\");\n    id = intent2 || undefined;\n    try {\n      extras = JSON.parse(extrasStr || \"{}\");\n    } catch (e) {\n    }\n    if (extras.event) {\n      event = extras.event;\n    }\n    if (extras.payload) {\n      payload = extras.payload;\n    }\n    if (extras.dueDate && extras.expired && extras.expired.intent) {\n      const date = new Date(extras.dueDate || 0);\n      if ((new Date()).getTime() > date.getTime()) {\n        id = extras.expired.intent;\n      }\n      if (extras.expired.event) {\n        event = extras.expired.event;\n      }\n    }\n  } catch (e) {\n  }\n  if (id && group) {\n    const intentSpec = group.intents.find((intent2) => intent2.id === id);\n    if (intentSpec) {\n      goto = intentSpec.goto;\n      intent = {\n        id: id ? id.trim() : undefined,\n        type: \"static\",\n        label: `Intent contact extra ${id}`,\n        scope: \"contact\",\n        event,\n        pattern: \"\",\n        score: 0\n      };\n    }\n  }\n  return [intent, goto, payload];\n}\nfunction user__process(contact, tunnelOriginator, newUser, configDebug, group, sessions, allowList, blockList) {\n  const id = tunnelOriginator ? tunnelOriginator : contact.identity;\n  const source = user__source(contact.identity);\n  const debug = Boolean(contact.extras && contact.extras[\"debug\"]) || configDebug || undefined;\n  const blocked = blockList.some(\n    (id2) => contact.identity === user__id(id2, contact.identity)\n  );\n  const allowed = allowList.some(\n    (id2) => contact.identity === user__id(id2, contact.identity)\n  );\n  const phone = source === \"WHATSAPP\" ? contact.identity.split(\"@\")[0] : undefined;\n  const cellphone = source === \"WHATSAPP\" ? contact.identity.split(\"@\")[0].substring(2) : undefined;\n  const DDD = source === \"WHATSAPP\" ? contact.identity.split(\"@\")[0].substring(2, 4) : undefined;\n  return {\n    id,\n    source,\n    new: newUser || undefined,\n    blocked,\n    allowed,\n    group,\n    sessions,\n    cellphone,\n    phone,\n    DDD,\n    debug\n  };\n}\nfunction datetime__to_iso_with_offset(date, tzOffset) {\n  const dateTz = new Date(date.getTime() + tzOffset * 36e5);\n  const dateFormatted = dateTz.toISOString().split(\".\")[0];\n  const offsetSign = tzOffset >= 0 ? \"+\" : \"-\";\n  const offsetHours = Math.abs(Math.floor(tzOffset)).toString().padStart(2, \"0\");\n  const offsetMinutes = Math.abs(tzOffset % 1 * 60).toString().padStart(2, \"0\");\n  return `${dateFormatted}${offsetSign}${offsetHours}:${offsetMinutes}`;\n}\nfunction datetime__process(date, tzOffset) {\n  const datetime = datetime__to_iso_with_offset(date, tzOffset);\n  const calendar = {\n    datetime,\n    date: datetime.split(\"T\")[0],\n    time: datetime.split(\"T\")[1].split(\".\")[0].substring(0, 8),\n    hour: parseInt(datetime.split(\"T\")[1].substring(0, 2)),\n    minute: parseInt(datetime.split(\"T\")[1].substring(3, 5)),\n    GMT: tzOffset\n  };\n  return calendar;\n}\nfunction daypart__find(hour, daypart) {\n  if (isNaN(hour) || hour < 0 || hour > 23) {\n    throw new DwnError(\n      \"RUNTIME_ERROR\",\n      `Invalid hour: ${hour}`,\n      { goto: null }\n    );\n  }\n  if (!daypart || !daypart.MORNING || !daypart.AFTERNOON || !daypart.EVENING || !daypart.NIGHT) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      \"Daypart configuration is incomplete\",\n      { goto: null }\n    );\n  }\n  if (daypart.MORNING.includes(hour)) return \"MORNING\";\n  if (daypart.AFTERNOON.includes(hour)) return \"AFTERNOON\";\n  if (daypart.EVENING.includes(hour)) return \"EVENING\";\n  if (daypart.NIGHT.includes(hour)) return \"NIGHT\";\n  throw new DwnError(\n    \"MISCONFIGURATION_ERROR\",\n    `Hour ${hour} not found in any daypart`,\n    { goto: null }\n  );\n}\nfunction type__inactivity(reply) {\n  return reply.content === \"\" ? null : undefined;\n}\nfunction type__flows(reply) {\n  try {\n    return JSON.parse(\n      JSON.parse(reply.message).metadata[\"#wa.interactive.nfm_reply.json_response\"]\n    );\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction type__ctwa(reply) {\n  try {\n    const { metadata } = JSON.parse(reply.message || \"{}\");\n    if (metadata && metadata[\"#wa.referral.source_id\"]) {\n      return {\n        headline: metadata[\"#wa.referral.headline\"],\n        body: metadata[\"#wa.referral.body\"],\n        source_type: metadata[\"#wa.referral.source_type\"],\n        source_id: metadata[\"#wa.referral.source_id\"],\n        source_url: metadata[\"#wa.referral.source_url\"],\n        media_id: metadata[\"#wa.referral.image.id\"]\n      };\n    }\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction type__cart(reply) {\n  if (reply.type.includes(\"x-whatsapp-order+json\")) {\n    return null;\n  }\n  return undefined;\n}\nfunction type__text(reply) {\n  return reply.type === \"text/plain\" ? null : undefined;\n}\nfunction type__image(reply) {\n  try {\n    const _content = JSON.parse(reply.content);\n    let _type = _content && _content.type && _content.type.toLowerCase() || \"\";\n    if (_type.includes(\"image\")) {\n      return null;\n    }\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction type__sticker(reply) {\n  try {\n    const _content = JSON.parse(reply.content);\n    let _type = _content && _content.type && _content.type.toLowerCase() || \"\";\n    if (_type.includes(\"sticker\")) {\n      return null;\n    }\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction type__video(reply) {\n  try {\n    const _content = JSON.parse(reply.content);\n    let _type = _content && _content.type && _content.type.toLowerCase() || \"\";\n    if (_type.includes(\"video\")) {\n      return null;\n    }\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction type__audio(reply) {\n  try {\n    const _content = JSON.parse(reply.content);\n    let _type = _content && _content.type && _content.type.toLowerCase() || \"\";\n    if (_type.includes(\"audio\")) {\n      return null;\n    }\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction type__document(reply) {\n  try {\n    const _content = JSON.parse(reply.content);\n    let _type = _content && _content.type && _content.type.toLowerCase() || \"\";\n    if (_type.includes(\"application\")) {\n      return null;\n    }\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction type__location(reply) {\n  try {\n    const _content = JSON.parse(reply.message).content;\n    if (typeof _content === \"string\") {\n      return undefined;\n    }\n    let _type = reply.type;\n    if (_type.includes(\"location\")) {\n      return {\n        latitude: _content.latitude,\n        longitude: _content.longitude\n      };\n    }\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction model__cep(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const cleaned = text.replace(/\\D/g, \"\");\n  if (cleaned.length !== 8) {\n    return undefined;\n  }\n  return {\n    value: cleaned,\n    pretty: `${cleaned.slice(0, 5)}-${cleaned.slice(5)}`\n  };\n}\nfunction model__cpf(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const cpf = text.replace(/\\D/g, \"\");\n  if (cpf.length !== 11 || /^(\\d)\\1{10}$/.test(cpf)) {\n    return undefined;\n  }\n  let sum = 0;\n  let remainder;\n  for (let i = 1; i <= 9; i++) {\n    sum = sum + parseInt(cpf.substring(i - 1, i)) * (11 - i);\n  }\n  remainder = sum * 10 % 11;\n  if (remainder === 10 || remainder === 11) {\n    remainder = 0;\n  }\n  if (remainder !== parseInt(cpf.substring(9, 10))) {\n    return undefined;\n  }\n  sum = 0;\n  for (let i = 1; i <= 10; i++) {\n    sum = sum + parseInt(cpf.substring(i - 1, i)) * (12 - i);\n  }\n  remainder = sum * 10 % 11;\n  if (remainder === 10 || remainder === 11) {\n    remainder = 0;\n  }\n  if (remainder !== parseInt(cpf.substring(10, 11))) {\n    return undefined;\n  }\n  return {\n    value: cpf,\n    pretty: cpf.replace(/(\\d{3})(\\d{3})(\\d{3})(\\d{2})/, \"$1.$2.$3-$4\")\n  };\n}\nfunction model__cnpj(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const cnpj = text.replace(/\\D/g, \"\");\n  if (cnpj.length !== 14 || /^(\\d)\\1{13}$/.test(cnpj)) {\n    return undefined;\n  }\n  let size = cnpj.length - 2;\n  let numbers = cnpj.substring(0, size);\n  const digits = cnpj.substring(size);\n  let sum = 0;\n  let pos = size - 7;\n  for (let i = size; i >= 1; i--) {\n    sum += parseInt(numbers.charAt(size - i)) * pos--;\n    if (pos < 2) {\n      pos = 9;\n    }\n  }\n  let result = sum % 11 < 2 ? 0 : 11 - sum % 11;\n  if (result !== parseInt(digits.charAt(0))) {\n    return undefined;\n  }\n  size = size + 1;\n  numbers = cnpj.substring(0, size);\n  sum = 0;\n  pos = size - 7;\n  for (let i = size; i >= 1; i--) {\n    sum += parseInt(numbers.charAt(size - i)) * pos--;\n    if (pos < 2) {\n      pos = 9;\n    }\n  }\n  result = sum % 11 < 2 ? 0 : 11 - sum % 11;\n  if (result !== parseInt(digits.charAt(1))) {\n    return undefined;\n  }\n  return {\n    value: cnpj,\n    pretty: cnpj.replace(\n      /(\\d{2})(\\d{3})(\\d{3})(\\d{4})(\\d{2})/,\n      \"$1.$2.$3/$4-$5\"\n    )\n  };\n}\nfunction model__birth_day(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const match = text.trim().match(/^(\\d{1,2})[\\/.-](\\d{1,2})[\\/.-](\\d{4})$/);\n  if (!match) return undefined;\n  const day = parseInt(match[1], 10);\n  const month = parseInt(match[2], 10);\n  const year = parseInt(match[3], 10);\n  const date = new Date(year, month - 1, day);\n  if (date.getFullYear() !== year || date.getMonth() + 1 !== month || date.getDate() !== day) {\n    return undefined;\n  }\n  const dayStr = String(day).padStart(2, \"0\");\n  const monthStr = String(month).padStart(2, \"0\");\n  const yearStr = String(year);\n  return {\n    year: yearStr,\n    month: monthStr,\n    day: dayStr,\n    pretty: `${dayStr}/${monthStr}/${yearStr}`\n  };\n}\nfunction model__name(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const cleaned = text.trim();\n  const nameRegex = /^[a-zA-Z\\u00C0-\\u017F]+$/;\n  if (nameRegex.test(cleaned) && cleaned.split(/\\s+/).length === 1) {\n    const lowercase = cleaned.toLowerCase();\n    const pretty = lowercase.charAt(0).toUpperCase() + lowercase.slice(1);\n    return {\n      value: lowercase,\n      pretty\n    };\n  }\n  return undefined;\n}\nfunction model__full_name(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const cleaned = text.trim();\n  const fullNameRegex = /^[a-zA-Z\\u00C0-\\u017F]+(?:\\s[a-zA-Z\\u00C0-\\u017F]+)+$/;\n  if (fullNameRegex.test(cleaned)) {\n    const names = cleaned.split(/\\s+/).map((n) => n.toLowerCase());\n    if (names.length < 2) return undefined;\n    const prettyNames = names.map(\n      (name) => name.charAt(0).toUpperCase() + name.slice(1)\n    );\n    const first = prettyNames[0];\n    const last = prettyNames.slice(1).join(\" \");\n    const pretty = prettyNames.join(\" \");\n    return {\n      first,\n      last,\n      names,\n      lowercase: cleaned.toLowerCase(),\n      pretty\n    };\n  }\n  return undefined;\n}\nfunction model__email(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const emailRegex = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  const lowercasedText = text.toLowerCase().trim();\n  if (emailRegex.test(lowercasedText)) {\n    const parts = lowercasedText.split(\"@\");\n    return {\n      host: parts[0],\n      domain: parts[1],\n      pretty: lowercasedText\n    };\n  }\n  return undefined;\n}\nfunction model__phone(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const cleaned = text.replace(/\\D/g, \"\");\n  if (cleaned.length < 10 || cleaned.length > 15) {\n    return undefined;\n  }\n  let country = \"55\";\n  let remainingDigits = cleaned;\n  if (cleaned.length >= 12) {\n    const possibleCountry = cleaned.substring(0, cleaned.length - 10);\n    if (possibleCountry.length >= 1 && possibleCountry.length <= 3) {\n      country = possibleCountry;\n      remainingDigits = cleaned.substring(possibleCountry.length);\n    }\n  }\n  if (country === \"55\") {\n    if (remainingDigits.length < 10 || remainingDigits.length > 11) {\n      return undefined;\n    }\n    const ddd = remainingDigits.substring(0, 2);\n    const phone = remainingDigits.substring(2);\n    const dddNum = parseInt(ddd, 10);\n    if (dddNum < 11 || dddNum > 99) {\n      return undefined;\n    }\n    if (phone.length !== 8 && phone.length !== 9) {\n      return undefined;\n    }\n    if (phone.length === 9 && phone[0] !== \"9\") {\n      return undefined;\n    }\n    const phonePart1 = phone.length === 9 ? phone.substring(0, 5) : phone.substring(0, 4);\n    const phonePart2 = phone.length === 9 ? phone.substring(5) : phone.substring(4);\n    const local = `(${ddd}) ${phonePart1}-${phonePart2}`;\n    const global = `+${country} ${local}`;\n    return {\n      value: country + ddd + phone,\n      country,\n      ddd,\n      phone,\n      pretty: { global, local }\n    };\n  }\n  if (remainingDigits.length >= 10) {\n    const ddd = remainingDigits.substring(0, 2);\n    const phone = remainingDigits.substring(2);\n    const phonePart1 = phone.substring(0, Math.ceil(phone.length / 2));\n    const phonePart2 = phone.substring(Math.ceil(phone.length / 2));\n    const local = `${ddd} ${phonePart1}-${phonePart2}`;\n    const global = `+${country} ${local}`;\n    return {\n      value: country + ddd + phone,\n      country,\n      ddd,\n      phone,\n      pretty: { global, local }\n    };\n  }\n  return undefined;\n}\nfunction model__debug(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const match = text.trim().match(/^#debug\\s+(\\S+)$/i);\n  if (match) {\n    const [_, password] = match;\n    return { password };\n  }\n  return undefined;\n}\nfunction model__goto(reply) {\n  const text = reply.content;\n  if (typeof text !== \"string\") {\n    return undefined;\n  }\n  const match = text.trim().match(/^#goto\\s+(\\S+)\\s+(\\S+)(?:\\s+(\\S+))?$/i);\n  if (match) {\n    const [_, password, state, service] = match;\n    return { password, state, service };\n  }\n  return undefined;\n}\nfunction model__ctwa(reply) {\n  const message = reply.message;\n  try {\n    const { metadata } = JSON.parse(message || \"{}\");\n    if (metadata && metadata[\"#wa.referral.source_id\"]) {\n      return {\n        headline: metadata[\"#wa.referral.headline\"],\n        body: metadata[\"#wa.referral.body\"],\n        source_type: metadata[\"#wa.referral.source_type\"],\n        source_id: metadata[\"#wa.referral.source_id\"],\n        source_url: metadata[\"#wa.referral.source_url\"],\n        media_id: metadata[\"#wa.referral.image.id\"]\n      };\n    }\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction model__flows(reply) {\n  const message = reply.message;\n  try {\n    return JSON.parse(\n      JSON.parse(message).metadata[\"#wa.interactive.nfm_reply.json_response\"]\n    );\n  } catch (err) {\n  }\n  return undefined;\n}\nfunction model__cart(reply) {\n  if (reply.type.includes(\"x-whatsapp-order+json\")) {\n    return null;\n  }\n  return undefined;\n}\nfunction model__car_plate(reply) {\n  const text = reply.content;\n  const cleaned = text.replace(/-/g, \"\").trim().toUpperCase();\n  const carPlateRegex = /^[A-Z]{3}[\\d][A-Z\\d][\\d]{2}$/;\n  if (carPlateRegex.test(cleaned)) {\n    const pretty = `${cleaned.substring(0, 3)}-${cleaned.substring(3)}`;\n    return {\n      value: cleaned,\n      pretty\n    };\n  }\n  return undefined;\n}\nfunction input__process(reply, models) {\n  let content = reply.content;\n  let model = undefined;\n  let payload = null;\n  let type = \"TEXT\";\n  const _types = [\n    \"INACTIVITY\",\n    \"FLOWS\",\n    \"CTWA\",\n    \"CART\",\n    \"TEXT\",\n    \"IMAGE\",\n    \"STICKER\",\n    \"VIDEO\",\n    \"AUDIO\",\n    \"DOCUMENT\",\n    \"LOCATION\"\n  ];\n  const typeExec = {\n    [\"INACTIVITY\"]: type__inactivity,\n    [\"FLOWS\"]: type__flows,\n    [\"CTWA\"]: type__ctwa,\n    [\"CART\"]: type__cart,\n    [\"TEXT\"]: type__text,\n    [\"IMAGE\"]: type__image,\n    [\"STICKER\"]: type__sticker,\n    [\"VIDEO\"]: type__video,\n    [\"AUDIO\"]: type__audio,\n    [\"DOCUMENT\"]: type__document,\n    [\"LOCATION\"]: type__location\n  };\n  const modelExec = {\n    [\"GOTO\"]: model__goto,\n    [\"DEBUG\"]: model__debug,\n    [\"CEP\"]: model__cep,\n    [\"CPF\"]: model__cpf,\n    [\"CNPJ\"]: model__cnpj,\n    [\"BIRTH_DAY\"]: model__birth_day,\n    [\"NAME\"]: model__name,\n    [\"FULL_NAME\"]: model__full_name,\n    [\"EMAIL\"]: model__email,\n    [\"PHONE\"]: model__phone,\n    [\"CAR_PLATE\"]: model__car_plate,\n    [\"CTWA\"]: model__ctwa,\n    [\"FLOWS\"]: model__flows,\n    [\"CART\"]: model__cart,\n    [\"LOCATION\"]: type__location\n  };\n  type = _types.find((input_type) => typeExec[input_type](reply) !== undefined) || \"TEXT\";\n  payload = typeExec[type](reply);\n  const _models = [\n    \"GOTO\",\n    \"DEBUG\",\n    ...models || []\n  ];\n  const MODELS = [\n    \"GOTO\",\n    \"DEBUG\",\n    \"CEP\",\n    \"CPF\",\n    \"CNPJ\",\n    \"BIRTH_DAY\",\n    \"NAME\",\n    \"FULL_NAME\",\n    \"EMAIL\",\n    \"PHONE\",\n    \"CAR_PLATE\",\n    \"CTWA\",\n    \"FLOWS\",\n    \"CART\",\n    \"LOCATION\"\n  ];\n  const invalids = _models.filter((model2) => !MODELS.includes(model2));\n  if (invalids.length > 0) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      `Invalid model '${invalids.join(\", \")}'. Must be one of: ${MODELS.join(\n        \", \"\n      )}`,\n      { goto: null }\n    );\n  }\n  model = _models.find(\n    (input_model) => modelExec[input_model](reply) !== undefined\n  );\n  if (model) {\n    payload = modelExec[model](reply);\n  }\n  if (reply.payload) {\n    payload = reply.payload;\n  }\n  return {\n    content,\n    type,\n    payload,\n    model\n  };\n}\nfunction input__content(text) {\n  return String(text).trim().toLowerCase().normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").replace(/[^a-z0-9\\s]/g, \"\");\n}\nfunction reply__intent(reply, intentGroup, config) {\n  const { threshold } = config;\n  let minScore = threshold && threshold.minScore ? threshold.minScore : 0.75;\n  let intent = null;\n  let goto = undefined;\n  let payload = null;\n  for (const intentSpec of intentGroup.intents) {\n    const { type } = intentSpec;\n    if (type === \"fuzzy\") {\n      const _intent = intent__fuzzy(reply, intentSpec, intentGroup);\n      if (_intent && (!intent || intent.score < _intent.score)) {\n        intent = _intent;\n        goto = intentSpec.goto;\n        payload = intentSpec.payload || null;\n        continue;\n      }\n    }\n    if (type === \"regex\") {\n      const _intent = intent__regex(reply, intentSpec, intentGroup);\n      if (_intent) {\n        intent = _intent;\n        goto = intentSpec.goto;\n        payload = intentSpec.payload || null;\n        break;\n      }\n    }\n    if (type === \"static\") {\n      const _intent = intent__static(reply, intentSpec, intentGroup);\n      if (_intent) {\n        intent = _intent;\n        goto = intentSpec.goto;\n        payload = intentSpec.payload || null;\n        break;\n      }\n    }\n  }\n  if (intent && intent.type === \"fuzzy\" && intent.score < minScore) {\n    intent = null;\n    goto = undefined;\n  }\n  return [intent, goto, payload];\n}\nfunction intent__regex(reply, intentSpec, intentGroup) {\n  const { scope, event } = intentGroup;\n  const { id, patterns, label } = intentSpec;\n  let intent = null;\n  const score = 0;\n  const type = \"regex\";\n  try {\n    for (const pattern of patterns || []) {\n      if (new RegExp(pattern, \"i\").test(reply.content)) {\n        intent = {\n          id,\n          type,\n          scope,\n          label,\n          event,\n          pattern,\n          score\n        };\n      }\n    }\n  } catch (err) {\n    throw new DwnError(\n      \"RUNTIME_ERROR\",\n      `Error processing regex intent ${intentSpec.id}, error: ${err.message}`,\n      { goto: null }\n    );\n  }\n  return intent;\n}\nfunction intent__fuzzy(reply, intentSpec, intentGroup) {\n  const { scope, event } = intentGroup;\n  const { id, patterns, label } = intentSpec;\n  const content = input__content(reply.content);\n  const type = \"fuzzy\";\n  let intent = null;\n  let highest = 0;\n  function similarity_score(a, b) {\n    const maxLen = Math.max(a.length, b.length);\n    if (maxLen === 0) return 1;\n    return 1 - levenshtein_distance(a, b) / maxLen;\n  }\n  function levenshtein_distance(a, b) {\n    const matrix = [];\n    for (let i = 0; i <= b.length; i++) matrix[i] = [i];\n    for (let j = 0; j <= a.length; j++) matrix[0][j] = j;\n    for (let i = 1; i <= b.length; i++) {\n      for (let j = 1; j <= a.length; j++) {\n        if (b[i - 1] === a[j - 1]) {\n          matrix[i][j] = matrix[i - 1][j - 1];\n        } else {\n          matrix[i][j] = Math.min(\n            matrix[i - 1][j - 1] + 1,\n            matrix[i][j - 1] + 1,\n            matrix[i - 1][j] + 1\n          );\n        }\n      }\n    }\n    return matrix[b.length][a.length];\n  }\n  for (const pattern of patterns || []) {\n    const example = input__content(pattern);\n    const score = similarity_score(content, example);\n    if (score > highest) {\n      highest = score;\n      intent = {\n        id,\n        type,\n        scope,\n        label,\n        event,\n        pattern,\n        score\n      };\n    }\n  }\n  return intent;\n}\nfunction intent__static(reply, intentSpec, intentGroup) {\n  const { scope, event } = intentGroup;\n  const { id, patterns, label } = intentSpec;\n  let intent = null;\n  const score = 0;\n  const type = \"static\";\n  try {\n    let words = patterns || [];\n    if (words.includes(reply.content)) {\n      intent = {\n        id,\n        type,\n        scope,\n        label,\n        event,\n        pattern: reply.content,\n        score\n      };\n    }\n  } catch (err) {\n    throw new DwnError(\n      \"RUNTIME_ERROR\",\n      `Error processing regex intent ${intentSpec.id}, error: ${err.message}`,\n      { goto: null }\n    );\n  }\n  return intent;\n}\n/**\n * @imports\n * @version    2.0.0\n * @copyright  2025 Dawntech. All rights reserved.\n * @license    All Rights Reserved\n */\nvar DwnError = class _DwnError extends Error {\n  /**\n   * Creates a new DwnError instance.\n   *\n   * @param {string} type The error type identifier (e.g., \"VALIDATION_ERROR\", \"SCRIPT_ERROR\")\n   * @param {string} description Human-readable description of what went wrong\n   * @param {{message?: string, messages?: string[], stack?: string, goto?: State | null, state?: State, at?: string, intent?: string | null, content?: string, recurrence?: ErrorRecurrence, code?: string | null, status?: FINALIZATION_STATUS}} [extras] Optional additional error context and metadata:\n   * - `message`: Primary error message for user display\n   * - `messages`: Array of error messages for different contexts\n   * - `stack`: Stack trace or execution context information\n   * - `goto`: Target state to redirect to on error (null means terminate)\n   * - `state`: Flow state where the error occurred\n   * - `at`: Location or context where the error occurred\n   * - `intent`: Associated intent that caused the error\n   * - `content`: Additional error content or context\n   * - `recurrence`: Information about error recurrence patterns\n   * - `code`: Error code for programmatic error handling\n   * - `status`: Finalization status indicating how the error was resolved\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid input provided\");\n   *\n   * const contextError = new DwnError(\"SCRIPT_ERROR\", \"Script execution failed\", {\n   *   state: { id: \"state-123\", service: \"main\" },\n   *   intent: \"user-input\",\n   *   content: \"invalid data\",\n   *   messages: [\"First attempt failed\", \"Retry failed\"],\n   *   goto: { id: \"error-handler\", service: \"main\" }\n   * });\n   * ```\n   */\n  constructor(type, description, extras) {\n    super();\n    this.name = \"DwnError\";\n    const _extras = _DwnError.enforceExtras(extras);\n    this.type = type;\n    this.description = description;\n    this.at = _extras.at;\n    this.content = _extras.content;\n    this.state = _extras.state;\n    this.recurrence = _extras.recurrence;\n    this.goto = _extras.goto;\n    this.message = _extras.message || undefined;\n    this.messages = _extras.messages || [];\n    this.intent = _extras.intent || undefined;\n    this.code = _extras.code || undefined;\n    this.status = _extras.status || undefined;\n    this.stack = _extras.stack || undefined;\n    if (!this.stack) {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, _DwnError);\n      }\n    }\n  }\n  /**\n   * Creates a DwnError instance from a serialized error string.\n   *\n   * Parses a DWN error string in the format \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\"\n   * and reconstructs the original DwnError instance.\n   *\n   * @param {string} dwnErrorString Serialized error string from toString() method\n   * @returns {DwnError | undefined} DwnError instance or undefined if parsing fails\n   *\n   * @example\n   * ```typescript\n   * const errorString = \"SCRIPT_ERROR -|- Execution failed -|- {...}\";\n   * const error = DwnError.fromDwnError(errorString);\n   * ```\n   */\n  static fromDwnError(dwnErrorString) {\n    if (!dwnErrorString) return undefined;\n    const parts = dwnErrorString.split(\"-|-\");\n    let type = parts.shift();\n    if (!type) {\n      return undefined;\n    }\n    type = type.trim();\n    let description = parts.shift() || \"\";\n    if (description) {\n      description = description.trim();\n    }\n    let extras = undefined;\n    try {\n      extras = JSON.parse(parts.shift() || \"{}\");\n    } catch (e) {\n    }\n    if (extras) {\n      return new _DwnError(type, description, extras);\n    }\n    return new _DwnError(type, description);\n  }\n  /**\n   * Creates a DwnError instance from a JSON object.\n   *\n   * Converts a generic Error object or JSON representation into a properly\n   * structured DwnError instance with all required properties.\n   *\n   * @param {Error} data Error object or JSON data to convert\n   * @returns {DwnError} New DwnError instance\n   *\n   * @example\n   * ```typescript\n   * const jsonData = { type: \"API_ERROR\", description: \"Request failed\" };\n   * const error = DwnError.fromJson(jsonData);\n   * ```\n   */\n  static fromJson(data) {\n    const extras = _DwnError.enforceExtras(data);\n    return new _DwnError(data.type, data.description, extras);\n  }\n  /**\n   * Normalizes and validates error extras properties.\n   *\n   * Ensures all optional properties have default values and validates the structure\n   * of the extras object. Used internally to maintain consistency across error instances.\n   *\n   * @param {DwnError | DwnErrorExtras} [entity] Error entity or extras object to normalize\n   * @returns {Required<DwnErrorExtras>} Normalized extras object with all required properties\n   *\n   * @internal\n   */\n  static enforceExtras(entity) {\n    if (!entity) entity = {};\n    const extras = {};\n    extras.message = entity.message || \"\";\n    extras.messages = entity.messages || [];\n    extras.stack = entity.stack || \"\";\n    extras.goto = entity.goto;\n    extras.state = entity.state || { id: \"\", service: \"\" };\n    extras.at = entity.at || (new Date()).toISOString();\n    extras.intent = entity.intent || \"\";\n    extras.content = entity.content || \"\";\n    extras.recurrence = entity.recurrence || { type: 1, state: 1, combined: 1 };\n    extras.code = entity.code || undefined;\n    extras.status = entity.status || undefined;\n    return extras;\n  }\n  /**\n   * Serializes the error to a string format.\n   *\n   * Converts the DwnError instance into a parseable string format using the pattern\n   * \"TYPE -|- DESCRIPTION -|- EXTRAS_JSON\" for storage or transmission.\n   *\n   * @returns {string} Serialized error string\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"API_ERROR\", \"Request failed\");\n   * const serialized = error.toString();\n   * // \"API_ERROR -|- Request failed -|- {...}\"\n   * ```\n   */\n  toString() {\n    const extras = JSON.stringify(_DwnError.enforceExtras(this));\n    return `${this.type} -|- ${this.description} -|- ${extras}`;\n  }\n  /**\n   * Converts the error to a JSON object.\n   *\n   * Serializes all error properties into a plain JavaScript object suitable\n   * for JSON serialization, API responses, or logging.\n   *\n   * @returns {Error} Plain object representation of the error\n   *\n   * @example\n   * ```typescript\n   * const error = new DwnError(\"VALIDATION_ERROR\", \"Invalid data\");\n   * const json = error.toJson();\n   * console.log(JSON.stringify(json, null, 2));\n   * ```\n   */\n  toJson() {\n    return {\n      type: this.type,\n      at: this.at,\n      description: this.description,\n      message: this.message,\n      messages: this.messages || [],\n      stack: this.stack || \"\",\n      intent: this.intent,\n      content: this.content,\n      goto: this.goto,\n      state: this.state,\n      recurrence: this.recurrence\n    };\n  }\n};\nvar SYSTEM_DWN_ERRORS = [\n  \"RUNTIME_ERROR\",\n  \"MISCONFIGURATION_ERROR\"\n];\n\n\nfunction enforceState(state, currentService, states) {\n  if (!state && typeof state !== \"string\") {\n    return state;\n  }\n  const id = typeof state === \"string\" ? state : state.id;\n  if (!id) {\n    throw new DwnError(\n      \"MISCONFIGURATION_ERROR\",\n      `State ${JSON.stringify(state)} must have 'id' property.`\n    );\n  }\n  const key = `${id}@${currentService}`;\n  let service = typeof state === \"string\" ? currentService : state.service;\n  if (!service) {\n    service = currentService;\n  }\n  let name = typeof state === \"string\" ? \"\" : state.name;\n  if (!name) {\n    name = states[key] || undefined;\n  }\n  return { id, service, name };\n}\n",
                    "inputVariables": [
                        "dwn",
                        "dwnCore",
                        "dwnConfig",
                        "dwnStates",
                        "dwnError",
                        "resource.dwnListConfig",
                        "tunnel.originator",
                        "contact.serialized"
                    ],
                    "outputVariable": "dwn"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "notExists",
                        "variable": "dwnBypass"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_RST_INT_CNT#94ed7536-69ac-4a2a-9284-9a76632962e6",
                "$typeOfContent": "",
                "type": "MergeContact",
                "$title": "DWN Reset contact intent",
                "settings": {
                    "extras": {
                        "intent": ""
                    }
                },
                "conditions": [
                    {
                        "source": "context",
                        "comparison": "exists",
                        "values": [],
                        "variable": "contact.extras.intent"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_PREP_INT#f8ce2839-118e-42ea-ad4f-94e59362b749",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Prepare Intents",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-prepare-intents-{{dwn@intent.event}}",
                    "action": "{{dwn@intent.label}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "prepare"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    },
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent.id"
                    },
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent.label"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_PREP_INT_UNX#e9f9a04e-491e-4ba1-a9ca-2dadb096b8cc",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Prepare Intents with unexpected",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-prepare-intents-{{dwn@intent.event}}",
                    "action": "{{dwn@intent.label}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "prepare"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    },
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent.label"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_PREP_INT_GLB_UNX#e40c6935-ac2a-485b-9f80-1637ea7d48af",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Prepare unexpected intents",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-prepare-intents-global-unexpected",
                    "action": "{{dwnCore@state.name}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "prepare"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    },
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "notExists",
                        "variable": "dwn@intent.id"
                    },
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwnCore@state.name"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_PREP_INT_LST#c5e3b760-9647-45d9-a3d3-f572d7e2dc3f",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Stack Intent List",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-prepare-intents-list-{{dwn@intent.event}}",
                    "action": " | {{dwn@calendar.datetime}} | {{contact.identity}} | {{dwn@intent.label}} | {{dwn@intent.type}} | {{dwn@input.content}} | {{dwn@intent.pattern}} | {{dwn@intent.score}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "prepare"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_PREP_INT_UNM_LST#2e5db73f-3a60-4e5a-8758-0b0bb57ef3f2",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Prepare Unmatched Intent List",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-prepare-intents-list-unmatched",
                    "action": " | {{dwn@calendar.datetime}} | {{contact.identity}} | {{dwn@intent.type}} | {{dwn@input.content}} | {{dwn@intent.score}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "prepare"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_INA#5a3ba4fe-1004-45b5-bc0d-5266180a31c2",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Inactivity",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-inactivity",
                    "action": "{{dwnCore@state.name}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "input",
                        "comparison": "notExists"
                    },
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwnCore@state.name"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_STK_INT#81ef4dda-4c6b-4302-9706-e0b298bb7756",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Stack Intent",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-stack-intents-{{dwn@intent.event}}",
                    "action": "{{dwn@intent.label}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "stack"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    },
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent.label"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_STK_INT_LST#72104f19-fd48-4ffd-b7e9-3a6a6d8d8c79",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Stack Intent List",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-stack-intents-list",
                    "action": " | {{dwn@calendar.datetime}} | {{contact.identity}} | {{dwn@intent.event}} | {{dwn@intent.label}} | {{dwn@intent.type}} | {{dwn@input.content}} | {{dwn@intent.pattern}} | {{dwn@intent.score}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "stack"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_CFG_INT#27939742-a534-44c6-9590-1963fa55a209",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Config Intent",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-config-intents-{{dwn@intent.event}}",
                    "action": "{{dwn@intent.label}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "config"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    },
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent.label"
                    }
                ],
                "$invalid": false
            },
            {
                "$id": "DWN/GLB_TRK_CFG_INT_LST#252f2429-0cc9-45ac-8c6f-f0b6dba4c977",
                "$typeOfContent": "",
                "type": "TrackEvent",
                "$title": "DWN Config Intent List",
                "settings": {
                    "extras": {
                        "journey": "{{dwn@journey}}"
                    },
                    "category": "dwn-config-intents-list",
                    "action": " | {{dwn@calendar.datetime}} | {{contact.identity}} | {{dwn@intent.event}} | {{dwn@intent.label}} | {{dwn@intent.type}} | {{dwn@input.content}} | {{dwn@intent.pattern}} | {{dwn@intent.score}}"
                },
                "conditions": [
                    {
                        "values": [],
                        "source": "context",
                        "comparison": "exists",
                        "variable": "dwn@intent"
                    },
                    {
                        "values": [
                            "config"
                        ],
                        "source": "context",
                        "comparison": "equals",
                        "variable": "dwn@intent.scope"
                    }
                ],
                "$invalid": false
            }
        ],
        "$leavingCustomActions": [],
        "$inputSuggestions": [],
        "$defaultOutput": {
            "stateId": "fallback",
            "$invalid": false
        },
        "$localCustomActions": [],
        "isAiGenerated": false,
        "$tags": [],
        "id": "global-actions",
        "$invalidContentActions": false,
        "$invalidOutputs": false,
        "$invalidCustomActions": false,
        "$invalid": false
    }
}